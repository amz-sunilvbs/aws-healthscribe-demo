const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BL_wyNUb.js","assets/index-DJ51gUYF.js","assets/index-BJjpLsDz.css","assets/index-Chjiymov.js"])))=>i.map(i=>d[i]);
import{aj as Vn,Y as Jt,W as Un,r as h,k as Gt,a6 as Wn,ak as Yt,n as z,al as qn,m as S,a5 as ct,am as Jn,o as ze,an as we,ao as Gn,ap as Yn,aq as Kn,ar as Xn,as as Zn,Z as Kt,at as Qn,_ as dt,au as es,t as Xt,T as Zt,av as ts,i as Qt,q as en,aw as ns,v as tn,j as r,H as Ge,S as q,B as ne,ax as nn,ay as qe,u as ut,z as sn,w as rn,A as ss,x as Y,f as ht,y as is,a as $e,az as rs,aA as as,aB as os,aC as cs,aD as ls,aE as ds,aF as us,aG as hs,aH as ms,aI as ps,aJ as fs,aK as gs,aL as bs,aM as xs,aN as vs,aO as Ss,aP as Es,aQ as _s,aR as ys,aS as Cs,aT as ws,aU as Ts,aV as Is,aW as Ms,aX as js,aY as Rs,aZ as As,a_ as Ds,a$ as Ps,b0 as Ns,b1 as Os,b2 as Ls,b3 as ks,b4 as zs,b5 as $s,b6 as Hs,b7 as Fs,b8 as Bs,b9 as Vs,ba as Us,bb as Ws,bc as qs,bd as Js,be as Gs,bf as Ys,bg as Ks,bh as Xs,bi as Zs,bj as K,bk as Ye,bl as Qs,bm as ei,bn as ti,bo as ni,bp as B,bq as C,br as ve,bs as W,bt as L,bu as Ke,bv as Xe,bw as Ze,bx as si,by as ii,c as Qe,ah as an,L as Je,bz as Le,bA as ri,G as ai,bB as oi,bC as xe,a1 as ci,F as li,af as on,ai as di,bD as ui,bE as hi,d as mi,C as pi,bF as fi,g as gi,bG as wt,bH as bi}from"./index-DJ51gUYF.js";import{B as xi}from"./index-BksFU9xI.js";import{c as cn,a as vi,b as ln,d as lt,e as Si}from"./index-pxjt_Rts.js";import{I as Tt,P as et,A as Ei}from"./AudioControls-C92TgNie.js";import{c as _i,T as dn,t as pe}from"./toTitleCase-uuoTv_OD.js";import{E as ke,C as It}from"./index-BFZHmdZL.js";import"./internal-DYW6iIRQ.js";function Mt(t,[e,n]){return t<e?n:t>n?e:t}function yi(){return"scrollBehavior"in document.documentElement.style}const Ci=t=>.0015*Math.abs(t)+.558,wi=t=>Math.round(Math.abs(t)/Ci(t)),un=()=>window.performance?window.performance.now():Date.now(),Ti=t=>.5*(1-Math.cos(Math.PI*t)),hn=t=>{const e=un(),n=Math.min((e-t.startTime)/t.scrollTime,1),s=Ti(n),i=t.startX+(t.endX-t.startX)*s;t.scrollable.scrollLeft=i,i!==t.endX&&requestAnimationFrame(()=>hn(t))},Ii=(t,e)=>{const n=t.scrollLeft;hn({scrollable:t,startX:n,endX:e,startTime:un(),scrollTime:wi(e-n)})},mn=(t,e)=>{if(Vn(t)){t.scrollLeft=e;return}if(yi()&&t.scrollTo){t.scrollTo({left:e,behavior:"smooth"});return}Ii(t,e)},Be=(t,e)=>{if(!t?.current)return;const n=t.current,{scrollLeft:s,scrollWidth:i,offsetWidth:a}=n,c=Math.ceil(n.clientWidth*.75),o=e==="forward"?Math.min(Math.abs(s)+c,i-a):Math.max(Math.abs(s)-c,0),l=Un(n)?o*-1:o;mn(n,l)},Mi=(t,e)=>{const{offsetWidth:n,scrollWidth:s}=t,i=e.current&&2*e.current.offsetWidth;return i?s>n+i:s>n},jt=t=>Jt(t)>0,Rt=t=>Math.ceil(Jt(t))<t.scrollWidth-t.offsetWidth,ji=(t,e,n=!0)=>{if(!t||!e)return;const s=2;let i=e.scrollLeft;i=Math.min(i,t.offsetLeft-s),i=Math.max(i,t.offsetLeft+t.offsetWidth/2-e.offsetWidth/2+s),n?mn(e,i):e.scrollLeft=i},ue={"tabs-header-list":"awsui_tabs-header-list_1acwa_dp0cl_5","active-tab-header":"awsui_active-tab-header_1acwa_dp0cl_6","tab-label":"awsui_tab-label_1acwa_dp0cl_7","tab-dismiss-button":"awsui_tab-dismiss-button_1acwa_dp0cl_8"},_={"tabs-header":"awsui_tabs-header_14rmt_11l2w_290","tab-header-scroll-container":"awsui_tab-header-scroll-container_14rmt_11l2w_299","tabs-header-list":"awsui_tabs-header-list_14rmt_11l2w_305","pagination-button":"awsui_pagination-button_14rmt_11l2w_323","pagination-button-left":"awsui_pagination-button-left_14rmt_11l2w_330","pagination-button-left-scrollable":"awsui_pagination-button-left-scrollable_14rmt_11l2w_333","pagination-button-right":"awsui_pagination-button-right_14rmt_11l2w_337","pagination-button-right-scrollable":"awsui_pagination-button-right-scrollable_14rmt_11l2w_340","actions-container":"awsui_actions-container_14rmt_11l2w_345","tabs-tab":"awsui_tabs-tab_14rmt_11l2w_353","tabs-tab-label":"awsui_tabs-tab-label_14rmt_11l2w_363","tabs-tab-header-container":"awsui_tabs-tab-header-container_14rmt_11l2w_374","tabs-tab-dismiss":"awsui_tabs-tab-dismiss_14rmt_11l2w_385","tabs-tab-action":"awsui_tabs-tab-action_14rmt_11l2w_385",refresh:"awsui_refresh_14rmt_11l2w_390","tabs-tab-disabled":"awsui_tabs-tab-disabled_14rmt_11l2w_394","tabs-tab-link":"awsui_tabs-tab-link_14rmt_11l2w_436","tabs-tab-active":"awsui_tabs-tab-active_14rmt_11l2w_514","tabs-header-with-divider":"awsui_tabs-header-with-divider_14rmt_11l2w_521","tabs-tab-focusable":"awsui_tabs-tab-focusable_14rmt_11l2w_525",root:"awsui_root_14rmt_11l2w_529",tabs:"awsui_tabs_14rmt_11l2w_290","tabs-content":"awsui_tabs-content_14rmt_11l2w_567","fit-height":"awsui_fit-height_14rmt_11l2w_571","tabs-content-active":"awsui_tabs-content-active_14rmt_11l2w_577","tabs-content-wrapper":"awsui_tabs-content-wrapper_14rmt_11l2w_591","with-paddings":"awsui_with-paddings_14rmt_11l2w_591","tabs-container-content-wrapper":"awsui_tabs-container-content-wrapper_14rmt_11l2w_602","disabled-reason-tooltip":"awsui_disabled-reason-tooltip_14rmt_11l2w_613","tabs-tab-focused":"awsui_tabs-tab-focused_14rmt_11l2w_617"},Ri={"tab-dismiss-button":"awsui_tab-dismiss-button_1nq1i_1nd7r_5"},Ai=`.${_["tabs-tab-link"]}`,Di=`.${_["tabs-tab-focused"]}`,At=`.${_["tabs-tab-focusable"]}`;function Pi({dismissLabel:t,dismissDisabled:e,onDismiss:n,tabId:s}){return S.createElement(ct,{onClick:n,variant:"icon",iconName:"close",formAction:"none",ariaLabel:t,disabled:e,className:z(Ri["tab-dismiss-button"],ue["tab-dismiss-button"]),"data-testid":`awsui-tab-dismiss-button-${s}`})}function Ni({onChange:t,activeTabId:e,tabs:n,variant:s,idNamespace:i,ariaLabel:a,ariaLabelledby:c,i18nStrings:o,keyboardActivationMode:l,actions:m}){const p=h.useRef(null),u=h.useRef(null),b=h.useRef(null),d=Gt("tabs"),x=qn(),v=h.useRef(null),[g,I]=Wn(f=>f.contentBoxWidth),A=Yt(v,I),w=h.useRef(new Map),[M,E]=h.useState(!1),[R,P]=h.useState(!1),[y,V]=h.useState(!1),[j,k]=h.useState(e),[U,J]=h.useState(e),G=n.some(f=>f.action||f.dismissible),Te=G?{role:"application","aria-roledescription":d("i18nStrings.tabsWithActionsAriaRoleDescription",o?.tabsWithActionsAriaRoleDescription)}:{role:"tablist"};h.useEffect(()=>{p.current&&(E(Mi(p.current,b)),P(jt(p.current)),V(Rt(p.current)))},[g,n]);const D=f=>{if(!e)return;const N=w.current.get(e);N&&p.current&&ji(N,p.current,f)};h.useEffect(()=>{requestAnimationFrame(()=>{D(!1)})},[M,g,n.length]),h.useEffect(()=>{D(!0)},[e]),h.useEffect(()=>{var f,N;!((f=p.current)===null||f===void 0)&&f.contains(document.activeElement)&&document.activeElement!==u.current&&((N=u.current)===null||N===void 0||N.focus({preventScroll:!0}))},[e]);const H=()=>{p.current&&(P(jt(p.current)),V(Rt(p.current)))},Se=z({[_["tabs-header"]]:!0,[_["tabs-header-with-divider"]]:s==="default"||x}),fe=z({[_["pagination-button"]]:!0,[_["pagination-button-left"]]:!0,[_["pagination-button-left-scrollable"]]:R}),Z=z({[_["pagination-button"]]:!0,[_["pagination-button-right"]]:!0,[_["pagination-button-right-scrollable"]]:y}),Q=h.useRef(null);function te(){var f,N;if(!v.current)return null;const X=Array.from(v.current.querySelectorAll(Ai));return(N=(f=X.find(O=>O.matches(Di)))!==null&&f!==void 0?f:X.find(O=>!O.disabled))!==null&&N!==void 0?N:null}function he(f){var N;if(!!f.classList.contains(_["tabs-tab-link"])){const O=(N=Q.current)===null||N===void 0?void 0:N.getFocusTarget(),F=O?.querySelector(`.${_["tabs-tab-link"]}`);F?.focus()}}h.useEffect(()=>{var f;(f=Q.current)===null||f===void 0||f.updateFocusTarget()});function ge(){var f;(f=Q.current)===null||f===void 0||f.updateFocusTarget()}function be(){var f;(f=Q.current)===null||f===void 0||f.updateFocusTarget()}function Ee(f){const N=document.activeElement,X=[we.right,we.left,we.end,we.home,we.pageUp,we.pageDown,we.space],O=document.querySelector(`.${_["tabs-tab-action"]} [aria-expanded="true"]`),F=!N?.classList.contains(_["tabs-tab-link"]);if(O)return;if(f.key==="Tab"&&!f.shiftKey&&F){f.preventDefault();const ie=`${i}-${e}-panel`,ye=document.getElementById(ie);ye?.focus()}if(Gn(f)||X.indexOf(f.keyCode)===-1||!v.current||!N)return;f.preventDefault();const $=Ct(v.current),_e=document.activeElement instanceof HTMLElement?$.indexOf(document.activeElement):-1;Yn(f,{onHome:()=>Fe($[0]),onEnd:()=>Fe($[$.length-1]),onInlineStart:()=>Fe($[Mt(_e-1,[0,$.length-1])]),onInlineEnd:()=>Fe($[Mt(_e+1,[0,$.length-1])]),onPageDown:()=>y&&Be(p,"forward"),onPageUp:()=>R&&Be(p,"backward"),onActivate:()=>{var ie;return j&&j!==e&&t({activeTabId:j,activeTabHref:(ie=n.find(ye=>ye.id===j))===null||ie===void 0?void 0:ie.href})}})}function Fe(f){var N,X;f.focus();const O=n.reduce((F,$)=>F.set($.id,$),new Map);for(const[F,$]of w.current.entries()){const _e=$?.querySelector(`.${_["tabs-tab-link"]}`);if(F!==e&&_e===f){J(F),k(F),!(!((N=O.get(F))===null||N===void 0)&&N.disabled)&&l==="automatic"&&t({activeTabId:F,activeTabHref:(X=O.get(F))===null||X===void 0?void 0:X.href});break}}}function Ct(f){function N(O){var F,$;return($=(F=Q.current)===null||F===void 0?void 0:F.isRegistered(O))!==null&&$!==void 0?$:!1}function X(O){return O instanceof HTMLButtonElement?!O.disabled||O.closest(At):O.matches(At)}return Qn(f).filter(O=>N(O)&&X(O))}const Dn=G?"div":"ul";return S.createElement("div",{className:Se},S.createElement("div",{className:_["tab-header-scroll-container"],ref:A},M&&S.createElement("span",{ref:b,className:fe},S.createElement(ct,{formAction:"none",variant:"icon",iconName:"angle-left",disabled:!R,__focusable:!0,onClick:()=>Be(p,"backward"),ariaLabel:d("i18nStrings.scrollLeftAriaLabel",o?.scrollLeftAriaLabel)})),S.createElement(Jn,{ref:Q,navigationActive:!0,getNextFocusTarget:te,onUnregisterActive:he},S.createElement(Dn,Object.assign({},Te,{className:z(_["tabs-header-list"],ue["tabs-header-list"]),"aria-label":a,"aria-labelledby":c,ref:p,onScroll:H,onKeyDown:Ee,onFocus:ge,onBlur:be}),n.map(Pn))),M&&S.createElement("span",{className:Z},S.createElement(ct,{formAction:"none",variant:"icon",iconName:"angle-right",disabled:!y,__focusable:!0,onClick:()=>Be(p,"forward"),ariaLabel:d("i18nStrings.scrollRightAriaLabel",o?.scrollRightAriaLabel)}))),m&&S.createElement("div",{className:_["actions-container"]},m));function Pn(f,N){const{dismissible:X,dismissLabel:O,dismissDisabled:F,action:$,onDismiss:_e}=f,ie=e===f.id&&!f.disabled,ye=re=>{if(f.disabled){re.preventDefault();return}if(!(!Kn(re)&&f.href)){if(re.preventDefault(),!f.href){const Ce=w.current.get(f.id);Ce&&Ce&&Ce!==document.activeElement&&Ce.focus({preventScroll:!0})}f.id!==e&&(k(f.id),J(f.id),t({activeTabId:f.id,activeTabHref:f.href}))}},Nn=z({[_["tabs-tab-link"]]:!0,[_.refresh]:x,[_["tabs-tab-active"]]:e===f.id&&!f.disabled,[_["tabs-tab-focused"]]:j===f.id,[_["tabs-tab-active"]]:ie,[ue["active-tab-header"]]:ie,[_["tabs-tab-disabled"]]:f.disabled,[_["tabs-tab-focusable"]]:!f.disabled||f.disabled&&!!f.disabledReason}),On=z({[_["tabs-tab-header-container"]]:!0,[_.refresh]:x,[_["tabs-tab-active"]]:ie,[_["tabs-tab-disabled"]]:f.disabled,[_["tabs-tab-focusable"]]:!f.disabled||f.disabled&&!!f.disabledReason}),Ln=z({[_["tabs-tab-action"]]:!0,[_["tabs-tab-active"]]:ie}),Ie={className:Nn,"aria-controls":`${i}-${f.id}-panel`,"data-testid":f.id,id:pn({namespace:i,tabId:f.id}),onClick:ye},kn=G?{role:"group","aria-labelledby":Ie.id}:{};G?Ie["aria-expanded"]=e===f.id:(Ie["aria-selected"]=e===f.id,Ie.role="tab"),f.disabled&&(Ie["aria-disabled"]="true");const zn=re=>{f.id===e&&(u.current=re),w.current.set(f.id,re)},$n=re=>{if(!v.current||!_e)return;const Me=Ct(v.current).filter(Pe=>Pe.classList.contains(_["tabs-tab-link"])),Ce=Me.findIndex(Pe=>Pe.dataset.testid===f.id);Me.splice(Ce,1);let je;U&&U!==f.id?je=Me.find(Pe=>Pe.dataset.testid===U):je=Me[Math.min(Me.length-1,Ce)],je&&je.dataset.testid&&(t({activeTabId:je.dataset.testid}),je.focus()),_e(re)},Hn=G?"div":"li",Fn={action:"dismiss",detail:{id:f.id,label:`.${ue["tab-dismiss-button"]}`,position:`${N+1}`}},Bn={innerContext:{tabId:f.id,tabLabel:`.${ue["tab-label"]}`,tabPosition:`${N+1}`}};return S.createElement(Hn,{ref:re=>w.current.set(f.id,re),className:_["tabs-tab"],role:"presentation",key:f.id},S.createElement("div",Object.assign({className:On},kn,ze({component:Bn})),S.createElement(Oi,{ref:zn,tab:f,elementProps:Ie,activeTabId:e,index:N}),$&&S.createElement("span",{className:Ln},$),X&&S.createElement("span",Object.assign({className:_["tabs-tab-dismiss"]},ze(Fn)),Pi({dismissLabel:O,dismissDisabled:F,onDismiss:$n,tabId:f.id}))))}}const Oi=h.forwardRef(({tab:t,elementProps:e,activeTabId:n,index:s},i)=>{const a=h.useRef(null),c=h.useRef(null),o=Yt(a,i),{tabIndex:l}=Xn(a),m=t.disabled&&!!t.disabledReason,[p,u]=h.useState(!1),{targetProps:b,descriptionEl:d}=Zn(t.disabledReason),x=S.createElement(S.Fragment,null,S.createElement("span",{className:z(_["tabs-tab-label"],ue["tab-label"]),ref:c},S.createElement("span",null,t.label)),m&&S.createElement(S.Fragment,null,d,p&&S.createElement(Kt,{className:_["disabled-reason-tooltip"],trackRef:c,value:t.disabledReason,onDismiss:()=>u(!1)}))),v={onFocus:()=>u(!0),onBlur:()=>u(!1),onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1)},g={action:"select",detail:{id:t.id,label:`.${ue["tab-label"]}`,position:`${s+1}`,originTabId:n||""}},I=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),m?b:{}),m?v:{}),{ref:o,tabIndex:l}),t.disabled||t.id===n?{}:ze(g));return t.href?S.createElement("a",Object.assign({},I,{href:t.href}),x):S.createElement("button",Object.assign({},I,{type:"button",disabled:t.disabled&&!m}),x)});function pn({namespace:t,tabId:e}){return t+"-"+e}function Li(t){const e=t.filter(n=>!n.disabled);return e.length>0?e[0]:null}function ki(t,e){switch(t.contentRenderStrategy){case"active":return!1;case"eager":return!0;case"lazy":return e.has(t.id)}return!1}function fn(t){var e,n,{tabs:s,variant:i="default",onChange:a,activeTabId:c,ariaLabel:o,ariaLabelledby:l,disableContentPaddings:m=!1,i18nStrings:p,fitHeight:u,keyboardActivationMode:b="automatic",actions:d}=t,x=dt(t,["tabs","variant","onChange","activeTabId","ariaLabel","ariaLabelledby","disableContentPaddings","i18nStrings","fitHeight","keyboardActivationMode","actions"]);for(const y of s)es("Tabs",y.href);const{__internalRootRef:v}=Xt("Tabs",{props:{disableContentPaddings:m,variant:i,fitHeight:u,keyboardActivationMode:b},metadata:{hasActions:s.some(y=>!!y.action),hasHeaderActions:!!d,hasDisabledReasons:s.some(y=>!!y.disabledReason),hasEagerLoadedTabs:s.some(y=>y.contentRenderStrategy==="eager"),hasLazyLoadedTabs:s.some(y=>y.contentRenderStrategy==="lazy")}}),g=Zt("awsui-tabs-"),[I,A]=ts(c,a,(n=(e=Li(s))===null||e===void 0?void 0:e.id)!==null&&n!==void 0?n:"",{componentName:"Tabs",controlledProp:"activeTabId",changeHandler:"onChange"}),w=h.useRef(new Set);I!==void 0&&w.current.add(I);const M=Qt(x),E={name:"awsui.Tabs",label:`.${ue["tabs-header-list"]}`};I&&(E.properties={activeTabId:I,activeTabLabel:`.${ue["active-tab-header"]} .${ue["tab-label"]}`,activeTabPosition:`${s.findIndex(y=>y.id===I)+1}`,tabsCount:`${s.length}`});const R=()=>{const y=s.filter(j=>j.id===I)[0],V=j=>{const k=j===y,J={className:z({[_["tabs-content"]]:!0,[_["tabs-content-active"]]:k}),role:"tabpanel",id:`${g}-${j.id}-panel`,key:`${g}-${j.id}-panel`,tabIndex:0,"aria-labelledby":pn({namespace:g,tabId:j.id})},G=!j.disabled&&(k||ki(j,w.current));return S.createElement("div",Object.assign({},J),G&&j.content)};return S.createElement("div",{className:z(i==="container"||i==="stacked"?_["tabs-container-content-wrapper"]:_["tabs-content-wrapper"],{[_["with-paddings"]]:!m})},s.map(V))},P=S.createElement(Ni,{activeTabId:I,variant:i,idNamespace:g,ariaLabel:o,ariaLabelledby:l,tabs:s,actions:d,onChange:y=>{A(y.activeTabId),en(a,y)},i18nStrings:p,keyboardActivationMode:b});return i==="container"||i==="stacked"?S.createElement(ns,Object.assign({header:P,disableHeaderPaddings:!0},M,{className:z(M.className,_.root),__internalRootRef:v,disableContentPaddings:!0,variant:i==="stacked"?"stacked":"default",fitHeight:u},ze({component:E})),R()):S.createElement("div",Object.assign({},M,{className:z(M.className,_.root,_.tabs,{[_["fit-height"]]:u}),ref:v},ze({component:E})),P,R())}tn(fn,"Tabs");function zi(){const t=h.useRef(void 0),[e,n]=h.useState(!1),[s,i]=h.useState(0),[a,c]=h.useState(!1),[o,l]=h.useState({allSegmentIds:[],selectedSegmentId:""});return[t,e,n,s,i,a,c,o,l]}function $i({jobDetails:t,setShowOutputModal:e,setDeleteModalActive:n}){async function s(i){let a="";if(i.id==="audio"?a=t?.Media?.MediaFileUri:i.id==="transcript"?a=t?.MedicalScribeOutput?.TranscriptFileUri:i.id==="summary"&&(a=t?.MedicalScribeOutput?.ClinicalDocumentUri),a){const c=await nn(qe(a));window.open(c,"_blank")}}return r.jsx(Ge,{variant:"awsui-h1-sticky",actions:r.jsxs(q,{direction:"horizontal",size:"xs",children:[r.jsx(xi,{items:[{text:"Audio",id:"audio"},{text:"Transcript",id:"transcript"},{text:"Summary",id:"summary"}],onItemClick:({detail:i})=>s(i),children:"Download"}),r.jsx(ne,{onClick:()=>e(!0),children:"View HealthScribe Output"}),r.jsx(ne,{variant:"normal",onClick:()=>n(!0),children:"Delete"})]}),children:t?.MedicalScribeJobName})}function Hi({jobDetails:t,deleteModalActive:e,setDeleteModalActive:n}){const{addFlashMessage:s}=ut(),i=sn(),[a,c]=h.useState(!1);async function o(l){if(l){c(!0);try{await is({MedicalScribeJobName:l}),s({id:`Deleted encounter: ${l}`,header:"Encounter Deleted",content:`Successfully deleted encounter "${l}"`,type:"success"}),i("/conversations")}catch(m){s({id:m?.toString()||"Error deleting HealthScribe job",header:"Error deleting HealthScribe job",content:m?.toString()||"Error deleting HealthScribe job",type:"error"})}n(!1),c(!1)}}return r.jsxs(rn,{onDismiss:()=>n(!1),visible:e,footer:r.jsx(Y,{float:"right",children:r.jsxs(q,{direction:"horizontal",size:"xs",children:[r.jsx(ne,{variant:"link",disabled:a,onClick:()=>n(!1),children:"Cancel"}),r.jsx(ne,{disabled:a,variant:"primary",onClick:()=>o(t?.MedicalScribeJobName||""),children:a?r.jsx(ht,{}):"Delete"})]})}),header:"Delete Naina HealthScribe Encounter",children:[r.jsxs("p",{children:["Permanently delete ",r.jsx("strong",{children:t?.MedicalScribeJobName||""}),". You cannot undo this action."]}),r.jsx(ss,{statusIconAriaLabel:"Info",children:"Proceeding with this action will delete the encounter but not the associated data (audio file, results JSON) from S3."})]})}const Fi="O",Bi="P",Vi="R",Ve={childDiv:Fi,scrollUpIcon:Bi,scrollDownIcon:Vi};function mt({containerTitle:t,text:e}){return r.jsx($e,{header:r.jsx(Ge,{variant:"h2",children:t}),children:r.jsxs("div",{className:Ve.childDiv,children:[r.jsx(ht,{})," ",e]})})}function Ui(t,e){t!=null&&h.useEffect(()=>{const n=t.current;return n&&n.addEventListener("scroll",e),()=>{n?.removeEventListener("scroll",e)}},[t])}function gn({containerTitle:t,containerActions:e=null,children:n}){const[s,i]=h.useState(!1),[a,c]=h.useState(!1),o=h.useRef(null);function l(p){const u=p.target,b=u.scrollTop>0;i(!!b);const d=u.scrollHeight-u.scrollTop===u.clientHeight;c(!d)}const m=_i(l,300);return Ui(o,m),h.useEffect(()=>{if(o.current==null)return;const p=o.current;p.scrollHeight>p.clientHeight&&c(!0)},[o.current]),r.jsxs($e,{header:r.jsx(Ge,{variant:"h2",actions:e,children:t}),children:[s&&r.jsx("div",{className:Ve.scrollUpIcon,children:r.jsx(Tt,{name:"angle-up",size:"medium"})}),r.jsx("div",{className:Ve.childDiv,ref:o,children:n}),a&&r.jsx("div",{className:Ve.scrollDownIcon,children:r.jsx(Tt,{name:"angle-down",size:"medium"})})]})}const Wi="E",qi="F",Dt={hidescrollbar:Wi,row:qi};function ce({label:t,children:e}){return r.jsxs("div",{children:[r.jsx(Y,{variant:"awsui-key-label",children:t}),r.jsx("div",{children:e})]})}const Ji=async(t,e,n)=>({operation:os(e).operation,region:await as(t.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function Gi(t){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"comprehendmedical",region:t.region},propertiesExtractor:(e,n)=>({signingProperties:{config:e,context:n}})}}const Yi=t=>{const e=[];switch(t.operation){default:e.push(Gi(t))}return e},Ki=t=>{const e=rs(t);return Object.assign(e,{})},Xi=t=>Object.assign(t,{useDualstackEndpoint:t.useDualstackEndpoint??!1,useFipsEndpoint:t.useFipsEndpoint??!1,defaultSigningName:"comprehendmedical"}),tt={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}},Zi="3.782.0",Qi={version:Zi},bn="required",le="fn",de="argv",De="ref",Pt=!0,Nt="isSet",He="booleanEquals",Re="error",Ne="endpoint",me="tree",pt="PartitionResult",Ot={[bn]:!1,type:"String"},Lt={[bn]:!0,default:!1,type:"Boolean"},kt={[De]:"Endpoint"},xn={[le]:He,[de]:[{[De]:"UseFIPS"},!0]},vn={[le]:He,[de]:[{[De]:"UseDualStack"},!0]},ae={},zt={[le]:"getAttr",[de]:[{[De]:pt},"supportsFIPS"]},$t={[le]:He,[de]:[!0,{[le]:"getAttr",[de]:[{[De]:pt},"supportsDualStack"]}]},Ht=[xn],Ft=[vn],Bt=[{[De]:"Region"}],er={parameters:{Region:Ot,UseDualStack:Lt,UseFIPS:Lt,Endpoint:Ot},rules:[{conditions:[{[le]:Nt,[de]:[kt]}],rules:[{conditions:Ht,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Re},{conditions:Ft,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Re},{endpoint:{url:kt,properties:ae,headers:ae},type:Ne}],type:me},{conditions:[{[le]:Nt,[de]:Bt}],rules:[{conditions:[{[le]:"aws.partition",[de]:Bt,assign:pt}],rules:[{conditions:[xn,vn],rules:[{conditions:[{[le]:He,[de]:[Pt,zt]},$t],rules:[{endpoint:{url:"https://comprehendmedical-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:ae,headers:ae},type:Ne}],type:me},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Re}],type:me},{conditions:Ht,rules:[{conditions:[{[le]:He,[de]:[zt,Pt]}],rules:[{endpoint:{url:"https://comprehendmedical-fips.{Region}.{PartitionResult#dnsSuffix}",properties:ae,headers:ae},type:Ne}],type:me},{error:"FIPS is enabled but this partition does not support FIPS",type:Re}],type:me},{conditions:Ft,rules:[{conditions:[$t],rules:[{endpoint:{url:"https://comprehendmedical.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:ae,headers:ae},type:Ne}],type:me},{error:"DualStack is enabled but this partition does not support DualStack",type:Re}],type:me},{endpoint:{url:"https://comprehendmedical.{Region}.{PartitionResult#dnsSuffix}",properties:ae,headers:ae},type:Ne}],type:me}],type:me},{error:"Invalid Configuration: Missing Region",type:Re}]},tr=er,nr=new cs({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),sr=(t,e={})=>nr.get(t,()=>ls(tr,{endpointParams:t,logger:e.logger}));us.aws=ds;const ir=t=>({apiVersion:"2018-10-30",base64Decoder:t?.base64Decoder??xs,base64Encoder:t?.base64Encoder??bs,disableHostPrefix:t?.disableHostPrefix??!1,endpointProvider:t?.endpointProvider??sr,extensions:t?.extensions??[],httpAuthSchemeProvider:t?.httpAuthSchemeProvider??Yi,httpAuthSchemes:t?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new gs}],logger:t?.logger??new fs,serviceId:t?.serviceId??"ComprehendMedical",urlParser:t?.urlParser??ps,utf8Decoder:t?.utf8Decoder??ms,utf8Encoder:t?.utf8Encoder??hs}),rr=t=>{const e=vs(t),n=()=>e().then(Rs),s=ir(t);return{...s,...t,runtime:"browser",defaultsMode:e,bodyLengthChecker:t?.bodyLengthChecker??Is,credentialDefaultProvider:t?.credentialDefaultProvider??(i=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:t?.defaultUserAgentProvider??Ts({serviceId:s.serviceId,clientVersion:Qi.version}),maxAttempts:t?.maxAttempts??ws,region:t?.region??Cs("Region is missing"),requestHandler:ys.create(t?.requestHandler??n),retryMode:t?.retryMode??(async()=>(await n()).retryMode||_s),sha256:t?.sha256??Es,streamCollector:t?.streamCollector??Ss,useDualstackEndpoint:t?.useDualstackEndpoint??(()=>Promise.resolve(js)),useFipsEndpoint:t?.useFipsEndpoint??(()=>Promise.resolve(Ms))}},ar=t=>{const e=t.httpAuthSchemes;let n=t.httpAuthSchemeProvider,s=t.credentials;return{setHttpAuthScheme(i){const a=e.findIndex(c=>c.schemeId===i.schemeId);a===-1?e.push(i):e.splice(a,1,i)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(i){n=i},httpAuthSchemeProvider(){return n},setCredentials(i){s=i},credentials(){return s}}},or=t=>({httpAuthSchemes:t.httpAuthSchemes(),httpAuthSchemeProvider:t.httpAuthSchemeProvider(),credentials:t.credentials()}),cr=(t,e)=>{const n=Object.assign(As(t),Ds(t),Ps(t),ar(t));return e.forEach(s=>s.configure(n)),Object.assign(t,Ns(n),Os(n),Ls(n),or(n))};class lr extends ks{config;constructor(...[e]){const n=rr(e||{});super(n),this.initConfig=n;const s=Xi(n),i=zs(s),a=$s(i),c=Hs(a),o=Bs(c),l=Fs(o),m=Ki(l),p=cr(m,e?.extensions||[]);this.config=p,this.middlewareStack.use(Vs(this.config)),this.middlewareStack.use(Us(this.config)),this.middlewareStack.use(Ws(this.config)),this.middlewareStack.use(qs(this.config)),this.middlewareStack.use(Js(this.config)),this.middlewareStack.use(Gs(this.config)),this.middlewareStack.use(Ys(this.config,{httpAuthSchemeParametersProvider:Ji,identityProviderConfigProvider:async u=>new Ks({"aws.auth#sigv4":u.credentials})})),this.middlewareStack.use(Xs(this.config))}destroy(){super.destroy()}}class se extends Zs{constructor(e){super(e),Object.setPrototypeOf(this,se.prototype)}}class ft extends se{name="InternalServerException";$fault="server";Message;constructor(e){super({name:"InternalServerException",$fault:"server",...e}),Object.setPrototypeOf(this,ft.prototype),this.Message=e.Message}}class gt extends se{name="InvalidRequestException";$fault="client";Message;constructor(e){super({name:"InvalidRequestException",$fault:"client",...e}),Object.setPrototypeOf(this,gt.prototype),this.Message=e.Message}}class bt extends se{name="ResourceNotFoundException";$fault="client";Message;constructor(e){super({name:"ResourceNotFoundException",$fault:"client",...e}),Object.setPrototypeOf(this,bt.prototype),this.Message=e.Message}}class xt extends se{name="TooManyRequestsException";$fault="client";Message;constructor(e){super({name:"TooManyRequestsException",$fault:"client",...e}),Object.setPrototypeOf(this,xt.prototype),this.Message=e.Message}}class vt extends se{name="InvalidEncodingException";$fault="client";Message;constructor(e){super({name:"InvalidEncodingException",$fault:"client",...e}),Object.setPrototypeOf(this,vt.prototype),this.Message=e.Message}}class St extends se{name="ServiceUnavailableException";$fault="server";Message;constructor(e){super({name:"ServiceUnavailableException",$fault:"server",...e}),Object.setPrototypeOf(this,St.prototype),this.Message=e.Message}}class Et extends se{name="TextSizeLimitExceededException";$fault="client";Message;constructor(e){super({name:"TextSizeLimitExceededException",$fault:"client",...e}),Object.setPrototypeOf(this,Et.prototype),this.Message=e.Message}}class _t extends se{name="ValidationException";$fault="client";Message;constructor(e){super({name:"ValidationException",$fault:"client",...e}),Object.setPrototypeOf(this,_t.prototype),this.Message=e.Message}}const dr=async(t,e)=>{const n=it("DetectEntitiesV2");let s;return s=JSON.stringify(K(t)),st(e,n,"/",void 0,s)},ur=async(t,e)=>{const n=it("InferICD10CM");let s;return s=JSON.stringify(K(t)),st(e,n,"/",void 0,s)},hr=async(t,e)=>{const n=it("InferRxNorm");let s;return s=JSON.stringify(K(t)),st(e,n,"/",void 0,s)},mr=async(t,e)=>{const n=it("InferSNOMEDCT");let s;return s=JSON.stringify(K(t)),st(e,n,"/",void 0,s)},pr=async(t,e)=>{if(t.statusCode>=300)return nt(t,e);const n=await Ye(t.body,e);let s={};return s=Ir(n),{$metadata:ee(t),...s}},fr=async(t,e)=>{if(t.statusCode>=300)return nt(t,e);const n=await Ye(t.body,e);let s={};return s=kr(n),{$metadata:ee(t),...s}},gr=async(t,e)=>{if(t.statusCode>=300)return nt(t,e);const n=await Ye(t.body,e);let s={};return s=zr(n),{$metadata:ee(t),...s}},br=async(t,e)=>{if(t.statusCode>=300)return nt(t,e);const n=await Ye(t.body,e);let s={};return s=$r(n),{$metadata:ee(t),...s}},nt=async(t,e)=>{const n={...t,body:await ei(t.body,e)},s=ti(t,n.body);switch(s){case"InternalServerException":case"com.amazonaws.comprehendmedical#InternalServerException":throw await xr(n);case"InvalidRequestException":case"com.amazonaws.comprehendmedical#InvalidRequestException":throw await Sr(n);case"ResourceNotFoundException":case"com.amazonaws.comprehendmedical#ResourceNotFoundException":throw await Er(n);case"TooManyRequestsException":case"com.amazonaws.comprehendmedical#TooManyRequestsException":throw await Cr(n);case"InvalidEncodingException":case"com.amazonaws.comprehendmedical#InvalidEncodingException":throw await vr(n);case"ServiceUnavailableException":case"com.amazonaws.comprehendmedical#ServiceUnavailableException":throw await _r(n);case"TextSizeLimitExceededException":case"com.amazonaws.comprehendmedical#TextSizeLimitExceededException":throw await yr(n);case"ValidationException":case"com.amazonaws.comprehendmedical#ValidationException":throw await wr(n);default:const i=n.body;return na({output:t,parsedBody:i,errorCode:s})}},xr=async(t,e)=>{const n=t.body,s=K(n),i=new ft({$metadata:ee(t),...s});return ve(i,n)},vr=async(t,e)=>{const n=t.body,s=K(n),i=new vt({$metadata:ee(t),...s});return ve(i,n)},Sr=async(t,e)=>{const n=t.body,s=K(n),i=new gt({$metadata:ee(t),...s});return ve(i,n)},Er=async(t,e)=>{const n=t.body,s=K(n),i=new bt({$metadata:ee(t),...s});return ve(i,n)},_r=async(t,e)=>{const n=t.body,s=K(n),i=new St({$metadata:ee(t),...s});return ve(i,n)},yr=async(t,e)=>{const n=t.body,s=K(n),i=new Et({$metadata:ee(t),...s});return ve(i,n)},Cr=async(t,e)=>{const n=t.body,s=K(n),i=new xt({$metadata:ee(t),...s});return ve(i,n)},wr=async(t,e)=>{const n=t.body,s=K(n),i=new _t({$metadata:ee(t),...s});return ve(i,n)},Sn=(t,e)=>B(t,{BeginOffset:L,Category:C,EndOffset:L,Id:L,RelationshipScore:W,RelationshipType:C,Score:W,Text:C,Traits:n=>wn(n),Type:C}),Tr=(t,e)=>(t||[]).filter(s=>s!=null).map(s=>Sn(s)),Ir=(t,e)=>B(t,{Entities:n=>jr(n),ModelVersion:C,PaginationToken:C,UnmappedAttributes:n=>ta(n)}),Mr=(t,e)=>B(t,{Attributes:n=>Tr(n),BeginOffset:L,Category:C,EndOffset:L,Id:L,Score:W,Text:C,Traits:n=>wn(n),Type:C}),jr=(t,e)=>(t||[]).filter(s=>s!=null).map(s=>Mr(s)),Rr=(t,e)=>B(t,{BeginOffset:L,Category:C,EndOffset:L,Id:L,RelationshipScore:W,RelationshipType:C,Score:W,Text:C,Traits:n=>En(n),Type:C}),Ar=(t,e)=>(t||[]).filter(s=>s!=null).map(s=>Rr(s)),Dr=(t,e)=>B(t,{Code:C,Description:C,Score:W}),Pr=(t,e)=>(t||[]).filter(s=>s!=null).map(s=>Dr(s)),Nr=(t,e)=>B(t,{Attributes:n=>Ar(n),BeginOffset:L,Category:C,EndOffset:L,ICD10CMConcepts:n=>Pr(n),Id:L,Score:W,Text:C,Traits:n=>En(n),Type:C}),Or=(t,e)=>(t||[]).filter(s=>s!=null).map(s=>Nr(s)),Lr=(t,e)=>B(t,{Name:C,Score:W}),En=(t,e)=>(t||[]).filter(s=>s!=null).map(s=>Lr(s)),kr=(t,e)=>B(t,{Entities:n=>Or(n),ModelVersion:C,PaginationToken:C}),zr=(t,e)=>B(t,{Entities:n=>Wr(n),ModelVersion:C,PaginationToken:C}),$r=(t,e)=>B(t,{Characters:K,Entities:n=>Xr(n),ModelVersion:C,PaginationToken:C,SNOMEDCTDetails:K}),Hr=(t,e)=>B(t,{BeginOffset:L,EndOffset:L,Id:L,RelationshipScore:W,Score:W,Text:C,Traits:n=>_n(n),Type:C}),Fr=(t,e)=>(t||[]).filter(s=>s!=null).map(s=>Hr(s)),Br=(t,e)=>B(t,{Code:C,Description:C,Score:W}),Vr=(t,e)=>(t||[]).filter(s=>s!=null).map(s=>Br(s)),Ur=(t,e)=>B(t,{Attributes:n=>Fr(n),BeginOffset:L,Category:C,EndOffset:L,Id:L,RxNormConcepts:n=>Vr(n),Score:W,Text:C,Traits:n=>_n(n),Type:C}),Wr=(t,e)=>(t||[]).filter(s=>s!=null).map(s=>Ur(s)),qr=(t,e)=>B(t,{Name:C,Score:W}),_n=(t,e)=>(t||[]).filter(s=>s!=null).map(s=>qr(s)),Jr=(t,e)=>B(t,{BeginOffset:L,Category:C,EndOffset:L,Id:L,RelationshipScore:W,RelationshipType:C,SNOMEDCTConcepts:n=>yn(n),Score:W,Text:C,Traits:n=>Cn(n),Type:C}),Gr=(t,e)=>(t||[]).filter(s=>s!=null).map(s=>Jr(s)),Yr=(t,e)=>B(t,{Code:C,Description:C,Score:W}),yn=(t,e)=>(t||[]).filter(s=>s!=null).map(s=>Yr(s)),Kr=(t,e)=>B(t,{Attributes:n=>Gr(n),BeginOffset:L,Category:C,EndOffset:L,Id:L,SNOMEDCTConcepts:n=>yn(n),Score:W,Text:C,Traits:n=>Cn(n),Type:C}),Xr=(t,e)=>(t||[]).filter(s=>s!=null).map(s=>Kr(s)),Zr=(t,e)=>B(t,{Name:C,Score:W}),Cn=(t,e)=>(t||[]).filter(s=>s!=null).map(s=>Zr(s)),Qr=(t,e)=>B(t,{Name:C,Score:W}),wn=(t,e)=>(t||[]).filter(s=>s!=null).map(s=>Qr(s)),ea=(t,e)=>B(t,{Attribute:n=>Sn(n),Type:C}),ta=(t,e)=>(t||[]).filter(s=>s!=null).map(s=>ea(s)),ee=t=>({httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}),na=ni(se),st=async(t,e,n,s,i)=>{const{hostname:a,protocol:c="https",port:o,path:l}=await t.endpoint(),m={protocol:c,hostname:a,port:o,method:"POST",path:l.endsWith("/")?l.slice(0,-1)+n:l+n,headers:e};return i!==void 0&&(m.body=i),new Qs(m)};function it(t){return{"content-type":"application/x-amz-json-1.1","x-amz-target":`ComprehendMedical_20181030.${t}`}}class sa extends Ke.classBuilder().ep(tt).m(function(e,n,s,i){return[Xe(s,this.serialize,this.deserialize),Ze(s,e.getEndpointParameterInstructions())]}).s("ComprehendMedical_20181030","DetectEntitiesV2",{}).n("ComprehendMedicalClient","DetectEntitiesV2Command").f(void 0,void 0).ser(dr).de(pr).build(){}class ia extends Ke.classBuilder().ep(tt).m(function(e,n,s,i){return[Xe(s,this.serialize,this.deserialize),Ze(s,e.getEndpointParameterInstructions())]}).s("ComprehendMedical_20181030","InferICD10CM",{}).n("ComprehendMedicalClient","InferICD10CMCommand").f(void 0,void 0).ser(ur).de(fr).build(){}class ra extends Ke.classBuilder().ep(tt).m(function(e,n,s,i){return[Xe(s,this.serialize,this.deserialize),Ze(s,e.getEndpointParameterInstructions())]}).s("ComprehendMedical_20181030","InferRxNorm",{}).n("ComprehendMedicalClient","InferRxNormCommand").f(void 0,void 0).ser(hr).de(gr).build(){}class aa extends Ke.classBuilder().ep(tt).m(function(e,n,s,i){return[Xe(s,this.serialize,this.deserialize),Ze(s,e.getEndpointParameterInstructions())]}).s("ComprehendMedical_20181030","InferSNOMEDCT",{}).n("ComprehendMedicalClient","InferSNOMEDCTCommand").f(void 0,void 0).ser(mr).de(br).build(){}async function rt(){return new lr({region:ii(),credentials:await si()})}async function oa(t){const e=await rt(),n={Text:t},s=new sa(n);return await e.send(s)}async function ca(t){const e=await rt(),n={Text:t},s=new ia(n);return await e.send(s)}async function la(t){const e=await rt(),n={Text:t},s=new ra(n);return await e.send(s)}async function da(t){const e=await rt(),n={Text:t},s=new aa(n);return await e.send(s)}async function ua(t,e){switch(t){case"icd10cm":return await ca(e);case"rxnorm":return await la(e);case"snomedct":return await da(e);default:return!1}}function Tn(){const{appSettings:t}=Qe(),e=sn();return h.useMemo(()=>t["app.comprehendMedicalEnabled"],[t])?!1:r.jsx(et,{header:"Comprehend Medical",content:r.jsxs(Y,{children:[r.jsxs("p",{children:[r.jsx(Je,{external:!0,href:"https://aws.amazon.com/comprehend/medical/",children:"Amazon Comprehend Medical"})," ","is a healthcare natural language processing service (NLP) that uses machine learning to identify and extract information from medical text."]}),r.jsxs("p",{children:[r.jsx(Je,{variant:"secondary",onFollow:s=>{s.preventDefault(),e("/settings")},children:"Enable Amazon Comprehend Medical"})," ","in the app settings to use this feature."]})]}),children:r.jsx(an,{type:"info"})})}function ha({clinicalDocumentNereUnits:t}){const{appSettings:e}=Qe();return h.useMemo(()=>e["app.comprehendMedicalEnabled"],[e])&&t!==0?r.jsx(et,{header:"Comprehend Medical",content:r.jsxs(Y,{children:[r.jsxs(ce,{label:"Entity Extraction Estimated Cost",children:["$",(t.eachSegment*.01).toFixed(2)]}),r.jsxs("p",{children:["This demo uses the Medical Named Entity and Relationship Extraction (NERe) functionality of"," ",r.jsx(Je,{external:!0,href:"https://aws.amazon.com/comprehend/medical/",children:"Amazon Comprehend Medical"})," ","to extract data one insight at a time."]}),r.jsxs("p",{children:["The estimated cost for calling the NERe API for each section is"," ",r.jsxs("b",{children:["$",(t.eachSection*.01).toFixed(2)]}),", and for the entire summary, ",r.jsxs("b",{children:["$",(t.allAtOnce*.01).toFixed(2)]}),"."]}),r.jsxs("p",{children:["Refer to the"," ",r.jsx(Je,{external:!0,href:"https://aws.amazon.com/comprehend/medical/pricing",children:"Amazon Comprehend Medical pricing page"})," ","to learn more about pricing tiers, including free tier."," "]})]}),children:r.jsx(an,{type:"info"})}):!1}function Ue(t){return typeof t>"u"?"n/a":`${(t*100).toFixed(2)}%`}function at({items:t}){return typeof t>"u"?null:r.jsx(dn,{columnDefinitions:[{id:"code",header:"Code",cell:e=>e.Code,sortingField:"code",isRowHeader:!0},{id:"description",header:"Description",cell:e=>e.Description,sortingField:"description"},{id:"score",header:"Score",cell:e=>Ue(e.Score),sortingField:"score"}],items:t,sortingDisabled:!0,loadingText:"Loading items",empty:r.jsx(Y,{margin:{vertical:"xs"},textAlign:"center",color:"inherit",children:r.jsx(q,{size:"m",children:r.jsx("b",{children:"No items"})})}),variant:"embedded"})}function ma({inferredData:t}){return r.jsxs("div",{children:[typeof t.icd10cm=="object"&&r.jsxs(ke,{defaultExpanded:!0,headerText:"ICD-10-CM",children:[r.jsx(at,{items:t.icd10cm.Entities?.[0]?.ICD10CMConcepts}),r.jsx(q,{size:"s",direction:"vertical",children:r.jsxs("div",{children:[r.jsx("b",{children:"Score:"})," ",Ue(t.icd10cm?.Entities?.[0]?.Score)]})})]}),typeof t.rxnorm=="object"&&r.jsxs(ke,{defaultExpanded:!0,headerText:"RxNorm",children:[r.jsx(at,{items:t.rxnorm.Entities?.[0]?.RxNormConcepts}),r.jsx(q,{size:"s",direction:"vertical",children:r.jsxs("div",{children:[r.jsx("b",{children:"Score:"})," ",Ue(t.rxnorm?.Entities?.[0]?.Score)]})})]}),typeof t.snomedct=="object"&&r.jsxs(ke,{defaultExpanded:!0,headerText:"SNOMED-CT",children:[r.jsx(at,{items:t.snomedct.Entities?.[0]?.SNOMEDCTConcepts}),r.jsx(q,{size:"s",direction:"vertical",children:r.jsxs("div",{children:[r.jsx("b",{children:"Score:"})," ",Ue(t.snomedct?.Entities?.[0]?.Score)]})})]})]})}const pa=[{key:"icd10cm",name:"ICD-10-CM",category:["MEDICAL_CONDITION"],type:["DX_NAME","TIME_EXPRESSION"]},{key:"rxnorm",name:"RxNorm",category:["MEDICATION"]},{key:"snomedct",name:"SNOMED CT",category:["MEDICAL_CONDITION","ANATOMY","TEST_TREATMENT_PROCEDURE"]}];function In({category:t,type:e,text:n}){const{appSettings:s}=Qe(),i=h.useMemo(()=>s["app.comprehendMedicalEnabled"],[s]),[a,c]=S.useState({icd10cm:!1,rxnorm:!1,snomedct:!1});async function o(l,m){c({...a,[l]:"loading"});const p=await ua(l,m);c({...a,[l]:p})}return r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",columnGap:"5px",justifyContent:"space-around",alignItems:"center"},children:[pa.map((l,m)=>{if(l.category.includes(t))return l.type&&!l.type.includes(e)?void 0:r.jsx(ne,{disabled:!!a[l.key]||!i,loading:a[l.key]==="loading",onClick:()=>o(l.key,n),children:`Infer ${l.name}`},`button_${n}_${m}`)}),r.jsx(Tn,{})]}),r.jsx(ma,{inferredData:a})]})}function fa({attributes:t}){return r.jsx(ke,{defaultExpanded:!0,headerText:"Attributes",children:r.jsx(dn,{columnDefinitions:[{id:"type",header:"Type",cell:e=>pe(e.Type.replaceAll("_"," ")),sortingField:"type",isRowHeader:!0},{id:"Entity",header:"Entity",cell:e=>e.Spans[0].Content,sortingField:"entity"}],items:t,loadingText:"Loading attributes",sortingDisabled:!0,empty:r.jsx(Y,{margin:{vertical:"xs"},textAlign:"center",color:"inherit",children:r.jsx(q,{size:"m",children:r.jsx("b",{children:"No attributes"})})}),variant:"embedded"})})}function ga({wordClinicalEntity:t}){if(h.useMemo(()=>typeof t<"u"&&Object.keys(t)?.length>0,[t])){const n=t;return r.jsxs(q,{size:"m",direction:"vertical",children:[r.jsxs("div",{children:[r.jsx("b",{children:"Clinical Insight: "}),n.Spans[0].Content]}),r.jsxs(q,{size:"m",direction:"horizontal",children:[r.jsx(ce,{label:"Category",children:pe(n.Category.replaceAll("_"," "))}),r.jsx(ce,{label:"Type",children:pe(n.Type.replaceAll("_"," "))})]}),n.Attributes.length>0&&r.jsx(fa,{attributes:n.Attributes}),r.jsx(In,{category:n.Category,type:n.Type,text:n.Spans[0].Content})]})}else return}const ba=h.memo(ga);function xa({isPunctuation:t,highlightWord:e,disableSegment:n=!1,isClinicalEntity:s=!1,wordBeginAudioTime:i,audioDuration:a,word:c,wordClinicalEntity:o,audioReady:l,wavesurfer:m}){const p=h.useMemo(()=>{const d={color:"",fontWeight:"normal"};return s&&(d.color=cn,d.fontWeight="bold"),e&&(d.color=vi,d.fontWeight="bold"),n&&(d.color=ln),d},[e,n,s]),u=h.useMemo(()=>typeof c.Confidence=="number"?c.Confidence===0?"n/a":Math.round(c.Confidence*100*100)/100+"%":"n/a",[c.Confidence]);function b(){return a&&i?r.jsx(Y,{textAlign:"center",children:r.jsx(ne,{disabled:!l,onClick:()=>{m&&(m.current?.seekTo(a===-1?0:i/a+.001),Le.success(`Seeked to: ${i} seconds`))},children:"Jump to"})}):!1}return r.jsxs(r.Fragment,{children:[!t&&r.jsx("span",{children:" "}),r.jsx(et,{dismissButton:!1,position:"right",size:"large",triggerType:"custom",content:r.jsxs(q,{size:"m",direction:"vertical",children:[r.jsx(ce,{label:"Confidence",children:u}),o&&r.jsx(ba,{wordClinicalEntity:o}),r.jsx(b,{})]}),children:r.jsx("span",{style:p,onCopy:()=>{Le.success("Copied Text!")},children:c.Content})})]})}const va=h.memo(xa),Sa=h.memo(function({script:e,smallTalkCheck:n,audioTime:s,audioReady:i,wavesurfer:a}){const c=h.useRef(null),[o,l]=h.useState(!1),m=()=>{c.current.scrollIntoView({behavior:"smooth",block:a.current?.isPlaying()?"nearest":"start",inline:"center"}),l(!0)};h.useEffect(()=>{s>=e.BeginAudioTime&&s<=e.EndAudioTime&&!o?m():(s<e.BeginAudioTime||s>e.EndAudioTime)&&o&&l(!1)},[s]);const p=h.useMemo(()=>["OTHER","SMALL_TALK"].includes(e.SectionDetails.SectionName)&&n,[e.SectionDetails.SectionName,n]),u=h.useMemo(()=>i&&a.current?.getDuration()||-1,[i]);return r.jsx("div",{ref:c,style:{scrollMarginTop:"80px"},children:e.Words.map((b,d)=>{const x=b.BeginAudioTime===b.EndAudioTime,v=s>b.BeginAudioTime&&s<b.EndAudioTime&&!x,g=!!b.ClinicalEntity&&!!b.Type;return b.Alternatives?.[0]?r.jsx(va,{isPunctuation:x,highlightWord:v,disableSegment:p,isClinicalEntity:g,wordBeginAudioTime:b.BeginAudioTime,audioDuration:u,word:b.Alternatives[0],wordClinicalEntity:b.ClinicalEntity,audioReady:i,wavesurfer:a},d):!1})})}),Vt="10px";function Ea({jobLoading:t,transcript:e,highlightId:n,setHighlightId:s,wavesurfer:i,smallTalkCheck:a,audioTime:c,setAudioTime:o,audioReady:l}){const[m,p]=h.useState([]),[u,b]=h.useState([]);return h.useEffect(()=>{if(t||e==null)return;p([]);const d=e.Conversation?.ClinicalInsights,x=e.Conversation?.TranscriptSegments;let g=e.Conversation?.TranscriptItems;const I=[];for(const E of x){const R=g.findIndex(y=>y.EndAudioTime>E.EndAudioTime),P=R===-1?g:g.slice(0,R);I.push({...E,Words:P}),g=g.slice(P.length)}const A=I.reduce((E,R)=>(E[R.SegmentId]=R,E),{}),w=[...new Set(x.map(E=>E.ParticipantDetails.ParticipantRole))];if(w.length>2){const P=[...new Set(w.map(y=>y.split("_")[0]))].map(y=>({speaker:y,count:w.filter(V=>V.split("_")[0]===y).length})).filter(y=>y.count>1).map(y=>y.speaker);P.length>0&&p(P)}const M={};for(const E of d)for(const R of E.Spans){let P=0;const V=Object.entries(A[R.SegmentId].Words).filter(([,{Alternatives:j}])=>{const k=P;return typeof j<"u"&&j.length>0&&j[0].Content?.length===1&&!/^[a-zA-Z]+$/.test(j[0].Content[0])?P+=j[0].Content.length:P+=(j?.[0].Content||"0").length+1,R.BeginCharacterOffset<=k&&R.EndCharacterOffset>=k}).map(([j])=>j);for(const j of V){const k=parseInt(j);if(k!==-1)switch(E.InsightType){case"ClinicalEntity":{A[R.SegmentId].Words[k].ClinicalEntity=E,E.InsightId in M||(M[E.InsightId]=A[R.SegmentId].Words[k].BeginAudioTime);break}}else ri.error(`Insight missed: ${E}`)}}b(Object.values(A))},[t,e]),h.useEffect(()=>{function d(){s({allSegmentIds:[],selectedSegmentId:""})}if(n.selectedSegmentId){const x=u.filter(g=>n.allSegmentIds.includes(g.SegmentId))?.map(g=>({SegmentId:g.SegmentId,BeginAudioTime:g.BeginAudioTime,EndAudioTime:g.EndAudioTime}));if(x.length===0){d();return}const v=x.findIndex(g=>g.SegmentId===n.selectedSegmentId);!l&&v>=0&&o(x[v].BeginAudioTime)}},[n,e,l,o]),t||e==null?r.jsx(mt,{containerTitle:"Transcript",text:"Loading Transcript"}):r.jsx(gn,{containerTitle:"Transcript",children:u.map((d,x)=>{const v=d.ParticipantDetails.ParticipantRole!==u[x-1]?.ParticipantDetails.ParticipantRole,g=d.ParticipantDetails.ParticipantRole.split("_")[0],I=m.includes(g)?`${pe(g)} ${parseInt(d.ParticipantDetails.ParticipantRole.split("_")[1])+1}`:pe(g),A=d.SegmentId===n.selectedSegmentId?lt:n.allSegmentIds.includes(d.SegmentId)?lt:"";return r.jsx("div",{style:{paddingTop:x?"":"15px"},children:r.jsxs(ai,{disableGutters:!0,gridDefinition:[{colspan:2},{colspan:10}],children:[r.jsx("div",{style:{paddingTop:v&&x>0?Vt:"",fontWeight:"bold",fontSize:m?"14px":"16px",color:["OTHER","SMALL_TALK"].includes(d.SectionDetails.SectionName)&&a?ln:""},children:v&&r.jsx("div",{className:`${Dt.row} ${Dt.hidescrollbar}`,children:I})}),r.jsx("div",{style:{paddingTop:v&&x>0?Vt:"",backgroundColor:A},children:r.jsx(Sa,{script:d,smallTalkCheck:a,audioTime:c,audioReady:l,wavesurfer:i})})]})},x)})})}const T={root:"awsui_root_pcgz5_3bv9o_153",slider:"awsui_slider_pcgz5_3bv9o_190","slider-track":"awsui_slider-track_pcgz5_3bv9o_194","slider-range":"awsui_slider-range_pcgz5_3bv9o_194",disabled:"awsui_disabled_pcgz5_3bv9o_209",readonly:"awsui_readonly_pcgz5_3bv9o_213",error:"awsui_error_pcgz5_3bv9o_222",warning:"awsui_warning_pcgz5_3bv9o_225",active:"awsui_active_pcgz5_3bv9o_228","error-active":"awsui_error-active_pcgz5_3bv9o_231","warning-active":"awsui_warning-active_pcgz5_3bv9o_234",labels:"awsui_labels_pcgz5_3bv9o_245","labels-noref":"awsui_labels-noref_pcgz5_3bv9o_251","labels-reference":"awsui_labels-reference_pcgz5_3bv9o_254","labels-min":"awsui_labels-min_pcgz5_3bv9o_261","labels-max":"awsui_labels-max_pcgz5_3bv9o_267","labels-aria-description":"awsui_labels-aria-description_pcgz5_3bv9o_275",ticks:"awsui_ticks_pcgz5_3bv9o_293","ticks-wrapper":"awsui_ticks-wrapper_pcgz5_3bv9o_299",tick:"awsui_tick_pcgz5_3bv9o_293",middle:"awsui_middle_pcgz5_3bv9o_314",filled:"awsui_filled_pcgz5_3bv9o_317","tooltip-thumb":"awsui_tooltip-thumb_pcgz5_3bv9o_345",thumb:"awsui_thumb_pcgz5_3bv9o_358",min:"awsui_min_pcgz5_3bv9o_394",max:"awsui_max_pcgz5_3bv9o_397"};function _a({min:t,max:e,referenceValues:n,valueFormatter:s,labelsId:i,ariaDescription:a}){const o=oi()?4:10,l=(e-t)/o,m=()=>{if(!n||n.length===0)return[];const u=[];let b=t;for(let d=0;d<=n.length;d++)n[d]>t&&n[d]<e&&Math.abs(n[d]-b)>=l&&Math.abs(e-n[d])>=l&&Number.isInteger(n[d])&&(u.push(n[d]),b=n[d]);return u};function p(u){const b=Math.floor(l/2),d=u-b,x=u+b;if(e-t<=o)return{min:1,max:(e-t)*2-1,posStart:(u-t)*2,posEnd:(u-t)*2};const g=Math.round(b/2);return{min:b*2+g,max:(e-t-b)*2-g+1,posStart:(d-t)*2+1+g,posEnd:(x-t)*2-g}}return S.createElement(S.Fragment,null,S.createElement("div",{role:"list","aria-hidden":!s&&!n?"true":void 0,className:z(T.labels,{[T["labels-noref"]]:m().length===0}),style:{[xe.sliderLabelCount]:m().length===0?2:(e-t)*2},id:a?void 0:i},S.createElement("span",{role:"listitem",className:z(T.label,T["labels-min"]),style:{[xe.sliderMinEnd]:p(0).min}},s?s(t):t),m().map(u=>S.createElement("span",{role:"listitem",key:u,style:{[xe.sliderReferenceColumn]:p(u).posStart,[xe.sliderNextReferenceColumn]:p(u).posEnd},className:z(T.label,T["labels-reference"])},s?s(u):u)),S.createElement("span",{role:"listitem",className:z(T.label,T["labels-max"]),style:{[xe.sliderMaxStart]:n?p(0).max:2}},s?s(e):e)),a&&S.createElement("div",{className:T["labels-aria-description"],id:i},a))}function ya(t,e){return(t-e[0])/(e[1]-e[0])*100}function Ca(t){var e;if(Math.floor(t)===t)return 0;const n=Math.abs(t).toString();return n.indexOf("-")!==-1?parseInt(n.split("-")[1],10)||0:((e=n.split(".")[1])===null||e===void 0?void 0:e.length)||0}const Mn=(t,[e,n])=>{const s=[e],i=Math.pow(10,Ca(t));let a=e;for(;a<n;)a=(i*a+i*t)/i,a<=n&&s.push(a);return s},wa=(t,e)=>{let n=[...t];n=n.sort((c,o)=>c-o);const s=n.indexOf(e)||0,i=n[s-1]||void 0,a=n[s+1]||void 0;return{lower:i,higher:a}},Ta=t=>(t?.filter(n=>!Number.isInteger(n))).length===0,Ia=16,Ma=12;function ot(t){const{hideFillLine:e,value:n,isActive:s,invalid:i,warning:a,disabled:c,type:o,min:l,max:m,step:p,readOnly:u}=t,b=a&&!i,d=()=>o==="min"?l:o==="max"?m:p;return S.createElement("div",{className:z(T.tick,{[T.filled]:!e&&n>d(),[T.active]:!e&&s&&n>d(),[T.error]:i&&!e&&n>d(),[T.warning]:b&&!e&&n>d(),[T["error-active"]]:i&&s&&!e&&n>d(),[T["warning-active"]]:b&&s&&!e&&n>d(),[T.disabled]:c,[T.readonly]:u,[T.middle]:o==="step"})})}function ja(t){const{min:e,max:n,step:s}=t;return S.createElement("div",{className:T["ticks-wrapper"]},S.createElement(ot,Object.assign({},t,{type:"min"})),S.createElement("div",{className:T.ticks,style:{[xe.sliderTickCount]:Math.round((n-e)/s)}},Mn(s,[e,n]).map((i,a)=>S.createElement(ot,Object.assign({},t,{type:"step",step:i,key:`step-${a}`})))),S.createElement(ot,Object.assign({},t,{type:"max"})))}function Ra(t){var{value:e,min:n,max:s,onChange:i,step:a,disabled:c,readOnly:o,ariaLabel:l,ariaDescription:m,referenceValues:p,tickMarks:u,hideFillLine:b,valueFormatter:d,i18nStrings:x,__internalRootRef:v=null}=t,g=dt(t,["value","min","max","onChange","step","disabled","readOnly","ariaLabel","ariaDescription","referenceValues","tickMarks","hideFillLine","valueFormatter","i18nStrings","__internalRootRef"]);const I=Qt(g),A=Gt("slider"),w=h.useRef(null),[M,E]=h.useState(!1),[R,P]=h.useState(!1),y=Zt("labels"),{ariaLabelledby:V,ariaDescribedby:j,controlId:k,invalid:U,warning:J}=ci(g),G=J&&!U;p&&Ta(p);const D=(()=>{const Z=a&&a<s-n&&a>n;return e===void 0?s<n?n:n+(s-n)/2:a&&a&&Z&&(e-n)%a!==0?Mn(a,[n,s]).reduce(function(te,he){return Math.abs(he-e)<Math.abs(te-e)?he:te}):e})(),H=ya(Math.max(Math.min(D,s),n),[n,s]),Se=()=>{if(d&&d(D))return d(D);if(d&&!d(D)){const Q=[n,...p||[],D,s],te=wa(Q,D),he=te.lower?d(te.lower):d(n),ge=te.higher?d(te.higher):d(s),be=D;return A("i18nStrings.valueTextRange",x?.valueTextRange(he,be,ge),Ee=>Ee({value:be,previousValue:he,nextValue:ge}))}},fe=o?Ma:Ia;return S.createElement("div",Object.assign({},I,{ref:v,className:z(I.className,T.root)}),M&&S.createElement(Kt,{value:d?d(D):D,trackRef:w,onDismiss:()=>E(!1)}),S.createElement("div",{ref:w,className:z(T["tooltip-thumb"],{[T.readonly]:o}),style:{[xe.sliderTooltipPosition]:`calc(${H}% - ${fe}px)`}}),S.createElement("div",{className:T.slider},S.createElement("div",{className:z(T["slider-track"],{[T.disabled]:c,[T.readonly]:o})}),!b&&S.createElement("div",{className:z(T["slider-range"],{[T.error]:U,[T.warning]:G,[T.active]:R,[T["error-active"]]:U&&R,[T["warning-active"]]:G&&R,[T.disabled]:c,[T.readonly]:o}),style:{[xe.sliderRangeInlineSize]:`${H}%`}})),!!a&&u&&S.createElement(ja,{hideFillLine:b,disabled:c,readOnly:o,invalid:U,warning:J,isActive:R,step:a,min:n,max:s,value:D}),S.createElement("input",{tabIndex:0,"aria-label":l,"aria-labelledby":l&&!g.ariaLabelledby?void 0:V,"aria-describedby":d?j?`${y} ${j}`:y:j,"aria-valuetext":Se(),"aria-invalid":U?"true":void 0,"aria-disabled":o&&!c?"true":void 0,id:k,type:"range",min:n,max:s,disabled:c,onFocus:()=>{E(!0),P(!0)},onBlur:()=>{E(!1),P(!1)},onMouseEnter:()=>{E(!0)},onMouseLeave:()=>{E(!1)},onTouchStart:()=>{E(!0),P(!0)},onTouchEnd:()=>{E(!1),P(!1)},step:a,value:D,onChange:Z=>{o||i&&en(i,{value:Number(Z.target.value)})},className:z(T.thumb,{[T.error]:U,[T.warning]:G,[T.disabled]:c,[T.readonly]:o,[T.min]:D<=n||s<n,[T.max]:D>=s&&n<s})}),S.createElement(_a,{min:n,max:s,referenceValues:p,valueFormatter:d,labelsId:y,ariaDescription:m}))}function jn(t){var{tickMarks:e,hideFillLine:n}=t,s=dt(t,["tickMarks","hideFillLine"]);const i=Xt("Slider",{props:{tickMarks:e,hideFillLine:n,readOnly:s.readOnly}});return S.createElement(Ra,Object.assign({tickMarks:e,hideFillLine:n},s,i))}tn(jn,"Slider");function Aa({hasInsightSections:t,dataExtracted:e,extractingData:n,clinicalDocumentNereUnits:s,setRightPanelSettingsOpen:i,handleExtractHealthData:a}){const{appSettings:c}=Qe(),o=h.useMemo(()=>c["app.comprehendMedicalEnabled"],[c]),l=h.useMemo(()=>t&&o,[t,o]);return r.jsxs(q,{size:"xs",alignItems:"center",direction:"horizontal",children:[r.jsx(ne,{iconName:"settings",variant:"icon",onClick:()=>i(!0)}),r.jsx(ne,{disabled:!l||e,loading:n,onClick:()=>a(),children:"Extract Health Data"}),r.jsx(Tn,{}),r.jsx(ha,{clinicalDocumentNereUnits:s})]})}function Da({rightPanelSettingsOpen:t,setRightPanelSettingsOpen:e,acceptableConfidence:n,setAcceptableConfidence:s}){return r.jsx(rn,{onDismiss:()=>e(!1),visible:t,footer:r.jsxs(Y,{children:[r.jsx(ne,{variant:"link",onClick:()=>s(75),children:"Reset to Defaults"}),r.jsx(Y,{float:"right",children:r.jsxs(q,{direction:"horizontal",size:"xs",children:[r.jsx(ne,{variant:"link",onClick:()=>e(!1),children:"Cancel"}),r.jsx(ne,{variant:"primary",onClick:()=>e(!1),children:"OK"})]})})]}),header:"Insights Settings",children:r.jsx(li,{label:"Comprehend Medical Confidence Score Threshold",description:"Extracted medical entities with confidence scores lower than this are not shown.",children:r.jsx(jn,{onChange:({detail:i})=>s(i.value),value:n,max:99,min:0})})})}const Pa="T",Na="U",Oa="V",La="W",ka="Y",za="Z",oe={summaryList:Pa,summaryListItem:Na,summaryListItemIndent:Oa,summaryListItemSubHeader:La,summarizedSegment:ka,extractedHealthDataWord:za};function $a({word:t,wordData:e}){return r.jsx(et,{dismissButton:!1,position:"right",size:"large",triggerType:"custom",content:r.jsx(q,{size:"xs",direction:"vertical",children:e.map((n,s)=>r.jsx(ke,{defaultExpanded:!0,headerText:n.Text,children:r.jsxs(q,{size:"s",direction:"vertical",children:[r.jsxs(ce,{label:"Confidence",children:[Math.round((n.Score||0)*100),"%"]}),r.jsxs(q,{size:"m",direction:"horizontal",children:[r.jsx(ce,{label:"Category",children:pe((n.Category||"").replaceAll("_"," "))}),r.jsx(ce,{label:"Type",children:pe((n.Type||"").replaceAll("_"," "))})]}),n.Attributes&&n.Attributes.length>0&&r.jsxs(q,{size:"m",direction:"horizontal",children:[r.jsx(ce,{label:"Relationship To",children:n.Attributes[0].Text}),r.jsx(ce,{label:"Type",children:pe((n.Attributes[0].Type||"").replaceAll("_"," "))}),r.jsxs(ce,{label:"Score",children:[Math.round((n.Attributes[0].Score||0)*100),"%"]})]}),n.Text&&r.jsx(In,{category:n.Category||"",type:n.Type||"",text:n.Text})]})},`expandable_${s}`))}),children:r.jsx("span",{style:{color:cn,fontWeight:"bold"},children:t})})}const Ha=h.memo($a);function Ut({linkedId:t,sectionExtractedData:e,word:n,acceptableConfidence:s}){const i=[];return t.forEach(a=>{const c=(e.extractedData||[]).find(o=>o.Id===a);typeof c<"u"&&c.Score&&c.Score*100>s&&i.push(c)}),r.jsxs("div",{className:oe.extractedHealthDataWord,children:[i.length>0?r.jsx(Ha,{word:n,wordData:i}):n," "]})}function Fa(t){const e=t.flat(),n=new Set(e);return Array.from(n)}function Ae(t){return t.trim().replace(/^-/,"").trim()}function Ba(t,e){if(t.length===0||e.length===0)return[];const n=[];return t.forEach(s=>{const i=s.SectionName,a=e.find(o=>o.SectionName===i),c=[];s.Summary.forEach((o,l)=>{const m={words:[]},u=Ae(o.SummarizedSegment).split(" ");if(typeof a>"u")return;const b=a?.ExtractedEntities?.[l]?.Entities||[];m.words=u.map(g=>({word:g,linkedId:[]})),m.extractedData=b;const d=new Map;m.extractedData.forEach(({BeginOffset:g,EndOffset:I,Id:A})=>{if(typeof g=="number"&&typeof I=="number")for(let w=g;w<=I;w++)d.has(w)||d.set(w,[]),d.get(w).push(A)});let x=0,v=0;for(let g=0;g<u.length;g++){const A=u[g].length;x+=A+1;const w=[];for(;v<x;)w.push(d.get(v)||[]),v++;if(m.words[g].linkedId=Fa(w),x>=Math.max(...d.keys()))break}c.push(m)}),n.push({SectionName:i,Summary:c})}),n}function Va(){return r.jsx("div",{style:{paddingLeft:"5px"},children:r.jsx(Y,{variant:"small",children:"No Clinical Entities"})})}function Ua({sectionName:t,summary:e,summaryExtractedHealthData:n,acceptableConfidence:s,currentSegment:i="",handleSegmentClick:a}){return e.length?r.jsx("ul",{className:oe.summaryList,children:e.map(({EvidenceLinks:c,SummarizedSegment:o},l)=>{if(o==="")return!1;let m="",p=!1;if(o.endsWith(`
`)){const d=o.split(`
`);o.split(`
`).length===3&&(m=d[0],o=o.substring(o.indexOf(`
`)+1)),p=!0}const u=m?m.split(" ").length:0,b={color:Si,backgroundColor:i===o?lt:""};if(n){const d=n[l];return r.jsxs("div",{children:[u>0&&r.jsx("div",{className:oe.summaryListItemSubHeader,children:d.words.slice(0,u).map(({word:x,linkedId:v},g)=>r.jsx(Ut,{linkedId:v,sectionExtractedData:d,word:x,acceptableConfidence:s},`${t}_${l}_${g}`))}),r.jsx("li",{className:`${oe.summaryListItem} ${p&&oe.summaryListItemIndent}`,children:r.jsx("div",{onClick:()=>a(o,c),className:oe.summarizedSegment,style:b,children:d.words.slice(u).map(({word:x,linkedId:v},g)=>x==="-"&&g<=1?!1:r.jsx(Ut,{linkedId:v,sectionExtractedData:d,word:x,acceptableConfidence:s},`${t}_${l}_${g}`))})})]},`${t}_${l}`)}else return r.jsxs("div",{children:[m&&r.jsx("div",{className:oe.summaryListItemSubHeader,children:m}),r.jsx("li",{className:`${oe.summaryListItem} ${p&&oe.summaryListItemIndent}`,children:r.jsx("div",{onClick:()=>a(o,c),className:oe.summarizedSegment,style:b,children:Ae(o)})})]},`${t}_${l}`)})}):r.jsx(Va,{})}const Wa=["CHIEF_COMPLIANT","HISTORY_OF_PRESENT_ILLNESS","PAST_MEDICAL_HISTORY","PAST_FAMILY_HISTORY","PAST_SOCIAL_HISTORY","REVIEW_OF_SYSTEMS","PHYSICAL_EXAMINATION","DIAGNOSTIC_TESTING","ASSESSMENT","PLAN"],qa=["GOAL","INTERVENTION","RESPONSE","PROGRESS","PLAN"];function Ja({sections:t,extractedHealthData:e,acceptableConfidence:n,highlightId:s,setHighlightId:i,segmentById:a,wavesurfer:c}){const[o,l]=h.useState(0),[m,p]=h.useState("");h.useEffect(()=>{s.selectedSegmentId||p("")},[s]);const u=h.useMemo(()=>Ba(t,e),[t,e]);function b(x,v){let g=o;m!==x&&(p(x),l(0),g=0);const I=v[g].SegmentId,A={allSegmentIds:v.map(E=>E.SegmentId),selectedSegmentId:I};i(A);const w=c.current?.getDuration(),M=g+1;if(w){const E=a[I].BeginAudioTime/w;c.current?.seekTo(E),g<v.length-1?l(g+1):l(0),Le.success(`Jump Successful. Sentence ${M} of ${v.length}`)}else w?Le.error("Unable to jump to that Clinical Attribute"):(g<v.length-1?l(g+1):l(0),Le.success(`Jump Successful. Sentence ${M} of ${v.length}. Audio not yet ready`))}const d=h.useMemo(()=>{const x=typeof t.find(v=>v.SectionName==="CHIEF_COMPLIANT")<"u"?Wa:qa;return t.sort((v,g)=>x.indexOf(v.SectionName)-x.indexOf(g.SectionName)||1)},[t]);return console.debug("sortedSections",t,d),r.jsx(r.Fragment,{children:d.map(({SectionName:x,Summary:v},g)=>{const I=u.find(A=>A.SectionName===x);return r.jsxs("div",{children:[r.jsx(on,{children:r.jsx("h3",{children:pe(x.replace(/_/g," "))})}),r.jsx(Ua,{sectionName:x,summary:v,summaryExtractedHealthData:I?.Summary,acceptableConfidence:n,currentSegment:m,handleSegmentClick:b})]},`insightsSection_${g}`)})})}function Ga(t){if(!t)return 0;const e=t.ClinicalDocumentation.Sections.reduce((i,{Summary:a})=>i+a.reduce((c,{SummarizedSegment:o})=>c+Math.ceil(Ae(o).length/100),0),0),n=t.ClinicalDocumentation.Sections.reduce((i,{Summary:a})=>i+Math.ceil(a.reduce((c,{SummarizedSegment:o})=>c+Ae(o).length,0)/100),0),s=Math.ceil(t.ClinicalDocumentation.Sections.reduce((i,{Summary:a})=>i+a.reduce((c,{SummarizedSegment:o})=>c+Ae(o).length,0),0)/100);return{eachSegment:e,eachSection:n,allAtOnce:s}}function Ya({jobLoading:t,summary:e,transcript:n,highlightId:s,setHighlightId:i,wavesurfer:a}){const[c,o]=h.useState(!1),[l,m]=h.useState([]),[p,u]=h.useState(!1),[b,d]=di("Insights-Comprehend-Medical-Confidence-Threshold",75),x=h.useMemo(()=>n==null?{}:n.Conversation.TranscriptSegments.reduce((A,w)=>({...A,[w.SegmentId]:w}),{}),[n]),v=h.useMemo(()=>typeof e?.ClinicalDocumentation?.Sections>"u"?!1:e?.ClinicalDocumentation?.Sections?.length>0,[e]),g=h.useCallback(async()=>{if(!Array.isArray(e?.ClinicalDocumentation?.Sections))return;o(!0);const A=[];for(const w of e.ClinicalDocumentation.Sections){const M=[];for(const E of w.Summary){const R=Ae(E.SummarizedSegment),P=await oa(R);M.push(P)}A.push({SectionName:w.SectionName,ExtractedEntities:M})}m(A),o(!1)},[e,o,m]),I=h.useMemo(()=>Ga(e),[e]);return t||e==null?r.jsx(mt,{containerTitle:"Insights",text:"Loading Insights"}):r.jsxs(gn,{containerTitle:"Insights",containerActions:r.jsx(Aa,{hasInsightSections:v,dataExtracted:l.length>0,extractingData:c,clinicalDocumentNereUnits:I,setRightPanelSettingsOpen:u,handleExtractHealthData:g}),children:[r.jsx(Da,{rightPanelSettingsOpen:p,setRightPanelSettingsOpen:u,acceptableConfidence:b,setAcceptableConfidence:d}),r.jsx(Ja,{sections:e.ClinicalDocumentation.Sections,extractedHealthData:l,acceptableConfidence:b,highlightId:s,setHighlightId:i,segmentById:x,wavesurfer:a})]})}class Rn{constructor(){this.listeners={}}on(e,n,s){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(n),s?.once){const i=()=>{this.un(e,i),this.un(e,n)};return this.on(e,i),i}return()=>this.un(e,n)}un(e,n){var s;(s=this.listeners[e])===null||s===void 0||s.delete(n)}once(e,n){return this.on(e,n,{once:!0})}unAll(){this.listeners={}}emit(e,...n){this.listeners[e]&&this.listeners[e].forEach(s=>s(...n))}}class Ka extends Rn{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}_init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e())}}function We(t,e,n,s,i=3,a=0,c=100){if(!t)return()=>{};const o=matchMedia("(pointer: coarse)").matches;let l=()=>{};const m=p=>{if(p.button!==a)return;p.preventDefault(),p.stopPropagation();let u=p.clientX,b=p.clientY,d=!1;const x=Date.now(),v=M=>{if(M.preventDefault(),M.stopPropagation(),o&&Date.now()-x<c)return;const E=M.clientX,R=M.clientY,P=E-u,y=R-b;if(d||Math.abs(P)>i||Math.abs(y)>i){const V=t.getBoundingClientRect(),{left:j,top:k}=V;d||(n?.(u-j,b-k),d=!0),e(P,y,E-j,R-k),u=E,b=R}},g=M=>{if(d){const E=M.clientX,R=M.clientY,P=t.getBoundingClientRect(),{left:y,top:V}=P;s?.(E-y,R-V)}l()},I=M=>{M.relatedTarget&&M.relatedTarget!==document.documentElement||g(M)},A=M=>{d&&(M.stopPropagation(),M.preventDefault())},w=M=>{d&&M.preventDefault()};document.addEventListener("pointermove",v),document.addEventListener("pointerup",g),document.addEventListener("pointerout",I),document.addEventListener("pointercancel",I),document.addEventListener("touchmove",w,{passive:!1}),document.addEventListener("click",A,{capture:!0}),l=()=>{document.removeEventListener("pointermove",v),document.removeEventListener("pointerup",g),document.removeEventListener("pointerout",I),document.removeEventListener("pointercancel",I),document.removeEventListener("touchmove",w),setTimeout(()=>{document.removeEventListener("click",A,{capture:!0})},10)}};return t.addEventListener("pointerdown",m),()=>{l(),t.removeEventListener("pointerdown",m)}}function An(t,e){const n=e.xmlns?document.createElementNS(e.xmlns,t):document.createElement(t);for(const[s,i]of Object.entries(e))if(s==="children")for(const[a,c]of Object.entries(e))typeof c=="string"?n.appendChild(document.createTextNode(c)):n.appendChild(An(a,c));else s==="style"?Object.assign(n.style,i):s==="textContent"?n.textContent=i:n.setAttribute(s,i.toString());return n}function Oe(t,e,n){const s=An(t,e||{});return n?.appendChild(s),s}class Wt extends Rn{constructor(e,n,s=0){var i,a,c,o,l,m,p,u,b,d;super(),this.totalDuration=n,this.numberOfChannels=s,this.minLength=0,this.maxLength=1/0,this.contentEditable=!1,this.subscriptions=[],this.subscriptions=[],this.id=e.id||`region-${Math.random().toString(32).slice(2)}`,this.start=this.clampPosition(e.start),this.end=this.clampPosition((i=e.end)!==null&&i!==void 0?i:e.start),this.drag=(a=e.drag)===null||a===void 0||a,this.resize=(c=e.resize)===null||c===void 0||c,this.resizeStart=(o=e.resizeStart)===null||o===void 0||o,this.resizeEnd=(l=e.resizeEnd)===null||l===void 0||l,this.color=(m=e.color)!==null&&m!==void 0?m:"rgba(0, 0, 0, 0.1)",this.minLength=(p=e.minLength)!==null&&p!==void 0?p:this.minLength,this.maxLength=(u=e.maxLength)!==null&&u!==void 0?u:this.maxLength,this.channelIdx=(b=e.channelIdx)!==null&&b!==void 0?b:-1,this.contentEditable=(d=e.contentEditable)!==null&&d!==void 0?d:this.contentEditable,this.element=this.initElement(),this.setContent(e.content),this.setPart(),this.renderPosition(),this.initMouseEvents()}clampPosition(e){return Math.max(0,Math.min(this.totalDuration,e))}setPart(){const e=this.start===this.end;this.element.setAttribute("part",`${e?"marker":"region"} ${this.id}`)}addResizeHandles(e){const n={position:"absolute",zIndex:"2",width:"6px",height:"100%",top:"0",cursor:"ew-resize",wordBreak:"keep-all"},s=Oe("div",{part:"region-handle region-handle-left",style:Object.assign(Object.assign({},n),{left:"0",borderLeft:"2px solid rgba(0, 0, 0, 0.5)",borderRadius:"2px 0 0 2px"})},e),i=Oe("div",{part:"region-handle region-handle-right",style:Object.assign(Object.assign({},n),{right:"0",borderRight:"2px solid rgba(0, 0, 0, 0.5)",borderRadius:"0 2px 2px 0"})},e);this.subscriptions.push(We(s,a=>this.onResize(a,"start"),()=>null,()=>this.onEndResizing(),1),We(i,a=>this.onResize(a,"end"),()=>null,()=>this.onEndResizing(),1))}removeResizeHandles(e){const n=e.querySelector('[part*="region-handle-left"]'),s=e.querySelector('[part*="region-handle-right"]');n&&e.removeChild(n),s&&e.removeChild(s)}initElement(){const e=this.start===this.end;let n=0,s=100;this.channelIdx>=0&&this.channelIdx<this.numberOfChannels&&(s=100/this.numberOfChannels,n=s*this.channelIdx);const i=Oe("div",{style:{position:"absolute",top:`${n}%`,height:`${s}%`,backgroundColor:e?"none":this.color,borderLeft:e?"2px solid "+this.color:"none",borderRadius:"2px",boxSizing:"border-box",transition:"background-color 0.2s ease",cursor:this.drag?"grab":"default",pointerEvents:"all"}});return!e&&this.resize&&this.addResizeHandles(i),i}renderPosition(){const e=this.start/this.totalDuration,n=(this.totalDuration-this.end)/this.totalDuration;this.element.style.left=100*e+"%",this.element.style.right=100*n+"%"}toggleCursor(e){var n;this.drag&&(!((n=this.element)===null||n===void 0)&&n.style)&&(this.element.style.cursor=e?"grabbing":"grab")}initMouseEvents(){const{element:e}=this;e&&(e.addEventListener("click",n=>this.emit("click",n)),e.addEventListener("mouseenter",n=>this.emit("over",n)),e.addEventListener("mouseleave",n=>this.emit("leave",n)),e.addEventListener("dblclick",n=>this.emit("dblclick",n)),e.addEventListener("pointerdown",()=>this.toggleCursor(!0)),e.addEventListener("pointerup",()=>this.toggleCursor(!1)),this.subscriptions.push(We(e,n=>this.onMove(n),()=>this.toggleCursor(!0),()=>{this.toggleCursor(!1),this.drag&&this.emit("update-end")})),this.contentEditable&&this.content&&(this.content.addEventListener("click",n=>this.onContentClick(n)),this.content.addEventListener("blur",()=>this.onContentBlur())))}_onUpdate(e,n){if(!this.element.parentElement)return;const{width:s}=this.element.parentElement.getBoundingClientRect(),i=e/s*this.totalDuration,a=n&&n!=="start"?this.start:this.start+i,c=n&&n!=="end"?this.end:this.end+i,o=c-a;a>=0&&c<=this.totalDuration&&a<=c&&o>=this.minLength&&o<=this.maxLength&&(this.start=a,this.end=c,this.renderPosition(),this.emit("update",n))}onMove(e){this.drag&&this._onUpdate(e)}onResize(e,n){this.resize&&(this.resizeStart||n!=="start")&&(this.resizeEnd||n!=="end")&&this._onUpdate(e,n)}onEndResizing(){this.resize&&this.emit("update-end")}onContentClick(e){e.stopPropagation(),e.target.focus(),this.emit("click",e)}onContentBlur(){this.emit("update-end")}_setTotalDuration(e){this.totalDuration=e,this.renderPosition()}play(e){this.emit("play",e&&this.end!==this.start?this.end:void 0)}setContent(e){var n;if((n=this.content)===null||n===void 0||n.remove(),e){if(typeof e=="string"){const s=this.start===this.end;this.content=Oe("div",{style:{padding:`0.2em ${s?.2:.4}em`,display:"inline-block"},textContent:e})}else this.content=e;this.contentEditable&&(this.content.contentEditable="true"),this.content.setAttribute("part","region-content"),this.element.appendChild(this.content)}else this.content=void 0}setOptions(e){var n,s;if(e.color&&(this.color=e.color,this.element.style.backgroundColor=this.color),e.drag!==void 0&&(this.drag=e.drag,this.element.style.cursor=this.drag?"grab":"default"),e.start!==void 0||e.end!==void 0){const i=this.start===this.end;this.start=this.clampPosition((n=e.start)!==null&&n!==void 0?n:this.start),this.end=this.clampPosition((s=e.end)!==null&&s!==void 0?s:i?this.start:this.end),this.renderPosition(),this.setPart()}if(e.content&&this.setContent(e.content),e.id&&(this.id=e.id,this.setPart()),e.resize!==void 0&&e.resize!==this.resize){const i=this.start===this.end;this.resize=e.resize,this.resize&&!i?this.addResizeHandles(this.element):this.removeResizeHandles(this.element)}e.resizeStart!==void 0&&(this.resizeStart=e.resizeStart),e.resizeEnd!==void 0&&(this.resizeEnd=e.resizeEnd)}remove(){this.emit("remove"),this.subscriptions.forEach(e=>e()),this.element.remove(),this.element=null}}class yt extends Ka{constructor(e){super(e),this.regions=[],this.regionsContainer=this.initRegionsContainer()}static create(e){return new yt(e)}onInit(){if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");this.wavesurfer.getWrapper().appendChild(this.regionsContainer);let e=[];this.subscriptions.push(this.wavesurfer.on("timeupdate",n=>{const s=this.regions.filter(i=>i.start<=n&&(i.end===i.start?i.start+.05:i.end)>=n);s.forEach(i=>{e.includes(i)||this.emit("region-in",i)}),e.forEach(i=>{s.includes(i)||this.emit("region-out",i)}),e=s}))}initRegionsContainer(){return Oe("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",zIndex:"5",pointerEvents:"none"}})}getRegions(){return this.regions}avoidOverlapping(e){e.content&&setTimeout(()=>{const n=e.content,s=n.getBoundingClientRect(),i=this.regions.map(a=>{if(a===e||!a.content)return 0;const c=a.content.getBoundingClientRect();return s.left<c.left+c.width&&c.left<s.left+s.width?c.height:0}).reduce((a,c)=>a+c,0);n.style.marginTop=`${i}px`},10)}adjustScroll(e){var n,s;const i=(s=(n=this.wavesurfer)===null||n===void 0?void 0:n.getWrapper())===null||s===void 0?void 0:s.parentElement;if(!i)return;const{clientWidth:a,scrollWidth:c}=i;if(c<=a)return;const o=i.getBoundingClientRect(),l=e.element.getBoundingClientRect(),m=l.left-o.left,p=l.right-o.left;m<0?i.scrollLeft+=m:p>a&&(i.scrollLeft+=p-a)}virtualAppend(e,n,s){const i=()=>{if(!this.wavesurfer)return;const a=this.wavesurfer.getWidth(),c=this.wavesurfer.getScroll(),o=n.clientWidth,l=this.wavesurfer.getDuration(),m=Math.round(e.start/l*o),p=m+(Math.round((e.end-e.start)/l*o)||1)>c&&m<c+a;p&&!s.parentElement?n.appendChild(s):!p&&s.parentElement&&s.remove()};setTimeout(()=>{if(!this.wavesurfer)return;i();const a=this.wavesurfer.on("scroll",i);this.subscriptions.push(e.once("remove",a),a)},0)}saveRegion(e){this.virtualAppend(e,this.regionsContainer,e.element),this.avoidOverlapping(e),this.regions.push(e);const n=[e.on("update",s=>{s||this.adjustScroll(e),this.emit("region-update",e,s)}),e.on("update-end",()=>{this.avoidOverlapping(e),this.emit("region-updated",e)}),e.on("play",s=>{var i;(i=this.wavesurfer)===null||i===void 0||i.play(e.start,s)}),e.on("click",s=>{this.emit("region-clicked",e,s)}),e.on("dblclick",s=>{this.emit("region-double-clicked",e,s)}),e.once("remove",()=>{n.forEach(s=>s()),this.regions=this.regions.filter(s=>s!==e),this.emit("region-removed",e)})];this.subscriptions.push(...n),this.emit("region-created",e)}addRegion(e){var n,s;if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");const i=this.wavesurfer.getDuration(),a=(s=(n=this.wavesurfer)===null||n===void 0?void 0:n.getDecodedData())===null||s===void 0?void 0:s.numberOfChannels,c=new Wt(e,i,a);return i?this.saveRegion(c):this.subscriptions.push(this.wavesurfer.once("ready",o=>{c._setTotalDuration(o),this.saveRegion(c)})),c}enableDragSelection(e,n=3){var s;const i=(s=this.wavesurfer)===null||s===void 0?void 0:s.getWrapper();if(!(i&&i instanceof HTMLElement))return()=>{};let a=null,c=0;return We(i,(o,l,m)=>{a&&a._onUpdate(o,m>c?"end":"start")},o=>{var l,m;if(c=o,!this.wavesurfer)return;const p=this.wavesurfer.getDuration(),u=(m=(l=this.wavesurfer)===null||l===void 0?void 0:l.getDecodedData())===null||m===void 0?void 0:m.numberOfChannels,{width:b}=this.wavesurfer.getWrapper().getBoundingClientRect(),d=o/b*p,x=(o+5)/b*p;a=new Wt(Object.assign(Object.assign({},e),{start:d,end:x}),p,u),this.regionsContainer.appendChild(a.element)},()=>{a&&(this.saveRegion(a),a=null)},n)}clearRegions(){this.regions.slice().forEach(e=>e.remove()),this.regions=[]}destroy(){this.clearRegions(),super.destroy(),this.regionsContainer.remove()}}const Xa="G",Za={segmentControls:Xa},qt=(t,e)=>{const i=t.length,a=e/i,c=.25/a,o=[];t.forEach((u,b)=>{Math.abs(u)<.0015&&o.push(b)});const l=[];return o.forEach(function(u,b){l.length&&u<=o[b-1]+c?l[l.length-1].push(u):l.push([u])}),l.filter(u=>u.length>=c).map(u=>({start:u[0],end:u[u.length-1]})).map(u=>({start:Math.round(u.start*a*10)/10,end:Math.round(u.end*a*10)/10}))};function Qa({jobLoading:t,jobDetails:e,transcript:n,wavesurfer:s,smallTalkCheck:i,setSmallTalkCheck:a,setAudioTime:c,setAudioReady:o}){const{addFlashMessage:l}=ut(),[m,p]=h.useState(),[u,b]=h.useState(!0),[d,x]=h.useState(!1),[v,g]=h.useState(!1),[I,A]=h.useState(1),[w,M]=h.useState(!1),[E,R]=h.useState([]),[P,y]=h.useState(0),[V,j]=h.useState(0),k=document.getElementById("waveform"),U=h.useMemo(()=>{if(!n)return[];const D=n.Conversation.TranscriptSegments;if(D.length>0){const H=[];for(const{SectionDetails:Se,BeginAudioTime:fe,EndAudioTime:Z}of D)["OTHER","SMALL_TALK"].includes(Se.SectionName)&&H.push({BeginAudioTime:fe,EndAudioTime:Z});return H}else return[]},[n]);function J(){if(!e?.Media?.MediaFileUri)throw Error("Unable to find HealthScribe audio URL")}h.useEffect(()=>{async function D(){try{J();const H=qe(e?.Media?.MediaFileUri),Se=await nn(H);s.current||(s.current=ui.create({backend:"MediaElement",container:k||"#waveform",height:40,normalize:!1,waveColor:"rgba(35, 47, 62, 0.8)",progressColor:"#2074d5",url:Se}),p(s.current.registerPlugin(yt.create()))),s.current.on("ready",()=>{const Z=s.current.getDuration(),Q=s.current.exportPeaks(),te=qt(Q[0],Z).reduce((ge,{start:be,end:Ee})=>ge+Ee-be,0);R(Q[0]),y(te/Z);const he=U.reduce((ge,{EndAudioTime:be,BeginAudioTime:Ee})=>ge+(be-Ee),0);j(he/Z),x(!0),b(!1),o(!0)}),s.current?.on("play",()=>{console.log("Wavesurfer PLAY event fired"),g(!0)}),s.current?.on("pause",()=>{console.log("Wavesurfer PAUSE event fired"),g(!1)}),s.current?.on("finish",()=>{console.log("Wavesurfer FINISH event fired"),g(!1)});const fe=()=>{c(s.current?.getCurrentTime()??0)};s.current?.on("audioprocess",fe),s.current?.on("seeking",fe)}catch(H){b(!1),l({id:H?.toString()||"GetHealthScribeJob error",header:"Conversation Error",content:H?.toString()||"GetHealthScribeJob error",type:"error"})}}!t&&k&&D().catch(console.error)},[t,k]),h.useEffect(()=>{if(!(!s.current||!m)){if(m.clearRegions(),i)for(const{BeginAudioTime:D,EndAudioTime:H}of U)m.addRegion({id:`${D}-${H}-smalltalk`,start:D,end:H,drag:!1,resize:!1,color:"rgba(255, 153, 0, 0.5)"});if(w)for(const{start:D,end:H}of qt(E,s.current.getDuration()))m.addRegion({id:`${D}-${H}-silence`,start:D,end:H,drag:!1,resize:!1,color:"rgba(255, 153, 0, 0.5)"});m.on("region-in",({end:D})=>{s.current.getCurrentTime()<D&&s.current?.seekTo(D/s.current?.getDuration())})}},[s,i,U,w,E]);function G(){return r.jsx("div",{style:{flex:"display",textAlign:"center",paddingTop:"30px",paddingBottom:"30px",color:"var(--color-text-status-inactive-5ei55p, #5f6b7a)"},children:r.jsxs(Y,{children:[r.jsx(ht,{})," Loading Audio"]})})}function Te(){if(!t&&!u)return r.jsx("div",{className:Za.segmentControls,children:r.jsxs(q,{size:"s",direction:"horizontal",children:[r.jsx(Y,{variant:"awsui-key-label",children:"Remove"}),r.jsxs(It,{checked:i,onChange:()=>a(!i),children:["Small Talk (",r.jsxs("i",{children:[Math.ceil(V*100),"%"]}),")"]}),r.jsxs(It,{checked:w,onChange:()=>M(!w),children:["Silences (",r.jsxs("i",{children:[Math.ceil(P*100),"%"]}),")"]})]})})}return r.jsxs($e,{children:[(t||u)&&r.jsx(G,{}),!t&&!u&&r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx(Y,{variant:"awsui-key-label",margin:{bottom:"s"},children:"Audio Controls"}),r.jsx(Ei,{wavesurfer:s,audioLoading:u,showControls:!0,setShowControls:x,playingAudio:v,setPlayingAudio:g,playBackSpeed:I,setPlayBackSpeed:A,isEmbeded:!0})]}),r.jsx(Te,{}),r.jsx("div",{style:{height:u?0:""},children:r.jsx("div",{id:"waveform",style:{marginTop:"5px",height:u?0:""}})})]})}function eo({jobLoading:t,jobDetails:e,summary:n}){if(t)return r.jsx(mt,{containerTitle:"Clinical Note"});if(!n)return r.jsx($e,{children:r.jsx(Y,{textAlign:"center",color:"text-status-inactive",children:"No clinical documentation available"})});const i=(()=>{const a=e?.Settings?.ClinicalNoteGenerationSettings?.NoteTemplate;if(console.log("Note template from job details:",a),a)switch(a){case"HISTORY_AND_PHYSICAL":return"History and Physical";case"GIRPP":return"GIRPP Note";case"BIRP":return"BIRP Note";case"SIRP":return"SIRP Note";case"DAP":return"DAP Note";case"BH_SOAP":return"BH-SOAP Note";case"PH_SOAP":return"PH-SOAP Note";default:return`${a} Note`}return"Clinical Note"})();return r.jsx($e,{header:r.jsx(Ge,{variant:"h2",description:"Structured clinical documentation generated from the conversation",children:i}),children:r.jsx(on,{children:r.jsx(q,{size:"l",direction:"vertical",children:n.ClinicalDocumentation.Sections.map((a,c)=>r.jsxs("div",{children:[r.jsx("h3",{children:a.SectionName.replace(/_/g," ").replace(/\b\w/g,o=>o.toUpperCase())}),r.jsx("div",{style:{marginLeft:"16px"},children:a.Summary.map((o,l)=>r.jsx("p",{style:{marginBottom:"8px",lineHeight:"1.5"},children:o.SummarizedSegment},l))})]},c))})})})}const to=h.lazy(()=>bi(()=>import("./index-BL_wyNUb.js"),__vite__mapDeps([0,1,2,3])));function lo(){const{conversationName:t}=hi(),{addFlashMessage:e}=ut(),{preferences:n}=mi(),[s,i]=h.useState(!0),[a,c]=h.useState(null),[o,l]=h.useState(!1),[m,p]=h.useState(!1),[u,b]=h.useState(),[d,x]=h.useState(),[v,g]=h.useState("transcript"),[I,A,w,M,E,R,P,y,V]=zi();return h.useEffect(()=>{async function j(k){try{i(!0);const J=(await gi({MedicalScribeJobName:k}))?.MedicalScribeJob;if(typeof J>"u")return;Object.keys(J).length>0&&c(J);const G=J.MedicalScribeOutput?.TranscriptFileUri,Te=await wt(qe(G||""));b(JSON.parse(await Te?.Body?.transformToString()||""));const D=J.MedicalScribeOutput?.ClinicalDocumentUri,H=await wt(qe(D||""));x(JSON.parse(await H?.Body?.transformToString()||""))}catch(U){c(null),i(!1),e({id:U?.toString()||"GetHealthScribeJob error",header:"Encounter Error",content:U?.toString()||"GetHealthScribeJob error",type:"error"})}i(!1)}if(t)j(t).catch(console.error);else return},[]),r.jsxs(pi,{headerVariant:"high-contrast",header:r.jsx($i,{jobDetails:a,setShowOutputModal:l,setDeleteModalActive:p}),children:[o&&r.jsx(h.Suspense,{fallback:r.jsx(fi,{}),children:r.jsx(to,{setVisible:l,transcriptString:JSON.stringify(u||"Loading...",null,2),clinicalDocumentString:JSON.stringify(d||"Loading...",null,2)})}),r.jsx(Hi,{jobDetails:a,deleteModalActive:m,setDeleteModalActive:p}),r.jsx(fn,{activeTabId:v,onChange:({detail:j})=>g(j.activeTabId),tabs:[{id:"transcript",label:"Transcript",content:r.jsxs(r.Fragment,{children:[r.jsx(Qa,{jobLoading:s,jobDetails:a,transcript:u,wavesurfer:I,smallTalkCheck:R,setSmallTalkCheck:P,setAudioTime:E,setAudioReady:w}),r.jsx(Ea,{jobLoading:s,transcript:u,highlightId:y,setHighlightId:V,wavesurfer:I,smallTalkCheck:R,audioTime:M,setAudioTime:E,audioReady:A})]})},{id:"clinical-note",label:"Clinical Note",content:r.jsx(eo,{jobLoading:s,jobDetails:a,summary:d})},...n.comprehendMedicalEnabled?[{id:"insights",label:"Insights",content:r.jsx(Ya,{jobLoading:s,summary:d,transcript:u,highlightId:y,setHighlightId:V,wavesurfer:I})}]:[]]})]})}export{lo as default};
