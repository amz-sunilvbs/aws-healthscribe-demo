import{d as Ao,A as vo,X as gt,a8 as cc,a9 as uc,aa as dc,ab as lc,ac as hc,ad as fc,ae as Xe,n as gs,af as ko,ag as pc,ah as gc,g as Is,E as mc,a as yc,b as xc,c as bc,r as Ec,ai as Cc,V as wc,aj as de,$ as Sc,a1 as Le,a2 as $t,ak as Ht,al as Ac,am as ms,an as Sn,ao as vc,a5 as Ro,a6 as Po,a7 as Bo,ap as un,aq as kc,ar as Pt,as as Rc,f as No,t as Pc,p as Bc,N as Nc,e as Ic,h as Tc,s as Dc,S as Uc,D as Oc,F as _c,i as Mc,j as Fc,k as Lc,l as $c,m as Hc,o as zc,q as jc,u as Kc,v as Wc,w as qc,x as Vc,y as Gc,z as Xc,C as Zc,B as Jc,G as Qc,H as Yc,I as eu,T as tu,J as nu,K as su,L as ru,M as iu,O as ou,P as au,Q as cu,U as uu,R as du,at as lu,au as hu}from"./index-XWbvETcy.js";import{bj as fu,bk as pu,bl as gu,bm as Io,bn as mu,bo as yu,bp as xu,bq as bu,br as Eu,bs as Cu,bt as ot,bu as wu,bv as To,bw as Su,bx as We,by as hr,bz as Do,bA as mt,bB as Zt,bC as Au,a1 as Uo,bD as Oo,bE as Ts,bF as vu,bG as _o,bH as Ds,aL as Mo,bI as Fo,bJ as Lo,bK as ku,ak as Ru,bL as Pu,_ as Us,l as $o,e as Oe,I as Bu,m as Ho,g as Nu,r as Ke,d as Iu,K as Tu,i as Du,aa as fr,aG as Uu,f as tn,bM as dt,ae as Ou,x as _u,aH as Mu,aI as Fu,b3 as Lu,aJ as $u,a7 as Hu,bN as zu,P as ju,bO as Ku,w as Wu,j as se,B as lt,a as pr,n as qu}from"./index-PUGhrfWv.js";import{i as Vu,r as zo,s as Gu}from"./requestBuilder-DyCm3tak.js";import{p as ys,a as jo,b as An}from"./index-BvNeingd.js";function Ko(t){return new Uint8Array([(t&4278190080)>>24,(t&16711680)>>16,(t&65280)>>8,t&255])}function Wo(t){if(!Uint32Array.from){for(var e=new Uint32Array(t.length),n=0;n<t.length;)e[n]=t[n],n+=1;return e}return Uint32Array.from(t)}const qo=t=>Object.keys(t).map(e=>e.toLowerCase()).sort().join(";"),Xu="X-Amz-Date",Zu="X-Amz-Security-Token",Ju="authorization",Qu="host",Yu=Xu.toLowerCase(),ed=Zu.toLowerCase(),Vo="aws4_request",Go="AWS4-HMAC-SHA256",td="AWS4",nd="e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",sd="UNSIGNED-PAYLOAD",rd=(t,e,n)=>`${t}/${e}/${n}/${Vo}`,id=t=>{const e=t.toISOString().replace(/[:-]|\.\d{3}/g,"");return{longDate:e,shortDate:e.slice(0,8)}},od=({credentials:t,signingDate:e=new Date,signingRegion:n,signingService:s,uriEscapePath:r=!0})=>{const{accessKeyId:o,secretAccessKey:i,sessionToken:a}=t,{longDate:d,shortDate:c}=id(e),u=rd(c,n,s);return{accessKeyId:o,credentialScope:u,longDate:d,secretAccessKey:i,sessionToken:a,shortDate:c,signingRegion:n,signingService:s,uriEscapePath:r}},Ft=(t,e)=>{const n=new pu(t??void 0);return n.update(e),n.digestSync()},xs=(t,e)=>{const n=Ft(t,e);return fu(n)},ad=t=>Object.entries(t).map(([e,n])=>({key:e.toLowerCase(),value:n?.trim().replace(/\s+/g," ")??""})).sort((e,n)=>e.key<n.key?-1:1).map(e=>`${e.key}:${e.value}
`).join(""),cd=t=>Array.from(t).sort(([e,n],[s,r])=>e===s?n<r?-1:1:e<s?-1:1).map(([e,n])=>`${gr(e)}=${gr(n)}`).join("&"),gr=t=>encodeURIComponent(t).replace(/[!'()*]/g,ud),ud=t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`,dd=(t,e=!0)=>t?e?encodeURIComponent(t).replace(/%2F/g,"/"):t:"/",Xo=t=>t==null?nd:ld(t)?xs(null,t):sd,ld=t=>typeof t=="string"||ArrayBuffer.isView(t)||hd(t),hd=t=>typeof ArrayBuffer=="function"&&t instanceof ArrayBuffer||Object.prototype.toString.call(t)==="[object ArrayBuffer]",fd=({body:t,headers:e,method:n,url:s},r=!0)=>[n,dd(s.pathname,r),cd(s.searchParams),ad(e),qo(e),Xo(t)].join(`
`),pd=(t,e,n,s)=>{const r=`${td}${t}`,o=Ft(r,e),i=Ft(o,n),a=Ft(i,s);return Ft(a,Vo)},gd=(t,e,n)=>[Go,t,e,n].join(`
`),md=(t,{credentialScope:e,longDate:n,secretAccessKey:s,shortDate:r,signingRegion:o,signingService:i,uriEscapePath:a})=>{const d=fd(t,a),c=xs(null,d),u=gd(n,e,c);return xs(pd(s,r,o,i),u)},yd=(t,e)=>{const n=od(e),{accessKeyId:s,credentialScope:r,longDate:o,sessionToken:i}=n,a={...t.headers};a[Qu]=t.url.host,a[Yu]=o,i&&(a[ed]=i);const d={...t,headers:a},c=md(d,n),u=`Credential=${s}/${r}`,f=`SignedHeaders=${qo(a)}`,h=`Signature=${c}`;return a[Ju]=`${Go} ${u}, ${f}, ${h}`,d},Zo=t=>new Date(Date.now()+t),xd=5*60*1e3,bd=(t,e)=>Math.abs(Zo(e).getTime()-t)>=xd,Ed=(t,e)=>bd(t,e)?t-Date.now():e,Cd=({credentials:t,region:e,service:n,uriEscapePath:s=!0})=>{let r;return(o,i)=>async function(d){r=r??0;const c={credentials:typeof t=="function"?await t({forceRefresh:!!i?.isCredentialsExpired}):t,signingDate:Zo(r),signingRegion:e,signingService:n,uriEscapePath:s},u=await yd(d,c),f=await o(u),h=wd(f);return h&&(r=Ed(Date.parse(h),r)),f}},wd=({headers:t}={})=>t?.date??t?.Date??t?.["x-amz-date"],bs=t=>{const e=/[!'()*]/g;return encodeURIComponent(t).replace(e,Sd)},Sd=t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`,Ad=t=>new TextEncoder().encode(t),et=64,vd=16,kd=[1732584193,4023233417,2562383102,271733878];let Rd=class{constructor(){this.reset()}update(e){if(Pd(e))return;if(this.finished)throw new Error("Attempted to update an already finished hash.");const n=Bd(e);let s=0,{byteLength:r}=n;for(this.bytesHashed+=r;r>0;)this.buffer.setUint8(this.bufferLength++,n[s++]),r--,this.bufferLength===et&&(this.hashBuffer(),this.bufferLength=0)}async digest(){if(!this.finished){const{buffer:n,bufferLength:s,bytesHashed:r}=this,o=r*8;if(n.setUint8(this.bufferLength++,128),s%et>=et-8){for(let i=this.bufferLength;i<et;i++)n.setUint8(i,0);this.hashBuffer(),this.bufferLength=0}for(let i=this.bufferLength;i<et-8;i++)n.setUint8(i,0);n.setUint32(et-8,o>>>0,!0),n.setUint32(et-4,Math.floor(o/4294967296),!0),this.hashBuffer(),this.finished=!0}const e=new DataView(new ArrayBuffer(vd));for(let n=0;n<4;n++)e.setUint32(n*4,this.state[n],!0);return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}hashBuffer(){const{buffer:e,state:n}=this;let s=n[0],r=n[1],o=n[2],i=n[3];s=Ee(s,r,o,i,e.getUint32(0,!0),7,3614090360),i=Ee(i,s,r,o,e.getUint32(4,!0),12,3905402710),o=Ee(o,i,s,r,e.getUint32(8,!0),17,606105819),r=Ee(r,o,i,s,e.getUint32(12,!0),22,3250441966),s=Ee(s,r,o,i,e.getUint32(16,!0),7,4118548399),i=Ee(i,s,r,o,e.getUint32(20,!0),12,1200080426),o=Ee(o,i,s,r,e.getUint32(24,!0),17,2821735955),r=Ee(r,o,i,s,e.getUint32(28,!0),22,4249261313),s=Ee(s,r,o,i,e.getUint32(32,!0),7,1770035416),i=Ee(i,s,r,o,e.getUint32(36,!0),12,2336552879),o=Ee(o,i,s,r,e.getUint32(40,!0),17,4294925233),r=Ee(r,o,i,s,e.getUint32(44,!0),22,2304563134),s=Ee(s,r,o,i,e.getUint32(48,!0),7,1804603682),i=Ee(i,s,r,o,e.getUint32(52,!0),12,4254626195),o=Ee(o,i,s,r,e.getUint32(56,!0),17,2792965006),r=Ee(r,o,i,s,e.getUint32(60,!0),22,1236535329),s=Ce(s,r,o,i,e.getUint32(4,!0),5,4129170786),i=Ce(i,s,r,o,e.getUint32(24,!0),9,3225465664),o=Ce(o,i,s,r,e.getUint32(44,!0),14,643717713),r=Ce(r,o,i,s,e.getUint32(0,!0),20,3921069994),s=Ce(s,r,o,i,e.getUint32(20,!0),5,3593408605),i=Ce(i,s,r,o,e.getUint32(40,!0),9,38016083),o=Ce(o,i,s,r,e.getUint32(60,!0),14,3634488961),r=Ce(r,o,i,s,e.getUint32(16,!0),20,3889429448),s=Ce(s,r,o,i,e.getUint32(36,!0),5,568446438),i=Ce(i,s,r,o,e.getUint32(56,!0),9,3275163606),o=Ce(o,i,s,r,e.getUint32(12,!0),14,4107603335),r=Ce(r,o,i,s,e.getUint32(32,!0),20,1163531501),s=Ce(s,r,o,i,e.getUint32(52,!0),5,2850285829),i=Ce(i,s,r,o,e.getUint32(8,!0),9,4243563512),o=Ce(o,i,s,r,e.getUint32(28,!0),14,1735328473),r=Ce(r,o,i,s,e.getUint32(48,!0),20,2368359562),s=we(s,r,o,i,e.getUint32(20,!0),4,4294588738),i=we(i,s,r,o,e.getUint32(32,!0),11,2272392833),o=we(o,i,s,r,e.getUint32(44,!0),16,1839030562),r=we(r,o,i,s,e.getUint32(56,!0),23,4259657740),s=we(s,r,o,i,e.getUint32(4,!0),4,2763975236),i=we(i,s,r,o,e.getUint32(16,!0),11,1272893353),o=we(o,i,s,r,e.getUint32(28,!0),16,4139469664),r=we(r,o,i,s,e.getUint32(40,!0),23,3200236656),s=we(s,r,o,i,e.getUint32(52,!0),4,681279174),i=we(i,s,r,o,e.getUint32(0,!0),11,3936430074),o=we(o,i,s,r,e.getUint32(12,!0),16,3572445317),r=we(r,o,i,s,e.getUint32(24,!0),23,76029189),s=we(s,r,o,i,e.getUint32(36,!0),4,3654602809),i=we(i,s,r,o,e.getUint32(48,!0),11,3873151461),o=we(o,i,s,r,e.getUint32(60,!0),16,530742520),r=we(r,o,i,s,e.getUint32(8,!0),23,3299628645),s=Se(s,r,o,i,e.getUint32(0,!0),6,4096336452),i=Se(i,s,r,o,e.getUint32(28,!0),10,1126891415),o=Se(o,i,s,r,e.getUint32(56,!0),15,2878612391),r=Se(r,o,i,s,e.getUint32(20,!0),21,4237533241),s=Se(s,r,o,i,e.getUint32(48,!0),6,1700485571),i=Se(i,s,r,o,e.getUint32(12,!0),10,2399980690),o=Se(o,i,s,r,e.getUint32(40,!0),15,4293915773),r=Se(r,o,i,s,e.getUint32(4,!0),21,2240044497),s=Se(s,r,o,i,e.getUint32(32,!0),6,1873313359),i=Se(i,s,r,o,e.getUint32(60,!0),10,4264355552),o=Se(o,i,s,r,e.getUint32(24,!0),15,2734768916),r=Se(r,o,i,s,e.getUint32(52,!0),21,1309151649),s=Se(s,r,o,i,e.getUint32(16,!0),6,4149444226),i=Se(i,s,r,o,e.getUint32(44,!0),10,3174756917),o=Se(o,i,s,r,e.getUint32(8,!0),15,718787259),r=Se(r,o,i,s,e.getUint32(36,!0),21,3951481745),n[0]=s+n[0]&4294967295,n[1]=r+n[1]&4294967295,n[2]=o+n[2]&4294967295,n[3]=i+n[3]&4294967295}reset(){this.state=Uint32Array.from(kd),this.buffer=new DataView(new ArrayBuffer(et)),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}};function En(t,e,n,s,r,o){return e=(e+t&4294967295)+(s+o&4294967295)&4294967295,(e<<r|e>>>32-r)+n&4294967295}function Ee(t,e,n,s,r,o,i){return En(e&n|~e&s,t,e,r,o,i)}function Ce(t,e,n,s,r,o,i){return En(e&s|n&~s,t,e,r,o,i)}function we(t,e,n,s,r,o,i){return En(e^n^s,t,e,r,o,i)}function Se(t,e,n,s,r,o,i){return En(n^(e|~s),t,e,r,o,i)}function Pd(t){return typeof t=="string"?t.length===0:t.byteLength===0}function Bd(t){return typeof t=="string"?Ad(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}const mr="Network Error",Nd="ERR_NETWORK",yr="Request aborted",Id="ERR_ABORTED",Td="canceled",Dd="ERR_CANCELED",xr="x-amz-content-sha256",Ud=()=>t=>async function(n){if(n.headers[xr])return t(n);{const s=await Xo(n.body);return n.headers[xr]=s,t(n)}};class ze extends gu{constructor(e){super(e),this.constructor=ze,Object.setPrototypeOf(this,ze.prototype)}}class Nt extends ze{constructor(e={}){super({name:"CanceledError",message:"Upload is canceled by user",...e}),this.constructor=Nt,Object.setPrototypeOf(this,Nt.prototype)}}const Od=t=>!!t&&t instanceof Nt,nn=new Io("xhr-http-handler"),_d=(t,e)=>{const{url:n,method:s,headers:r,body:o}=t,{onDownloadProgress:i,onUploadProgress:a,responseType:d,abortSignal:c}=e;return new Promise((u,f)=>{let h=new XMLHttpRequest;if(h.open(s.toUpperCase(),n.toString()),Object.entries(r).filter(([y])=>!$d.includes(y)).forEach(([y,S])=>{h.setRequestHeader(y,S)}),h.responseType=d,i&&h.addEventListener("progress",y=>{i(br(y)),nn.debug(y)}),a&&h.upload.addEventListener("progress",y=>{a(br(y)),nn.debug(y)}),h.addEventListener("error",()=>{const y=new ze({message:mr,name:Nd});nn.error(mr),f(y),h=null}),h.addEventListener("abort",()=>{if(!h||c?.aborted)return;const y=Md(yr,Id);nn.error(yr),f(y),h=null}),h.addEventListener("readystatechange",()=>{if(!h||h.readyState!==h.DONE)return;setTimeout(()=>{if(!h)return;const S=Fd(h.getAllResponseHeaders()),{responseType:B}=h,O=h.response,g=B==="text"?h.responseText:"",x={blob:()=>Promise.resolve(O),text:mu(()=>B==="blob"?Ld(O):Promise.resolve(g)),json:()=>Promise.reject(new Error("Parsing response to JSON is not implemented. Please use response.text() instead."))},T={statusCode:h.status,headers:S,body:h.responseType==="blob"?Object.assign(O,x):x};u(T),h=null})}),c){const y=()=>{if(!h)return;const S=new Nt({name:Dd,message:Td});f(S),h.abort(),h=null};c.aborted?y():c.addEventListener("abort",y)}if(typeof ReadableStream=="function"&&o instanceof ReadableStream)throw new Error("ReadableStream request payload is not supported.");h.send(o??null)})},br=t=>({transferredBytes:t.loaded,totalBytes:t.lengthComputable?t.total:void 0}),Md=(t,e)=>{const n=new Error(t);return n.name=e,n},Fd=t=>t?t.split(`\r
`).reduce((e,n)=>{const s=n.split(": "),r=s.shift(),o=s.join(": ");return e[r.toLowerCase()]=o,e},{}):{},Ld=t=>{const e=new FileReader;return new Promise((n,s)=>{e.onloadend=()=>{e.readyState===FileReader.DONE&&n(e.result)},e.onerror=()=>{s(e.error)},e.readAsText(t)})},$d=["host"],yt=yu(_d,[Ud,xu,bu,Eu,Cu,Cd]);var K;(function(t){t.NoCredentials="NoCredentials",t.NoIdentityId="NoIdentityId",t.NoKey="NoKey",t.NoSourceKey="NoSourceKey",t.NoDestinationKey="NoDestinationKey",t.NoSourcePath="NoSourcePath",t.NoDestinationPath="NoDestinationPath",t.NoBucket="NoBucket",t.NoRegion="NoRegion",t.InvalidStorageBucket="InvalidStorageBucket",t.InvalidCopyOperationStorageBucket="InvalidCopyOperationStorageBucket",t.InvalidStorageOperationPrefixInput="InvalidStorageOperationPrefixInput",t.InvalidStorageOperationInput="InvalidStorageOperationInput",t.InvalidAWSAccountID="InvalidAWSAccountID",t.InvalidStoragePathInput="InvalidStoragePathInput",t.InvalidUploadSource="InvalidUploadSource",t.ObjectIsTooLarge="ObjectIsTooLarge",t.UrlExpirationMaxLimitExceed="UrlExpirationMaxLimitExceed",t.InvalidLocationCredentialsCacheSize="InvalidLocationCredentialsCacheSize",t.LocationCredentialsStoreDestroyed="LocationCredentialsStoreDestroyed",t.InvalidS3Uri="InvalidS3Uri",t.InvalidCustomEndpoint="InvalidCustomEndpoint",t.ForcePathStyleEndpointNotSupported="ForcePathStyleEndpointNotSupported",t.DnsIncompatibleBucketName="DnsIncompatibleBucketName"})(K||(K={}));const Jo={[K.NoCredentials]:{message:"Credentials should not be empty."},[K.NoIdentityId]:{message:"Missing identity ID when accessing objects in protected or private access level."},[K.NoKey]:{message:"Missing key in api call."},[K.NoSourceKey]:{message:"Missing source key in copy api call."},[K.NoDestinationKey]:{message:"Missing destination key in copy api call."},[K.NoSourcePath]:{message:"Missing source path in copy api call."},[K.NoDestinationPath]:{message:"Missing destination path in copy api call."},[K.NoBucket]:{message:"Missing bucket name while accessing object."},[K.NoRegion]:{message:"Missing region while accessing object."},[K.UrlExpirationMaxLimitExceed]:{message:"Url Expiration can not be greater than 7 Days."},[K.ObjectIsTooLarge]:{message:"Object size cannot not be greater than 5TB."},[K.InvalidUploadSource]:{message:"Upload source type can only be a `Blob`, `File`, `ArrayBuffer`, or `string`."},[K.InvalidStorageOperationInput]:{message:"Path or key parameter must be specified in the input. Both can not be specified at the same time."},[K.InvalidAWSAccountID]:{message:"Invalid AWS account ID was provided."},[K.InvalidStorageOperationPrefixInput]:{message:"Both path and prefix can not be specified at the same time."},[K.InvalidStoragePathInput]:{message:"Input `path` does not allow a leading slash (/)."},[K.InvalidLocationCredentialsCacheSize]:{message:"locationCredentialsCacheSize must be a positive integer."},[K.LocationCredentialsStoreDestroyed]:{message:"Location-specific credentials store has been destroyed."},[K.InvalidS3Uri]:{message:"Invalid S3 URI."},[K.InvalidStorageBucket]:{message:"Unable to lookup bucket from provided name in Amplify configuration."},[K.InvalidCopyOperationStorageBucket]:{message:"Missing bucket option in either source or destination."},[K.InvalidCustomEndpoint]:{message:"Invalid S3 custom endpoint."},[K.ForcePathStyleEndpointNotSupported]:{message:"Path style URLs are not supported with S3 Transfer Acceleration."},[K.DnsIncompatibleBucketName]:{message:"The bucket name isn't DNS compatible."}};function Te(t,e){const{message:n,recoverySuggestion:s}=Jo[e];if(!t)throw new ze({name:e,message:n,recoverySuggestion:s})}const Qo="http://localhost:20005",Yo="guest",ea=1024*1024,Hd=1024*ea,zd=1024*Hd,Es=5*ea,jd=5*zd,Kd=1e4,Wd=4,Cn="__uploadInProgress",qt="key",qd="path",ta="crc-32",Je=new Io("Storage"),Vd=({job:t,onCancel:e})=>{const n="IN_PROGRESS";let s;const r={cancel:i=>{const{state:a}=r;if(a==="CANCELED"||a==="ERROR"||a==="SUCCESS"){Je.debug(`This task cannot be canceled. State: ${a}`);return}r.state="CANCELED",s=i,e(s)},state:n},o=(async()=>{try{const i=await t();return r.state="SUCCESS",i}catch(i){throw Od(i)&&(r.state="CANCELED",i.message=s??i.message),r.state="ERROR",i}})();return Object.assign(r,{result:o})},Er=({job:t,onCancel:e,onResume:n,onPause:s,isMultipartUpload:r})=>{const o=Vd({job:t,onCancel:e}),i=Object.assign(o,{pause:()=>{const{state:a}=i;if(!r||a!=="IN_PROGRESS"){Je.debug(`This task cannot be paused. State: ${a}`);return}i.state="PAUSED",s?.()},resume:()=>{const{state:a}=i;if(!r||a!=="PAUSED"){Je.debug(`This task cannot be resumed. State: ${a}`);return}i.state="IN_PROGRESS",n?.()}});return i},Gd=t=>{if(t==null)return 0;if(typeof t=="string")return new Blob([t]).size;if(typeof t.byteLength=="number")return t.byteLength;if(typeof t.size=="number")return t.size};function Cr(t){const e=Array.from(t,n=>String.fromCodePoint(n)).join("");return btoa(e)}function na(t){return Cr(typeof t=="string"?new TextEncoder().encode(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}const sa=t=>new Promise((e,n)=>{const s=new FileReader;s.onload=()=>{e(s.result)},s.onabort=()=>{n(new Error("Read aborted"))},s.onerror=()=>{n(s.error)},s.readAsArrayBuffer(t)}),ra=async t=>{const e=new Rd,n=t instanceof Blob?await sa(t):t;e.update(n);const s=await e.digest();return na(s)},Xd=({accessLevel:t,targetIdentityId:e})=>t==="private"?(Te(!!e,K.NoIdentityId),`private/${e}/`):t==="protected"?(Te(!!e,K.NoIdentityId),`protected/${e}/`):"public/",Zd="InvalidStorageInput",ia=async(t,e)=>{const{options:n}=e??{},{identityId:s}=await t.Auth.fetchAuthSession(),r=async g=>{wr(n)&&Yd(e);const{credentials:x}=wr(n)?await n.locationCredentialsProvider(g):await t.Auth.fetchAuthSession();return Te(!!x,K.NoCredentials),x},{bucket:o,region:i,dangerouslyConnectToHttpEndpointForTesting:a,buckets:d}=t.getConfig()?.Storage?.S3??{},{bucket:c=o,region:u=i}=n?.bucket&&sl(n,d)||{};Te(!!c,K.NoBucket),Te(!!u,K.NoRegion);const{defaultAccessLevel:f,prefixResolver:h=Xd,isObjectLockEnabled:y}=t.libraryOptions?.Storage?.S3??{},S=n?.accessLevel??f??Yo,B=S==="protected"?n?.targetIdentityId??s:s,O=await h({accessLevel:S,targetIdentityId:B});return{s3Config:{credentials:r,region:u,useAccelerateEndpoint:n?.useAccelerateEndpoint,...n?.customEndpoint?{customEndpoint:n.customEndpoint}:{},...a?{customEndpoint:Qo,forcePathStyle:!0}:{}},bucket:c,keyPrefix:O,identityId:s,isObjectLockEnabled:y}},wr=t=>!!t?.locationCredentialsProvider,Jd=t=>t?.path&&typeof t.path=="function"||t?.destination?.path&&typeof t.destination?.path=="function"||t?.source?.path&&typeof t.source?.path=="function",Qd=t=>el(t)||tl(t)||nl(t),Yd=t=>{if(Qd(t)||Jd(t))throw new ze({name:Zd,message:"The input needs to have a path as a string value.",recoverySuggestion:"Please provide a valid path as a string value for the input."})},el=t=>typeof t.key=="string",tl=t=>typeof t.prefix=="string",nl=t=>typeof t.source?.key=="string"||typeof t.destination?.key=="string",sl=(t,e)=>{if(typeof t.bucket=="string"){const n=e?.[t.bucket];return Te(!!n,K.InvalidStorageBucket),{bucket:n.bucketName,region:n.region}}if(typeof t.bucket=="object")return{bucket:t.bucket.bucketName,region:t.bucket.region}},rl=/^\d{12}/,il=t=>{t!==void 0&&Te(rl.test(t),K.InvalidAWSAccountID)},ol=t=>t.path!==void 0,al=t=>(Te(!!t,K.NoIdentityId),t),oa=(t,e)=>{if(Te(!!t.key&&!t.path||!t.key&&!!t.path,K.InvalidStorageOperationInput),ol(t)){const{path:n}=t,s=typeof n=="string"?n:n({identityId:al(e)});return Te(!s.startsWith("/"),K.InvalidStoragePathInput),{inputType:qd,objectKey:s}}else return{inputType:qt,objectKey:t.key}},aa={parse:t=>{const n=new DOMParser().parseFromString(t,"text/xml"),s=Cs(n),r=Object.keys(s)[0];return s[r]}},Cs=t=>{if(ul(t))return{[t.documentElement.nodeName]:Cs(t.documentElement)};if(t.nodeType===Node.TEXT_NODE)return t.nodeValue?.trim();if(cl(t)){if(dl(t))return t.childNodes[0].nodeValue;const e={};for(const n of t.attributes)ca(n.nodeName)||(e[n.nodeName]=n.nodeValue);if(t.children.length>0)for(const n of t.children){const s=Cs(n);if(s===void 0)continue;const r=n.nodeName;e[r]===void 0?e[r]=s:Array.isArray(e[r])?e[r].push(s):e[r]=[e[r],s]}return Object.keys(e).length===0?"":e}},cl=t=>t.nodeType===Node.ELEMENT_NODE,ul=t=>t.nodeType===Node.DOCUMENT_NODE,dl=t=>ll(t)&&t.children.length===0&&t.firstChild?.nodeType===Node.TEXT_NODE,ll=t=>{for(const e of t.attributes)if(!ca(e.nodeName))return!1;return!0},ca=t=>t==="xmlns"||t.startsWith("xmlns:"),hl=({noErrorWrapping:t=!1}={})=>async e=>{if(!e||e.statusCode<300)return;const{statusCode:n}=e,s=await Jt(e),r=t?s:s.Error,o=r?.Code?r.Code:n===404?"NotFound":n.toString(),i=r?.message??r?.Message??o,a=new Error(i);return Object.assign(a,{name:o,$metadata:ot(e)})},Jt=async t=>{if(!t.body)throw new Error("S3 aborted request.");const e=await t.body.text();if(e?.length>0)try{return aa.parse(e)}catch(n){throw new Error(`Failed to parse XML response: ${n}`)}return{}},fl=t=>async(e,n,s)=>{const o=await wu(t)(e,n);if(!e)return{retryable:o.retryable};const i=await t(e),a=i?.name,d=i?.message,c=gl(a,d);return{retryable:o.retryable||!!(c&&!s?.isCredentialsExpired),isCredentialsExpiredError:c}},pl=["RequestExpired","ExpiredTokenException","ExpiredToken"],gl=(t,e)=>{const n=!!t&&pl.includes(t),s=!!t&&!!e&&t.includes("Signature")&&e.includes("expired");return n||s},ml=/^[a-z0-9][a-z0-9.-]{1,61}[a-z0-9]$/,yl=/(\d+\.){3}\d+/,xl=/\.\./,bl="s3",El=(t,e)=>{const{region:n,useAccelerateEndpoint:s,customEndpoint:r,forcePathStyle:o}=t;let i;return r?(r===Qo&&(i=new We(r)),Te(!r.includes("://"),K.InvalidCustomEndpoint),i=new We(`https://${r}`)):s?(Te(!o,K.ForcePathStyleEndpointNotSupported),i=new We(`https://s3-accelerate.${hr(n)}`)):i=new We(`https://s3.${n}.${hr(n)}`),e?.Bucket&&(Te(Cl(e.Bucket),K.DnsIncompatibleBucketName),o||e.Bucket.includes(".")?i.pathname=`/${e.Bucket}`:i.host=`${e.Bucket}.${i.host}`),{url:i}},Cl=t=>ml.test(t)&&!yl.test(t)&&!xl.test(t),Ye=hl({noErrorWrapping:!0}),ua=fl(Ye),xt={service:bl,endpointResolver:El,retryDecider:ua,computeDelay:Su,userAgentValue:To(),useAccelerateEndpoint:!1,uriEscapePath:!1},at=(t,e)=>{const n={};for(const[s,r]of Object.entries(e)){const[o,i]=Array.isArray(r)?r:[r];Object.prototype.hasOwnProperty.call(t,o)&&(n[s]=i?i(t[o]):String(t[o]))}return n},da=t=>t?Number(t):void 0,wl=t=>t?new Date(t):void 0,la=(t,e)=>{if(t==="")return[];const n=(Array.isArray(t)?t:[t]).filter(s=>s!=null);return e(n)},Sl=t=>{const e="x-amz-meta-",n=Object.keys(t).filter(s=>s.startsWith(e)).reduce((s,r)=>(s[r.replace(e,"")]=t[r],s),{});return Object.keys(n).length>0?n:void 0},ct=t=>new ze({name:t.name,message:t.message,metadata:t.$metadata}),ha=t=>t.map(e=>at(e,{PartNumber:["PartNumber",da],ETag:"ETag",ChecksumCRC32:"ChecksumCRC32"})),bt=t=>{const e={};for(const[n,s]of Object.entries(t))s!=null&&(e[n]=s.toString());return e},fa=async t=>({...bt({"x-amz-acl":t.ACL,"cache-control":t.CacheControl,"content-disposition":t.ContentDisposition,"content-language":t.ContentLanguage,"content-encoding":t.ContentEncoding,"content-type":t.ContentType,expires:t.Expires?.toUTCString(),"x-amz-tagging":t.Tagging,...Al(t.Metadata)})}),Al=(t={})=>Object.keys(t).reduce((e,n)=>(e[`x-amz-meta-${n.toLowerCase()}`]=t[n],e),{}),Et=(t,e)=>t.pathname.replace(/\/$/,"")+`/${e.split("/").map(bs).join("/")}`;function Fe(t,e){if(!t)throw new ze({name:Do.Unknown,message:"An unknown error has occurred.",underlyingError:new TypeError(`Expected a non-null value for S3 parameter ${e}`),recoverySuggestion:"This is likely to be a bug. Please reach out to library authors."})}class rt extends ze{constructor(e){super({name:Do.Unknown,message:"An unknown error has occurred.",recoverySuggestion:"This may be a bug. Please reach out to library authors.",metadata:e?.metadata}),this.constructor=rt,Object.setPrototypeOf(this,rt.prototype)}}function Ut({bucketName:t,key:e,objectURL:n}){if(!t||!e||!n)throw new rt;const s=t.includes("."),r=bs(t),o=e.split("/").map(bs).join("/"),i=n.pathname===`/${r}/${o}`,a=n.hostname.startsWith(`${r}.`)&&n.pathname===`/${o}`;if(!(i||!s&&a))throw new rt}const vl=async(t,e)=>{const n={...await fa({...t,ContentType:t.ContentType??"application/octet-stream"}),...bt({"content-md5":t.ContentMD5,"x-amz-checksum-crc32":t.ChecksumCRC32,"x-amz-expected-bucket-owner":t.ExpectedBucketOwner,"If-None-Match":t.IfNoneMatch})},s=new We(e.url.toString());return Fe(!!t.Key,"Key"),s.pathname=Et(s,t.Key),s.search=new Zt({"x-id":"PutObject"}).toString(),Ut({bucketName:t.Bucket,key:t.Key,objectURL:s}),{method:"PUT",headers:n,url:s,body:t.Body}},kl=async t=>{if(t.statusCode>=300)throw ct(await Ye(t));return{...at(t.headers,{ETag:"etag",VersionId:"x-amz-version-id"}),$metadata:ot(t)}},Rl=mt(yt,vl,kl,{...xt,responseType:"text"}),Pl=async(t,e)=>{const n={...await fa(t),...bt({"x-amz-checksum-algorithm":t.ChecksumAlgorithm,"x-amz-expected-bucket-owner":t.ExpectedBucketOwner})},s=new We(e.url.toString());return Fe(!!t.Key,"Key"),s.pathname=Et(s,t.Key),s.search="uploads",Ut({bucketName:t.Bucket,key:t.Key,objectURL:s}),{method:"POST",headers:n,url:s}},Bl=async t=>{if(t.statusCode>=300)throw ct(await Ye(t));{const e=await Jt(t),n=at(e,{UploadId:"UploadId"});return{$metadata:ot(t),...n}}},Nl=mt(yt,Pl,Bl,{...xt,responseType:"text"}),Il=async(t,e)=>{const n={...bt({"x-amz-checksum-crc32":t.ChecksumCRC32,"content-md5":t.ContentMD5,"x-amz-expected-bucket-owner":t.ExpectedBucketOwner}),"content-type":"application/octet-stream"},s=new We(e.url.toString());return Fe(!!t.Key,"Key"),s.pathname=Et(s,t.Key),Fe(!!t.PartNumber,"PartNumber"),Fe(!!t.UploadId,"UploadId"),s.search=new Zt({partNumber:t.PartNumber+"",uploadId:t.UploadId}).toString(),Ut({bucketName:t.Bucket,key:t.Key,objectURL:s}),{method:"PUT",headers:n,url:s,body:t.Body}},Tl=async t=>{if(t.statusCode>=300)throw ct(await Ye(t));return{...at(t.headers,{ETag:"etag"}),$metadata:ot(t)}},Dl=mt(yt,Il,Tl,{...xt,responseType:"text"}),Sr=t=>t!=null&&typeof t=="object"&&!Array.isArray(t),ws=(t,e)=>{if(Array.isArray(t)&&!Array.isArray(e)||!Array.isArray(t)&&Array.isArray(e))return!1;if(Array.isArray(t)&&Array.isArray(e))return t.length===e.length&&t.every((r,o)=>ws(r,e[o]));if(!Sr(t)||!Sr(e))return t===e;const n=Object.keys(t),s=Object.keys(e);return n.length!==s.length?!1:n.every(r=>s.includes(r)&&ws(t[r],e[r]))};function Ul(t,e){if(!t.Parts)throw new rt;const n=aa.parse(e),s=at(n,{Parts:["Part",r=>la(r,ha)]});if(!ws(t,s))throw new rt}const pa="Invalid parameter for CompleteMultipartUpload API",Ol="ETag missing from multipart upload",_l="Please ensure S3 bucket CORS configuration includes ETag as part of its `ExposeHeaders` element",Ml=async(t,e)=>{const n={"content-type":"application/xml",...bt({"x-amz-checksum-crc32":t.ChecksumCRC32,"x-amz-expected-bucket-owner":t.ExpectedBucketOwner,"If-None-Match":t.IfNoneMatch})},s=new We(e.url.toString());Fe(!!t.Key,"Key"),s.pathname=Et(s,t.Key),Fe(!!t.UploadId,"UploadId"),s.search=new Zt({uploadId:t.UploadId}).toString(),Fe(!!t.MultipartUpload,"MultipartUpload"),Ut({bucketName:t.Bucket,key:t.Key,objectURL:s});const r=Fl(t.MultipartUpload);return Ul(t.MultipartUpload,r),{method:"POST",headers:n,url:s,body:'<?xml version="1.0" encoding="UTF-8"?>'+r}},Fl=t=>{if(!t.Parts?.length)throw new Error(`${pa}: ${JSON.stringify(t)}`);return`<CompleteMultipartUpload xmlns="http://s3.amazonaws.com/doc/2006-03-01/">${t.Parts.map(Ll).join("")}</CompleteMultipartUpload>`},Ll=t=>{if(t.PartNumber==null)throw new Error(`${pa}: ${JSON.stringify(t)}`);if(!t.ETag)throw new Error(`${Ol}: ${JSON.stringify(t)}. ${_l}`);const e=`<ETag>${t.ETag}</ETag>`,n=`<PartNumber>${t.PartNumber}</PartNumber>`,s=t.ChecksumCRC32?`<ChecksumCRC32>${t.ChecksumCRC32}</ChecksumCRC32>`:"";return`<Part>${e}${n}${s}</Part>`},$l=async t=>{const e=await Jt(t);if(e.Code!==void 0&&e.Message!==void 0){const n=await Ye({...t,statusCode:500});throw n.$metadata.httpStatusCode=t.statusCode,ct(n)}return e},Hl=async t=>{if(t.statusCode>=300)throw ct(await Ye(t));{const e=await $l(t),n=at(e,{ETag:"ETag",Key:"Key",Location:"Location"});return{$metadata:ot(t),...n}}},zl=async(t,e,n)=>{if(!t)return{retryable:!1};if(t.statusCode===200){if(!t.body)return{retryable:!0};const s=await Jt(t);return s.Code!==void 0&&s.Message!==void 0?{retryable:!0}:{retryable:!1}}return ua(t,e,n)},jl=mt(yt,Ml,Hl,{...xt,responseType:"text",retryDecider:zl}),Kl=async(t,e)=>{const n={},s=new We(e.url.toString());return Fe(!!t.Key,"Key"),s.pathname=Et(s,t.Key),Fe(!!t.UploadId,"UploadId"),s.search=new Zt({"x-id":"ListParts",uploadId:t.UploadId}).toString(),{method:"GET",headers:n,url:s}},Wl=async t=>{if(t.statusCode>=300)throw ct(await Ye(t));{const e=await Jt(t),n=at(e,{UploadId:"UploadId",Parts:["Part",s=>la(s,ha)]});return{$metadata:ot(t),...n}}},ql=mt(yt,Kl,Wl,{...xt,responseType:"text"}),Vl=(t,e)=>{const n=new We(e.url.toString());return Fe(!!t.Key,"Key"),n.pathname=Et(n,t.Key),Fe(!!t.UploadId,"UploadId"),n.search=new Zt({"x-id":"AbortMultipartUpload",uploadId:t.UploadId}).toString(),Ut({bucketName:t.Bucket,key:t.Key,objectURL:n}),{method:"DELETE",headers:{...bt({"x-amz-expected-bucket-owner":t.ExpectedBucketOwner})},url:n}},Gl=async t=>{if(t.statusCode>=300)throw ct(await Ye(t));return{$metadata:ot(t)}},Xl=mt(yt,Vl,Gl,{...xt,responseType:"text"}),Zl=async(t,e)=>{const n=new We(e.url.toString());return Fe(!!t.Key,"Key"),n.pathname=Et(n,t.Key),Ut({bucketName:t.Bucket,key:t.Key,objectURL:n}),{method:"HEAD",headers:bt({"x-amz-expected-bucket-owner":t.ExpectedBucketOwner}),url:n}},Jl=async t=>{if(t.statusCode>=300)throw ct(await Ye(t));{const e={...at(t.headers,{ContentLength:["content-length",da],ContentType:"content-type",ETag:"etag",LastModified:["last-modified",wl],VersionId:"x-amz-version-id"}),Metadata:Sl(t.headers)};return{$metadata:ot(t),...e}}},Ql=mt(yt,Zl,Jl,{...xt,responseType:"text"});function ga(t){return To({category:Au.Storage,action:t})}var vn={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */var Ar;function Yl(){return Ar||(Ar=1,function(t){(function(e){e(typeof DO_NOT_EXPORT_CRC>"u"?t:{})})(function(e){e.version="1.2.2";function n(){for(var E=0,v=new Array(256),N=0;N!=256;++N)E=N,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,v[N]=E;return typeof Int32Array<"u"?new Int32Array(v):v}var s=n();function r(E){var v=0,N=0,D=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(D=0;D!=256;++D)A[D]=E[D];for(D=0;D!=256;++D)for(N=E[D],v=256+D;v<4096;v+=256)N=A[v]=N>>>8^E[N&255];var H=[];for(D=1;D!=16;++D)H[D-1]=typeof Int32Array<"u"?A.subarray(D*256,D*256+256):A.slice(D*256,D*256+256);return H}var o=r(s),i=o[0],a=o[1],d=o[2],c=o[3],u=o[4],f=o[5],h=o[6],y=o[7],S=o[8],B=o[9],O=o[10],g=o[11],x=o[12],T=o[13],b=o[14];function P(E,v){for(var N=v^-1,D=0,A=E.length;D<A;)N=N>>>8^s[(N^E.charCodeAt(D++))&255];return~N}function m(E,v){for(var N=v^-1,D=E.length-15,A=0;A<D;)N=b[E[A++]^N&255]^T[E[A++]^N>>8&255]^x[E[A++]^N>>16&255]^g[E[A++]^N>>>24]^O[E[A++]]^B[E[A++]]^S[E[A++]]^y[E[A++]]^h[E[A++]]^f[E[A++]]^u[E[A++]]^c[E[A++]]^d[E[A++]]^a[E[A++]]^i[E[A++]]^s[E[A++]];for(D+=15;A<D;)N=N>>>8^s[(N^E[A++])&255];return~N}function U(E,v){for(var N=v^-1,D=0,A=E.length,H=0,q=0;D<A;)H=E.charCodeAt(D++),H<128?N=N>>>8^s[(N^H)&255]:H<2048?(N=N>>>8^s[(N^(192|H>>6&31))&255],N=N>>>8^s[(N^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,q=E.charCodeAt(D++)&1023,N=N>>>8^s[(N^(240|H>>8&7))&255],N=N>>>8^s[(N^(128|H>>2&63))&255],N=N>>>8^s[(N^(128|q>>6&15|(H&3)<<4))&255],N=N>>>8^s[(N^(128|q&63))&255]):(N=N>>>8^s[(N^(224|H>>12&15))&255],N=N>>>8^s[(N^(128|H>>6&63))&255],N=N>>>8^s[(N^(128|H&63))&255]);return~N}e.table=s,e.bstr=P,e.buf=m,e.str=U})}(vn)),vn}var eh=Yl();const vr=Uo(eh),ma=t=>new Uint8Array((t.match(/\w{2}/g)??[]).map(e=>parseInt(e,16))),th=t=>ma(t).buffer,nh=t=>na(ma(t)),kr=1024*1024,Vt=async(t,e=0)=>{let n=e;if(t instanceof ArrayBuffer||ArrayBuffer.isView(t)){let r;t instanceof ArrayBuffer?r=new Uint8Array(t):r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);let o=0;for(;o<r.length;){const i=Math.min(o+kr,r.length),a=r.slice(o,i);n=vr.buf(a,n)>>>0,o=i}}else{let r;t instanceof Blob?r=t:r=new Blob([t]);let o=0;for(;o<r.size;){const i=Math.min(o+kr,r.size),a=r.slice(o,i),d=await sa(a),c=new Uint8Array(d);n=vr.buf(c,n)>>>0,o=i}}const s=n.toString(16).padStart(8,"0");return{checksumArrayBuffer:th(s),checksum:nh(s),seed:n}},ya=t=>{if(!t)return;if(typeof t=="string")return t;const{type:e,filename:n}=t;return n!==void 0?`${e}; filename="${n}"`:e},sh=(t,e,n)=>async()=>{const{options:s,data:r}=t,{bucket:o,keyPrefix:i,s3Config:a,isObjectLockEnabled:d,identityId:c}=await ia(Ts,t),{inputType:u,objectKey:f}=oa(t,c);il(s?.expectedBucketOwner);const h=u===qt?i+f:f,{contentDisposition:y,contentEncoding:S,contentType:B="application/octet-stream",preventOverwrite:O,metadata:g,checksumAlgorithm:x,onProgress:T,expectedBucketOwner:b}=s??{},P=x===ta?await Vt(r):void 0,m=!P&&d?await ra(r):void 0,{ETag:U,VersionId:E}=await Rl({...a,abortSignal:e,onUploadProgress:T,userAgentValue:ga(Oo.UploadData)},{Bucket:o,Key:h,Body:r,ContentType:B,ContentDisposition:ya(y),ContentEncoding:S,Metadata:g,ContentMD5:m,ChecksumCRC32:P?.checksum,ExpectedBucketOwner:b,IfNoneMatch:O?"*":void 0}),v={eTag:U,versionId:E,contentType:B,metadata:g,size:n};return u===qt?{key:f,...v}:{path:f,...v}},rh=async({dataChunkerGenerator:t,completedPartNumberSet:e,s3Config:n,abortSignal:s,bucket:r,finalKey:o,uploadId:i,onPartUploadCompletion:a,onProgress:d,isObjectLockEnabled:c,useCRC32Checksum:u,expectedBucketOwner:f})=>{let h=0;for(const{data:y,partNumber:S,size:B}of t){if(s.aborted){Je.debug("upload executor aborted.");break}if(e.has(S))Je.debug(`part ${S} already uploaded.`),h+=B,d?.({transferredBytes:h});else{let O;u&&(O=await Vt(y));const g=!O&&c?await ra(y):void 0,{ETag:x}=await Dl({...n,abortSignal:s,onUploadProgress:T=>{const{transferredBytes:b}=T;d?.({transferredBytes:h+b})}},{Bucket:r,Key:o,UploadId:i,Body:y,PartNumber:S,ChecksumCRC32:O?.checksum,ContentMD5:g,ExpectedBucketOwner:f});h+=B,a(S,x,O?.checksum)}}},ih=1e3*60*60,oh=async({resumableUploadsCache:t,cacheKey:e,s3Config:n,bucket:s,finalKey:r})=>{const o=await Os(t);if(!o[e]||o[e].lastTouched<Date.now()-ih)return null;const i=o[e];i.lastTouched=Date.now(),await t.setItem(Cn,JSON.stringify(o));try{const{Parts:a=[]}=await ql(n,{Bucket:s,Key:r,UploadId:i.uploadId});return{parts:a,uploadId:i.uploadId,finalCrc32:i.finalCrc32}}catch{return Je.debug("failed to list cached parts, removing cached upload."),await As(t,e),null}},Os=async t=>{try{return JSON.parse(await t.getItem(Cn)??"{}")}catch{return Je.debug("failed to parse cached uploads record."),{}}},ah=(t={})=>{const e=["onProgress","resumableUploadsCache","locationCredentialsProvider"],n=Object.fromEntries(Object.entries(t).filter(([s])=>!e.includes(s)));return JSON.stringify(n)},Ss=({file:t,size:e,contentType:n,bucket:s,accessLevel:r,key:o,optionsHash:i})=>{let a;const d=n??t?.type??"application/octet-stream";r===void 0?a="custom":a=r==="guest"?"public":r;const c=`${i}_${e}_${d}_${s}_${a}_${o}`;return t?`${t.name}_${t.lastModified}_${c}`:c},ch=async(t,e,n)=>{const s=await Os(t);s[e]={...n,lastTouched:Date.now()},await t.setItem(Cn,JSON.stringify(s))},As=async(t,e)=>{const n=await Os(t);delete n[e],await t.setItem(Cn,JSON.stringify(n))},uh=({size:t,onProgress:e})=>{const n=[],s=()=>n.reduce((r,o)=>r+o,0);return{getOnProgressListener:()=>{n.push(0);const r=n.length-1;return o=>{const{transferredBytes:i}=o;n[r]=i,e?.({transferredBytes:s(),totalBytes:t})}}}},xa=t=>{if(!t)return Es;let e=Es,n=Math.ceil(t/e);for(;n>Kd;)e*=2,n=Math.ceil(t/e);return e},_s=(t,e)=>{const n=xa(e);if(t instanceof Blob)return kn(t,0,t.size,n);if(ArrayBuffer.isView(t))return kn(t.buffer,t.byteOffset,t.byteLength,n);if(t instanceof ArrayBuffer)return kn(t,0,t.byteLength,n);if(typeof t=="string"){const s=new Blob([t]);return _s(s,s.size)}else throw new ze({name:K.InvalidUploadSource,...Jo[K.InvalidUploadSource]})},kn=function*(t,e,n,s){let r=1,o=e,i=e+Math.min(s,n);for(;i<n+e;)yield{partNumber:r,data:t.slice(o,i),size:s},r+=1,o=i,i=o+s;yield{partNumber:r,data:t.slice(o,n+e),size:n+e-o}},dh=async(t,e)=>{const n=[],s=_s(t,e);let r=0;for(const{data:a}of s){const d=new Uint8Array((await Vt(a)).checksumArrayBuffer);r+=d.length,n.push(d)}const o=new Uint8Array(r);let i=0;for(const a of n)o.set(a,i),i+=a.length;return`${(await Vt(o.buffer)).checksum}-${n.length}`},lh=async({s3Config:t,data:e,size:n,contentType:s,bucket:r,accessLevel:o,keyPrefix:i,key:a,contentDisposition:d,contentEncoding:c,metadata:u,abortSignal:f,checksumAlgorithm:h,optionsHash:y,resumableUploadsCache:S,expectedBucketOwner:B})=>{const O=i!==void 0?i+a:a;let g;if(!S)Je.debug("uploaded cache instance cannot be determined, skipping cache."),g=void 0;else{const x=Ss({size:n,contentType:s,file:e instanceof File?e:void 0,bucket:r,accessLevel:o,key:a,optionsHash:y}),T=await oh({s3Config:t,cacheKey:x,bucket:r,finalKey:O,resumableUploadsCache:S});g=T?{...T,uploadCacheKey:x}:void 0}if(g)return{uploadId:g.uploadId,cachedParts:g.parts,finalCrc32:g.finalCrc32};{const x=h===ta?await dh(e,n):void 0,{UploadId:T}=await Nl({...t,abortSignal:f},{Bucket:r,Key:O,ContentType:s,ContentDisposition:ya(d),ContentEncoding:c,Metadata:u,ChecksumAlgorithm:x?"CRC32":void 0,ExpectedBucketOwner:B});if(S){const b=Ss({size:n,contentType:s,file:e instanceof File?e:void 0,bucket:r,accessLevel:o,key:a,optionsHash:y});await ch(S,b,{uploadId:T,bucket:r,key:a,finalCrc32:x,fileName:e instanceof File?e.name:""})}return{uploadId:T,cachedParts:[],finalCrc32:x}}},hh=(t,e)=>{let n,s,r,o,i,a,d,c,u,f,h,y,S=!1;const{resumableUploadsCache:B}=t.options??{},O=async()=>{const{options:m,data:U}=t,E=await ia(Ts,t);i=new AbortController,S=!1,o=E.s3Config,d=E.bucket,u=E.identityId,y=m?.expectedBucketOwner;const{inputType:v,objectKey:N}=oa(t,u),{contentDisposition:D,contentEncoding:A,contentType:H="application/octet-stream",metadata:q,preventOverwrite:ye,onProgress:wt}=m??{};if(h=N,v===qt){const Ue=m?.accessLevel;c=E.keyPrefix,h=c+N,a=fh(Ue)}const{checksum:Qe}=await Vt(ah(m));if(!r){const{uploadId:Ue,cachedParts:Ot,finalCrc32:en}=await lh({s3Config:o,accessLevel:a,bucket:d,keyPrefix:c,key:N,contentType:H,contentDisposition:D,contentEncoding:A,metadata:q,data:U,size:e,abortSignal:i.signal,checksumAlgorithm:m?.checksumAlgorithm,optionsHash:Qe,resumableUploadsCache:B,expectedBucketOwner:y});r={uploadId:Ue,completedParts:Ot,finalCrc32:en}}f=e?Ss({file:U instanceof File?U:void 0,accessLevel:a,contentType:m?.contentType,bucket:d,size:e,key:N,optionsHash:Qe}):void 0;const xe=_s(U,e),ut=new Set(r.completedParts.map(({PartNumber:Ue})=>Ue)),le=(Ue,Ot,en)=>{r?.completedParts.push({PartNumber:Ue,ETag:Ot,...en?{ChecksumCRC32:en}:{}})},je=uh({size:e,onProgress:wt}),Yt=[];for(let Ue=0;Ue<Wd;Ue++)Yt.push(rh({dataChunkerGenerator:xe,completedPartNumberSet:ut,s3Config:o,abortSignal:i.signal,bucket:d,finalKey:h,uploadId:r.uploadId,onPartUploadCompletion:le,onProgress:je.getOnProgressListener(),isObjectLockEnabled:E.isObjectLockEnabled,useCRC32Checksum:!!r.finalCrc32,expectedBucketOwner:y}));await Promise.all(Yt),ph(r.completedParts,e);const{ETag:ac}=await jl({...o,abortSignal:i.signal,userAgentValue:ga(Oo.UploadData)},{Bucket:d,Key:h,UploadId:r.uploadId,ChecksumCRC32:r.finalCrc32,IfNoneMatch:ye?"*":void 0,MultipartUpload:{Parts:ba(r.completedParts)},ExpectedBucketOwner:y});if(e){const{ContentLength:Ue,$metadata:Ot}=await Ql(o,{Bucket:d,Key:h,ExpectedBucketOwner:y});if(Ue&&Ue!==e)throw new ze({name:"Error",message:`Upload failed. Expected object size ${e}, but got ${Ue}.`,metadata:Ot})}B&&f&&await As(B,f);const lr={eTag:ac,contentType:H,metadata:q};return v===qt?{key:N,...lr}:{path:N,...lr}},g=()=>O().then(n).catch(m=>{i?.signal?.aborted&&S?Je.debug("upload paused."):s(m)});return{multipartUploadJob:()=>new Promise((m,U)=>{n=m,s=U,g()}),onPause:()=>{S=!0,i?.abort()},onResume:()=>{g()},onCancel:m=>{i?.abort(m),(async()=>{f&&B&&await As(B,f),await Xl(o,{Bucket:d,Key:h,UploadId:r?.uploadId,ExpectedBucketOwner:y})})().catch(E=>{Je.debug("error when cancelling upload task.",E)}),s(new Nt(m?{message:m}:void 0))}}},fh=t=>t??Ts.libraryOptions.Storage?.S3?.defaultAccessLevel??Yo,ph=(t,e)=>{const n=Math.ceil(e/xa(e)),s=t.length===n,o=ba(t).every((i,a)=>i.PartNumber===a+1);if(!s||!o)throw new rt},ba=t=>[...t].sort((e,n)=>e.PartNumber-n.PartNumber),gh=t=>{const{data:e}=t,n=Gd(e);if(Te(n!==void 0,K.InvalidUploadSource),Te(n<=jd,K.ObjectIsTooLarge),n<=Es){const s=new AbortController;return Er({isMultipartUpload:!1,job:sh(t,s.signal,n),onCancel:r=>{s.abort(r)}})}else{const{multipartUploadJob:s,onPause:r,onResume:o,onCancel:i}=hh(t,n);return Er({isMultipartUpload:!0,job:s,onCancel:a=>{i(a)},onPause:r,onResume:o})}};function mh(t){return gh({...t,options:{...t?.options,resumableUploadsCache:vu}})}const yh=typeof ReadableStream=="function"?ReadableStream:function(){};class xh extends yh{}const bh=({expectedChecksum:t,checksum:e,source:n,checksumSourceLocation:s,base64Encoder:r})=>{if(!Vu(n))throw new Error(`@smithy/util-stream: unsupported source type ${n?.constructor?.name??n} in ChecksumStream.`);const o=r??Ao;if(typeof TransformStream!="function")throw new Error("@smithy/util-stream: unable to instantiate ChecksumStream because API unavailable: ReadableStream/TransformStream.");const i=new TransformStream({start(){},async transform(d,c){e.update(d),c.enqueue(d)},async flush(d){const c=await e.digest(),u=o(c);if(t!==u){const f=new Error(`Checksum mismatch: expected "${t}" but received "${u}" in response header "${s}".`);d.error(f)}else d.terminate()}});n.pipeThrough(i);const a=i.readable;return Object.setPrototypeOf(a,xh.prototype),a};class Eh{constructor(e){this.allocByteArray=e,this.byteLength=0,this.byteArrays=[]}push(e){this.byteArrays.push(e),this.byteLength+=e.byteLength}flush(){if(this.byteArrays.length===1){const s=this.byteArrays[0];return this.reset(),s}const e=this.allocByteArray(this.byteLength);let n=0;for(let s=0;s<this.byteArrays.length;++s){const r=this.byteArrays[s];e.set(r,n),n+=r.byteLength}return this.reset(),e}reset(){this.byteArrays=[],this.byteLength=0}}function Ch(t,e,n){const s=t.getReader();let r=!1,o=0;const i=["",new Eh(c=>new Uint8Array(c))];let a=-1;const d=async c=>{const{value:u,done:f}=await s.read(),h=u;if(f){if(a!==-1){const y=Rn(i,a);zt(y)>0&&c.enqueue(y)}c.close()}else{const y=Ah(h,!1);if(a!==y&&(a>=0&&c.enqueue(Rn(i,a)),a=y),a===-1){c.enqueue(h);return}const S=zt(h);o+=S;const B=zt(i[a]);if(S>=e&&B===0)c.enqueue(h);else{const O=Sh(i,a,h);!r&&o>e*2&&(r=!0,n?.warn(`@smithy/util-stream - stream chunk size ${S} is below threshold of ${e}, automatically buffering.`)),O>=e?c.enqueue(Rn(i,a)):await d(c)}}};return new ReadableStream({pull:d})}const wh=Ch;function Sh(t,e,n){switch(e){case 0:return t[0]+=n,zt(t[0]);case 1:case 2:return t[e].push(n),zt(t[e])}}function Rn(t,e){switch(e){case 0:const n=t[0];return t[0]="",n;case 1:case 2:return t[e].flush()}throw new Error(`@smithy/util-stream - invalid index ${e} given to flush()`)}function zt(t){return t?.byteLength??t?.length??0}function Ah(t,e=!0){return e&&typeof Buffer<"u"&&t instanceof Buffer?2:t instanceof Uint8Array?1:typeof t=="string"?0:-1}const vh=(t,e)=>{const{base64Encoder:n,bodyLengthChecker:s,checksumAlgorithmFn:r,checksumLocationName:o,streamHasher:i}=e,a=n!==void 0&&s!==void 0&&r!==void 0&&o!==void 0&&i!==void 0,d=a?i(r,t):void 0,c=t.getReader();return new ReadableStream({async pull(u){const{value:f,done:h}=await c.read();if(h){if(u.enqueue(`0\r
`),a){const y=n(await d);u.enqueue(`${o}:${y}\r
`),u.enqueue(`\r
`)}u.close()}else u.enqueue(`${(s(f)||0).toString(16)}\r
${f}\r
`)}})};async function kh(t,e){let n=0;const s=[],r=t.getReader();let o=!1;for(;!o;){const{done:d,value:c}=await r.read();if(c&&(s.push(c),n+=c?.byteLength??0),n>=e)break;o=d}r.releaseLock();const i=new Uint8Array(Math.min(e,n));let a=0;for(const d of s){if(d.byteLength>i.byteLength-a){i.set(d.subarray(0,i.byteLength-a),a);break}else i.set(d,a);a+=d.length}return i}async function Rh(t){return typeof t.stream=="function"&&(t=t.stream()),t.tee()}class Ph extends vo{async sign(e,n,s){if(!gt.isInstance(e))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const{config:r,signer:o,signingRegion:i,signingRegionSet:a,signingName:d}=await cc(s),u=(await r.sigv4aSigningRegionSet?.()??a??[i]).join(",");return await o.sign(e,{signingDate:uc(r.systemClockOffset),signingRegion:u,signingService:d})}}const Bh=t=>(t.sigv4aSigningRegionSet=dc(t.sigv4aSigningRegionSet),t),it="***SensitiveInformation***",Ea=t=>{const e="#text";for(const n in t)t.hasOwnProperty(n)&&t[n][e]!==void 0?t[n]=t[n][e]:typeof t[n]=="object"&&t[n]!==null&&(t[n]=Ea(t[n]));return t},jt=t=>t!=null;var Pn={},Bn={},Rr;function Ms(){return Rr||(Rr=1,function(t){const e=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",n=e+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",s="["+e+"]["+n+"]*",r=new RegExp("^"+s+"$"),o=function(a,d){const c=[];let u=d.exec(a);for(;u;){const f=[];f.startIndex=d.lastIndex-u[0].length;const h=u.length;for(let y=0;y<h;y++)f.push(u[y]);c.push(f),u=d.exec(a)}return c},i=function(a){const d=r.exec(a);return!(d===null||typeof d>"u")};t.isExist=function(a){return typeof a<"u"},t.isEmptyObject=function(a){return Object.keys(a).length===0},t.merge=function(a,d,c){if(d){const u=Object.keys(d),f=u.length;for(let h=0;h<f;h++)c==="strict"?a[u[h]]=[d[u[h]]]:a[u[h]]=d[u[h]]}},t.getValue=function(a){return t.isExist(a)?a:""},t.isName=i,t.getAllMatches=o,t.nameRegexp=s}(Bn)),Bn}var Pr;function Ca(){if(Pr)return Pn;Pr=1;const t=Ms(),e={allowBooleanAttributes:!1,unpairedTags:[]};Pn.validate=function(g,x){x=Object.assign({},e,x);const T=[];let b=!1,P=!1;g[0]==="\uFEFF"&&(g=g.substr(1));for(let m=0;m<g.length;m++)if(g[m]==="<"&&g[m+1]==="?"){if(m+=2,m=s(g,m),m.err)return m}else if(g[m]==="<"){let U=m;if(m++,g[m]==="!"){m=r(g,m);continue}else{let E=!1;g[m]==="/"&&(E=!0,m++);let v="";for(;m<g.length&&g[m]!==">"&&g[m]!==" "&&g[m]!=="	"&&g[m]!==`
`&&g[m]!=="\r";m++)v+=g[m];if(v=v.trim(),v[v.length-1]==="/"&&(v=v.substring(0,v.length-1),m--),!S(v)){let A;return v.trim().length===0?A="Invalid space after '<'.":A="Tag '"+v+"' is an invalid name.",h("InvalidTag",A,B(g,m))}const N=a(g,m);if(N===!1)return h("InvalidAttr","Attributes for '"+v+"' have open quote.",B(g,m));let D=N.value;if(m=N.index,D[D.length-1]==="/"){const A=m-D.length;D=D.substring(0,D.length-1);const H=c(D,x);if(H===!0)b=!0;else return h(H.err.code,H.err.msg,B(g,A+H.err.line))}else if(E)if(N.tagClosed){if(D.trim().length>0)return h("InvalidTag","Closing tag '"+v+"' can't have attributes or invalid starting.",B(g,U));if(T.length===0)return h("InvalidTag","Closing tag '"+v+"' has not been opened.",B(g,U));{const A=T.pop();if(v!==A.tagName){let H=B(g,A.tagStartPos);return h("InvalidTag","Expected closing tag '"+A.tagName+"' (opened in line "+H.line+", col "+H.col+") instead of closing tag '"+v+"'.",B(g,U))}T.length==0&&(P=!0)}}else return h("InvalidTag","Closing tag '"+v+"' doesn't have proper closing.",B(g,m));else{const A=c(D,x);if(A!==!0)return h(A.err.code,A.err.msg,B(g,m-D.length+A.err.line));if(P===!0)return h("InvalidXml","Multiple possible root nodes found.",B(g,m));x.unpairedTags.indexOf(v)!==-1||T.push({tagName:v,tagStartPos:U}),b=!0}for(m++;m<g.length;m++)if(g[m]==="<")if(g[m+1]==="!"){m++,m=r(g,m);continue}else if(g[m+1]==="?"){if(m=s(g,++m),m.err)return m}else break;else if(g[m]==="&"){const A=f(g,m);if(A==-1)return h("InvalidChar","char '&' is not expected.",B(g,m));m=A}else if(P===!0&&!n(g[m]))return h("InvalidXml","Extra text at the end",B(g,m));g[m]==="<"&&m--}}else{if(n(g[m]))continue;return h("InvalidChar","char '"+g[m]+"' is not expected.",B(g,m))}if(b){if(T.length==1)return h("InvalidTag","Unclosed tag '"+T[0].tagName+"'.",B(g,T[0].tagStartPos));if(T.length>0)return h("InvalidXml","Invalid '"+JSON.stringify(T.map(m=>m.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return h("InvalidXml","Start tag expected.",1);return!0};function n(g){return g===" "||g==="	"||g===`
`||g==="\r"}function s(g,x){const T=x;for(;x<g.length;x++)if(g[x]=="?"||g[x]==" "){const b=g.substr(T,x-T);if(x>5&&b==="xml")return h("InvalidXml","XML declaration allowed only at the start of the document.",B(g,x));if(g[x]=="?"&&g[x+1]==">"){x++;break}else continue}return x}function r(g,x){if(g.length>x+5&&g[x+1]==="-"&&g[x+2]==="-"){for(x+=3;x<g.length;x++)if(g[x]==="-"&&g[x+1]==="-"&&g[x+2]===">"){x+=2;break}}else if(g.length>x+8&&g[x+1]==="D"&&g[x+2]==="O"&&g[x+3]==="C"&&g[x+4]==="T"&&g[x+5]==="Y"&&g[x+6]==="P"&&g[x+7]==="E"){let T=1;for(x+=8;x<g.length;x++)if(g[x]==="<")T++;else if(g[x]===">"&&(T--,T===0))break}else if(g.length>x+9&&g[x+1]==="["&&g[x+2]==="C"&&g[x+3]==="D"&&g[x+4]==="A"&&g[x+5]==="T"&&g[x+6]==="A"&&g[x+7]==="["){for(x+=8;x<g.length;x++)if(g[x]==="]"&&g[x+1]==="]"&&g[x+2]===">"){x+=2;break}}return x}const o='"',i="'";function a(g,x){let T="",b="",P=!1;for(;x<g.length;x++){if(g[x]===o||g[x]===i)b===""?b=g[x]:b!==g[x]||(b="");else if(g[x]===">"&&b===""){P=!0;break}T+=g[x]}return b!==""?!1:{value:T,index:x,tagClosed:P}}const d=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function c(g,x){const T=t.getAllMatches(g,d),b={};for(let P=0;P<T.length;P++){if(T[P][1].length===0)return h("InvalidAttr","Attribute '"+T[P][2]+"' has no space in starting.",O(T[P]));if(T[P][3]!==void 0&&T[P][4]===void 0)return h("InvalidAttr","Attribute '"+T[P][2]+"' is without value.",O(T[P]));if(T[P][3]===void 0&&!x.allowBooleanAttributes)return h("InvalidAttr","boolean attribute '"+T[P][2]+"' is not allowed.",O(T[P]));const m=T[P][2];if(!y(m))return h("InvalidAttr","Attribute '"+m+"' is an invalid name.",O(T[P]));if(!b.hasOwnProperty(m))b[m]=1;else return h("InvalidAttr","Attribute '"+m+"' is repeated.",O(T[P]))}return!0}function u(g,x){let T=/\d/;for(g[x]==="x"&&(x++,T=/[\da-fA-F]/);x<g.length;x++){if(g[x]===";")return x;if(!g[x].match(T))break}return-1}function f(g,x){if(x++,g[x]===";")return-1;if(g[x]==="#")return x++,u(g,x);let T=0;for(;x<g.length;x++,T++)if(!(g[x].match(/\w/)&&T<20)){if(g[x]===";")break;return-1}return x}function h(g,x,T){return{err:{code:g,msg:x,line:T.line||T,col:T.col}}}function y(g){return t.isName(g)}function S(g){return t.isName(g)}function B(g,x){const T=g.substring(0,x).split(/\r?\n/);return{line:T.length,col:T[T.length-1].length+1}}function O(g){return g.startIndex+g[1].length}return Pn}var sn={},Br;function Nh(){if(Br)return sn;Br=1;const t={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(n,s){return s},attributeValueProcessor:function(n,s){return s},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(n,s,r){return n}},e=function(n){return Object.assign({},t,n)};return sn.buildOptions=e,sn.defaultOptions=t,sn}var Nn,Nr;function Ih(){if(Nr)return Nn;Nr=1;class t{constructor(n){this.tagname=n,this.child=[],this[":@"]={}}add(n,s){n==="__proto__"&&(n="#__proto__"),this.child.push({[n]:s})}addChild(n){n.tagname==="__proto__"&&(n.tagname="#__proto__"),n[":@"]&&Object.keys(n[":@"]).length>0?this.child.push({[n.tagname]:n.child,":@":n[":@"]}):this.child.push({[n.tagname]:n.child})}}return Nn=t,Nn}var In,Ir;function Th(){if(Ir)return In;Ir=1;const t=Ms();function e(c,u){const f={};if(c[u+3]==="O"&&c[u+4]==="C"&&c[u+5]==="T"&&c[u+6]==="Y"&&c[u+7]==="P"&&c[u+8]==="E"){u=u+9;let h=1,y=!1,S=!1,B="";for(;u<c.length;u++)if(c[u]==="<"&&!S){if(y&&r(c,u))u+=7,[entityName,val,u]=n(c,u+1),val.indexOf("&")===-1&&(f[d(entityName)]={regx:RegExp(`&${entityName};`,"g"),val});else if(y&&o(c,u))u+=8;else if(y&&i(c,u))u+=8;else if(y&&a(c,u))u+=9;else if(s)S=!0;else throw new Error("Invalid DOCTYPE");h++,B=""}else if(c[u]===">"){if(S?c[u-1]==="-"&&c[u-2]==="-"&&(S=!1,h--):h--,h===0)break}else c[u]==="["?y=!0:B+=c[u];if(h!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:f,i:u}}function n(c,u){let f="";for(;u<c.length&&c[u]!=="'"&&c[u]!=='"';u++)f+=c[u];if(f=f.trim(),f.indexOf(" ")!==-1)throw new Error("External entites are not supported");const h=c[u++];let y="";for(;u<c.length&&c[u]!==h;u++)y+=c[u];return[f,y,u]}function s(c,u){return c[u+1]==="!"&&c[u+2]==="-"&&c[u+3]==="-"}function r(c,u){return c[u+1]==="!"&&c[u+2]==="E"&&c[u+3]==="N"&&c[u+4]==="T"&&c[u+5]==="I"&&c[u+6]==="T"&&c[u+7]==="Y"}function o(c,u){return c[u+1]==="!"&&c[u+2]==="E"&&c[u+3]==="L"&&c[u+4]==="E"&&c[u+5]==="M"&&c[u+6]==="E"&&c[u+7]==="N"&&c[u+8]==="T"}function i(c,u){return c[u+1]==="!"&&c[u+2]==="A"&&c[u+3]==="T"&&c[u+4]==="T"&&c[u+5]==="L"&&c[u+6]==="I"&&c[u+7]==="S"&&c[u+8]==="T"}function a(c,u){return c[u+1]==="!"&&c[u+2]==="N"&&c[u+3]==="O"&&c[u+4]==="T"&&c[u+5]==="A"&&c[u+6]==="T"&&c[u+7]==="I"&&c[u+8]==="O"&&c[u+9]==="N"}function d(c){if(t.isName(c))return c;throw new Error(`Invalid entity name ${c}`)}return In=e,In}var Tn,Tr;function Dh(){if(Tr)return Tn;Tr=1;const t=/^[-+]?0x[a-fA-F0-9]+$/,e=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,n={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function s(i,a={}){if(a=Object.assign({},n,a),!i||typeof i!="string")return i;let d=i.trim();if(a.skipLike!==void 0&&a.skipLike.test(d))return i;if(i==="0")return 0;if(a.hex&&t.test(d))return o(d,16);if(d.search(/[eE]/)!==-1){const c=d.match(/^([-\+])?(0*)([0-9]*(\.[0-9]*)?[eE][-\+]?[0-9]+)$/);if(c){if(a.leadingZeros)d=(c[1]||"")+c[3];else if(!(c[2]==="0"&&c[3][0]==="."))return i;return a.eNotation?Number(d):i}else return i}else{const c=e.exec(d);if(c){const u=c[1],f=c[2];let h=r(c[3]);if(!a.leadingZeros&&f.length>0&&u&&d[2]!==".")return i;if(!a.leadingZeros&&f.length>0&&!u&&d[1]!==".")return i;if(a.leadingZeros&&f===i)return 0;{const y=Number(d),S=""+y;return S.search(/[eE]/)!==-1?a.eNotation?y:i:d.indexOf(".")!==-1?S==="0"&&h===""||S===h||u&&S==="-"+h?y:i:f?h===S||u+h===S?y:i:d===S||d===u+S?y:i}}else return i}}function r(i){return i&&i.indexOf(".")!==-1&&(i=i.replace(/0+$/,""),i==="."?i="0":i[0]==="."?i="0"+i:i[i.length-1]==="."&&(i=i.substr(0,i.length-1))),i}function o(i,a){if(parseInt)return parseInt(i,a);if(Number.parseInt)return Number.parseInt(i,a);if(window&&window.parseInt)return window.parseInt(i,a);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}return Tn=s,Tn}var Dn,Dr;function Uh(){if(Dr)return Dn;Dr=1;const t=Ms(),e=Ih(),n=Th(),s=Dh();class r{constructor(P){this.options=P,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(m,U)=>String.fromCharCode(Number.parseInt(U,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(m,U)=>String.fromCharCode(Number.parseInt(U,16))}},this.addExternalEntities=o,this.parseXml=u,this.parseTextData=i,this.resolveNameSpace=a,this.buildAttributesMap=c,this.isItStopNode=S,this.replaceEntitiesValue=h,this.readStopNodeData=x,this.saveTextToParentTag=y,this.addChild=f}}function o(b){const P=Object.keys(b);for(let m=0;m<P.length;m++){const U=P[m];this.lastEntities[U]={regex:new RegExp("&"+U+";","g"),val:b[U]}}}function i(b,P,m,U,E,v,N){if(b!==void 0&&(this.options.trimValues&&!U&&(b=b.trim()),b.length>0)){N||(b=this.replaceEntitiesValue(b));const D=this.options.tagValueProcessor(P,b,m,E,v);return D==null?b:typeof D!=typeof b||D!==b?D:this.options.trimValues?T(b,this.options.parseTagValue,this.options.numberParseOptions):b.trim()===b?T(b,this.options.parseTagValue,this.options.numberParseOptions):b}}function a(b){if(this.options.removeNSPrefix){const P=b.split(":"),m=b.charAt(0)==="/"?"/":"";if(P[0]==="xmlns")return"";P.length===2&&(b=m+P[1])}return b}const d=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function c(b,P,m){if(!this.options.ignoreAttributes&&typeof b=="string"){const U=t.getAllMatches(b,d),E=U.length,v={};for(let N=0;N<E;N++){const D=this.resolveNameSpace(U[N][1]);let A=U[N][4],H=this.options.attributeNamePrefix+D;if(D.length)if(this.options.transformAttributeName&&(H=this.options.transformAttributeName(H)),H==="__proto__"&&(H="#__proto__"),A!==void 0){this.options.trimValues&&(A=A.trim()),A=this.replaceEntitiesValue(A);const q=this.options.attributeValueProcessor(D,A,P);q==null?v[H]=A:typeof q!=typeof A||q!==A?v[H]=q:v[H]=T(A,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(v[H]=!0)}if(!Object.keys(v).length)return;if(this.options.attributesGroupName){const N={};return N[this.options.attributesGroupName]=v,N}return v}}const u=function(b){b=b.replace(/\r\n?/g,`
`);const P=new e("!xml");let m=P,U="",E="";for(let v=0;v<b.length;v++)if(b[v]==="<")if(b[v+1]==="/"){const D=O(b,">",v,"Closing Tag is not closed.");let A=b.substring(v+2,D).trim();if(this.options.removeNSPrefix){const ye=A.indexOf(":");ye!==-1&&(A=A.substr(ye+1))}this.options.transformTagName&&(A=this.options.transformTagName(A)),m&&(U=this.saveTextToParentTag(U,m,E));const H=E.substring(E.lastIndexOf(".")+1);if(A&&this.options.unpairedTags.indexOf(A)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${A}>`);let q=0;H&&this.options.unpairedTags.indexOf(H)!==-1?(q=E.lastIndexOf(".",E.lastIndexOf(".")-1),this.tagsNodeStack.pop()):q=E.lastIndexOf("."),E=E.substring(0,q),m=this.tagsNodeStack.pop(),U="",v=D}else if(b[v+1]==="?"){let D=g(b,v,!1,"?>");if(!D)throw new Error("Pi Tag is not closed.");if(U=this.saveTextToParentTag(U,m,E),!(this.options.ignoreDeclaration&&D.tagName==="?xml"||this.options.ignorePiTags)){const A=new e(D.tagName);A.add(this.options.textNodeName,""),D.tagName!==D.tagExp&&D.attrExpPresent&&(A[":@"]=this.buildAttributesMap(D.tagExp,E,D.tagName)),this.addChild(m,A,E)}v=D.closeIndex+1}else if(b.substr(v+1,3)==="!--"){const D=O(b,"-->",v+4,"Comment is not closed.");if(this.options.commentPropName){const A=b.substring(v+4,D-2);U=this.saveTextToParentTag(U,m,E),m.add(this.options.commentPropName,[{[this.options.textNodeName]:A}])}v=D}else if(b.substr(v+1,2)==="!D"){const D=n(b,v);this.docTypeEntities=D.entities,v=D.i}else if(b.substr(v+1,2)==="!["){const D=O(b,"]]>",v,"CDATA is not closed.")-2,A=b.substring(v+9,D);U=this.saveTextToParentTag(U,m,E);let H=this.parseTextData(A,m.tagname,E,!0,!1,!0,!0);H==null&&(H=""),this.options.cdataPropName?m.add(this.options.cdataPropName,[{[this.options.textNodeName]:A}]):m.add(this.options.textNodeName,H),v=D+2}else{let D=g(b,v,this.options.removeNSPrefix),A=D.tagName;const H=D.rawTagName;let q=D.tagExp,ye=D.attrExpPresent,wt=D.closeIndex;this.options.transformTagName&&(A=this.options.transformTagName(A)),m&&U&&m.tagname!=="!xml"&&(U=this.saveTextToParentTag(U,m,E,!1));const Qe=m;if(Qe&&this.options.unpairedTags.indexOf(Qe.tagname)!==-1&&(m=this.tagsNodeStack.pop(),E=E.substring(0,E.lastIndexOf("."))),A!==P.tagname&&(E+=E?"."+A:A),this.isItStopNode(this.options.stopNodes,E,A)){let xe="";if(q.length>0&&q.lastIndexOf("/")===q.length-1)A[A.length-1]==="/"?(A=A.substr(0,A.length-1),E=E.substr(0,E.length-1),q=A):q=q.substr(0,q.length-1),v=D.closeIndex;else if(this.options.unpairedTags.indexOf(A)!==-1)v=D.closeIndex;else{const le=this.readStopNodeData(b,H,wt+1);if(!le)throw new Error(`Unexpected end of ${H}`);v=le.i,xe=le.tagContent}const ut=new e(A);A!==q&&ye&&(ut[":@"]=this.buildAttributesMap(q,E,A)),xe&&(xe=this.parseTextData(xe,A,E,!0,ye,!0,!0)),E=E.substr(0,E.lastIndexOf(".")),ut.add(this.options.textNodeName,xe),this.addChild(m,ut,E)}else{if(q.length>0&&q.lastIndexOf("/")===q.length-1){A[A.length-1]==="/"?(A=A.substr(0,A.length-1),E=E.substr(0,E.length-1),q=A):q=q.substr(0,q.length-1),this.options.transformTagName&&(A=this.options.transformTagName(A));const xe=new e(A);A!==q&&ye&&(xe[":@"]=this.buildAttributesMap(q,E,A)),this.addChild(m,xe,E),E=E.substr(0,E.lastIndexOf("."))}else{const xe=new e(A);this.tagsNodeStack.push(m),A!==q&&ye&&(xe[":@"]=this.buildAttributesMap(q,E,A)),this.addChild(m,xe,E),m=xe}U="",v=wt}}else U+=b[v];return P.child};function f(b,P,m){const U=this.options.updateTag(P.tagname,m,P[":@"]);U===!1||(typeof U=="string"&&(P.tagname=U),b.addChild(P))}const h=function(b){if(this.options.processEntities){for(let P in this.docTypeEntities){const m=this.docTypeEntities[P];b=b.replace(m.regx,m.val)}for(let P in this.lastEntities){const m=this.lastEntities[P];b=b.replace(m.regex,m.val)}if(this.options.htmlEntities)for(let P in this.htmlEntities){const m=this.htmlEntities[P];b=b.replace(m.regex,m.val)}b=b.replace(this.ampEntity.regex,this.ampEntity.val)}return b};function y(b,P,m,U){return b&&(U===void 0&&(U=Object.keys(P.child).length===0),b=this.parseTextData(b,P.tagname,m,!1,P[":@"]?Object.keys(P[":@"]).length!==0:!1,U),b!==void 0&&b!==""&&P.add(this.options.textNodeName,b),b=""),b}function S(b,P,m){const U="*."+m;for(const E in b){const v=b[E];if(U===v||P===v)return!0}return!1}function B(b,P,m=">"){let U,E="";for(let v=P;v<b.length;v++){let N=b[v];if(U)N===U&&(U="");else if(N==='"'||N==="'")U=N;else if(N===m[0])if(m[1]){if(b[v+1]===m[1])return{data:E,index:v}}else return{data:E,index:v};else N==="	"&&(N=" ");E+=N}}function O(b,P,m,U){const E=b.indexOf(P,m);if(E===-1)throw new Error(U);return E+P.length-1}function g(b,P,m,U=">"){const E=B(b,P+1,U);if(!E)return;let v=E.data;const N=E.index,D=v.search(/\s/);let A=v,H=!0;D!==-1&&(A=v.substring(0,D),v=v.substring(D+1).trimStart());const q=A;if(m){const ye=A.indexOf(":");ye!==-1&&(A=A.substr(ye+1),H=A!==E.data.substr(ye+1))}return{tagName:A,tagExp:v,closeIndex:N,attrExpPresent:H,rawTagName:q}}function x(b,P,m){const U=m;let E=1;for(;m<b.length;m++)if(b[m]==="<")if(b[m+1]==="/"){const v=O(b,">",m,`${P} is not closed`);if(b.substring(m+2,v).trim()===P&&(E--,E===0))return{tagContent:b.substring(U,m),i:v};m=v}else if(b[m+1]==="?")m=O(b,"?>",m+1,"StopNode is not closed.");else if(b.substr(m+1,3)==="!--")m=O(b,"-->",m+3,"StopNode is not closed.");else if(b.substr(m+1,2)==="![")m=O(b,"]]>",m,"StopNode is not closed.")-2;else{const v=g(b,m,">");v&&((v&&v.tagName)===P&&v.tagExp[v.tagExp.length-1]!=="/"&&E++,m=v.closeIndex)}}function T(b,P,m){if(P&&typeof b=="string"){const U=b.trim();return U==="true"?!0:U==="false"?!1:s(b,m)}else return t.isExist(b)?b:""}return Dn=r,Dn}var Un={},Ur;function Oh(){if(Ur)return Un;Ur=1;function t(o,i){return e(o,i)}function e(o,i,a){let d;const c={};for(let u=0;u<o.length;u++){const f=o[u],h=n(f);let y="";if(a===void 0?y=h:y=a+"."+h,h===i.textNodeName)d===void 0?d=f[h]:d+=""+f[h];else{if(h===void 0)continue;if(f[h]){let S=e(f[h],i,y);const B=r(S,i);f[":@"]?s(S,f[":@"],y,i):Object.keys(S).length===1&&S[i.textNodeName]!==void 0&&!i.alwaysCreateTextNode?S=S[i.textNodeName]:Object.keys(S).length===0&&(i.alwaysCreateTextNode?S[i.textNodeName]="":S=""),c[h]!==void 0&&c.hasOwnProperty(h)?(Array.isArray(c[h])||(c[h]=[c[h]]),c[h].push(S)):i.isArray(h,y,B)?c[h]=[S]:c[h]=S}}}return typeof d=="string"?d.length>0&&(c[i.textNodeName]=d):d!==void 0&&(c[i.textNodeName]=d),c}function n(o){const i=Object.keys(o);for(let a=0;a<i.length;a++){const d=i[a];if(d!==":@")return d}}function s(o,i,a,d){if(i){const c=Object.keys(i),u=c.length;for(let f=0;f<u;f++){const h=c[f];d.isArray(h,a+"."+h,!0,!0)?o[h]=[i[h]]:o[h]=i[h]}}}function r(o,i){const{textNodeName:a}=i,d=Object.keys(o).length;return!!(d===0||d===1&&(o[a]||typeof o[a]=="boolean"||o[a]===0))}return Un.prettify=t,Un}var On,Or;function _h(){if(Or)return On;Or=1;const{buildOptions:t}=Nh(),e=Uh(),{prettify:n}=Oh(),s=Ca();class r{constructor(i){this.externalEntities={},this.options=t(i)}parse(i,a){if(typeof i!="string")if(i.toString)i=i.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(a){a===!0&&(a={});const u=s.validate(i,a);if(u!==!0)throw Error(`${u.err.msg}:${u.err.line}:${u.err.col}`)}const d=new e(this.options);d.addExternalEntities(this.externalEntities);const c=d.parseXml(i);return this.options.preserveOrder||c===void 0?c:n(c,this.options)}addEntity(i,a){if(a.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(i.indexOf("&")!==-1||i.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(a==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[i]=a}}return On=r,On}var _n,_r;function Mh(){if(_r)return _n;_r=1;const t=`
`;function e(a,d){let c="";return d.format&&d.indentBy.length>0&&(c=t),n(a,d,"",c)}function n(a,d,c,u){let f="",h=!1;for(let y=0;y<a.length;y++){const S=a[y],B=s(S);if(B===void 0)continue;let O="";if(c.length===0?O=B:O=`${c}.${B}`,B===d.textNodeName){let P=S[B];o(O,d)||(P=d.tagValueProcessor(B,P),P=i(P,d)),h&&(f+=u),f+=P,h=!1;continue}else if(B===d.cdataPropName){h&&(f+=u),f+=`<![CDATA[${S[B][0][d.textNodeName]}]]>`,h=!1;continue}else if(B===d.commentPropName){f+=u+`<!--${S[B][0][d.textNodeName]}-->`,h=!0;continue}else if(B[0]==="?"){const P=r(S[":@"],d),m=B==="?xml"?"":u;let U=S[B][0][d.textNodeName];U=U.length!==0?" "+U:"",f+=m+`<${B}${U}${P}?>`,h=!0;continue}let g=u;g!==""&&(g+=d.indentBy);const x=r(S[":@"],d),T=u+`<${B}${x}`,b=n(S[B],d,O,g);d.unpairedTags.indexOf(B)!==-1?d.suppressUnpairedNode?f+=T+">":f+=T+"/>":(!b||b.length===0)&&d.suppressEmptyNode?f+=T+"/>":b&&b.endsWith(">")?f+=T+`>${b}${u}</${B}>`:(f+=T+">",b&&u!==""&&(b.includes("/>")||b.includes("</"))?f+=u+d.indentBy+b+u:f+=b,f+=`</${B}>`),h=!0}return f}function s(a){const d=Object.keys(a);for(let c=0;c<d.length;c++){const u=d[c];if(a.hasOwnProperty(u)&&u!==":@")return u}}function r(a,d){let c="";if(a&&!d.ignoreAttributes)for(let u in a){if(!a.hasOwnProperty(u))continue;let f=d.attributeValueProcessor(u,a[u]);f=i(f,d),f===!0&&d.suppressBooleanAttributes?c+=` ${u.substr(d.attributeNamePrefix.length)}`:c+=` ${u.substr(d.attributeNamePrefix.length)}="${f}"`}return c}function o(a,d){a=a.substr(0,a.length-d.textNodeName.length-1);let c=a.substr(a.lastIndexOf(".")+1);for(let u in d.stopNodes)if(d.stopNodes[u]===a||d.stopNodes[u]==="*."+c)return!0;return!1}function i(a,d){if(a&&a.length>0&&d.processEntities)for(let c=0;c<d.entities.length;c++){const u=d.entities[c];a=a.replace(u.regex,u.val)}return a}return _n=e,_n}var Mn,Mr;function Fh(){if(Mr)return Mn;Mr=1;const t=Mh(),e={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(i,a){return a},attributeValueProcessor:function(i,a){return a},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function n(i){this.options=Object.assign({},e,i),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=o),this.processTextOrObjNode=s,this.options.format?(this.indentate=r,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}n.prototype.build=function(i){return this.options.preserveOrder?t(i,this.options):(Array.isArray(i)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(i={[this.options.arrayNodeName]:i}),this.j2x(i,0).val)},n.prototype.j2x=function(i,a){let d="",c="";for(let u in i)if(Object.prototype.hasOwnProperty.call(i,u))if(typeof i[u]>"u")this.isAttribute(u)&&(c+="");else if(i[u]===null)this.isAttribute(u)?c+="":u[0]==="?"?c+=this.indentate(a)+"<"+u+"?"+this.tagEndChar:c+=this.indentate(a)+"<"+u+"/"+this.tagEndChar;else if(i[u]instanceof Date)c+=this.buildTextValNode(i[u],u,"",a);else if(typeof i[u]!="object"){const f=this.isAttribute(u);if(f)d+=this.buildAttrPairStr(f,""+i[u]);else if(u===this.options.textNodeName){let h=this.options.tagValueProcessor(u,""+i[u]);c+=this.replaceEntitiesValue(h)}else c+=this.buildTextValNode(i[u],u,"",a)}else if(Array.isArray(i[u])){const f=i[u].length;let h="",y="";for(let S=0;S<f;S++){const B=i[u][S];if(!(typeof B>"u"))if(B===null)u[0]==="?"?c+=this.indentate(a)+"<"+u+"?"+this.tagEndChar:c+=this.indentate(a)+"<"+u+"/"+this.tagEndChar;else if(typeof B=="object")if(this.options.oneListGroup){const O=this.j2x(B,a+1);h+=O.val,this.options.attributesGroupName&&B.hasOwnProperty(this.options.attributesGroupName)&&(y+=O.attrStr)}else h+=this.processTextOrObjNode(B,u,a);else if(this.options.oneListGroup){let O=this.options.tagValueProcessor(u,B);O=this.replaceEntitiesValue(O),h+=O}else h+=this.buildTextValNode(B,u,"",a)}this.options.oneListGroup&&(h=this.buildObjectNode(h,u,y,a)),c+=h}else if(this.options.attributesGroupName&&u===this.options.attributesGroupName){const f=Object.keys(i[u]),h=f.length;for(let y=0;y<h;y++)d+=this.buildAttrPairStr(f[y],""+i[u][f[y]])}else c+=this.processTextOrObjNode(i[u],u,a);return{attrStr:d,val:c}},n.prototype.buildAttrPairStr=function(i,a){return a=this.options.attributeValueProcessor(i,""+a),a=this.replaceEntitiesValue(a),this.options.suppressBooleanAttributes&&a==="true"?" "+i:" "+i+'="'+a+'"'};function s(i,a,d){const c=this.j2x(i,d+1);return i[this.options.textNodeName]!==void 0&&Object.keys(i).length===1?this.buildTextValNode(i[this.options.textNodeName],a,c.attrStr,d):this.buildObjectNode(c.val,a,c.attrStr,d)}n.prototype.buildObjectNode=function(i,a,d,c){if(i==="")return a[0]==="?"?this.indentate(c)+"<"+a+d+"?"+this.tagEndChar:this.indentate(c)+"<"+a+d+this.closeTag(a)+this.tagEndChar;{let u="</"+a+this.tagEndChar,f="";return a[0]==="?"&&(f="?",u=""),(d||d==="")&&i.indexOf("<")===-1?this.indentate(c)+"<"+a+d+f+">"+i+u:this.options.commentPropName!==!1&&a===this.options.commentPropName&&f.length===0?this.indentate(c)+`<!--${i}-->`+this.newLine:this.indentate(c)+"<"+a+d+f+this.tagEndChar+i+this.indentate(c)+u}},n.prototype.closeTag=function(i){let a="";return this.options.unpairedTags.indexOf(i)!==-1?this.options.suppressUnpairedNode||(a="/"):this.options.suppressEmptyNode?a="/":a=`></${i}`,a},n.prototype.buildTextValNode=function(i,a,d,c){if(this.options.cdataPropName!==!1&&a===this.options.cdataPropName)return this.indentate(c)+`<![CDATA[${i}]]>`+this.newLine;if(this.options.commentPropName!==!1&&a===this.options.commentPropName)return this.indentate(c)+`<!--${i}-->`+this.newLine;if(a[0]==="?")return this.indentate(c)+"<"+a+d+"?"+this.tagEndChar;{let u=this.options.tagValueProcessor(a,i);return u=this.replaceEntitiesValue(u),u===""?this.indentate(c)+"<"+a+d+this.closeTag(a)+this.tagEndChar:this.indentate(c)+"<"+a+d+">"+u+"</"+a+this.tagEndChar}},n.prototype.replaceEntitiesValue=function(i){if(i&&i.length>0&&this.options.processEntities)for(let a=0;a<this.options.entities.length;a++){const d=this.options.entities[a];i=i.replace(d.regex,d.val)}return i};function r(i){return this.options.indentBy.repeat(i)}function o(i){return i.startsWith(this.options.attributeNamePrefix)&&i!==this.options.textNodeName?i.substr(this.attrPrefixLen):!1}return Mn=n,Mn}var Fn,Fr;function Lh(){if(Fr)return Fn;Fr=1;const t=Ca(),e=_h(),n=Fh();return Fn={XMLParser:e,XMLValidator:t,XMLBuilder:n},Fn}var $h=Lh();const wa=(t,e)=>lc(t,e).then(n=>{if(n.length){const s=new $h.XMLParser({attributeNamePrefix:"",htmlEntities:!0,ignoreAttributes:!1,ignoreDeclaration:!0,parseTagValue:!1,trimValues:!1,tagValueProcessor:(d,c)=>c.trim()===""&&c.includes(`
`)?"":void 0});s.addEntity("#xD","\r"),s.addEntity("#10",`
`);let r;try{r=s.parse(n,!0)}catch(d){throw d&&typeof d=="object"&&Object.defineProperty(d,"$responseBodyText",{value:n}),d}const o="#text",i=Object.keys(r)[0],a=r[i];return a[o]&&(a[i]=a[o],delete a[o]),Ea(a)}return{}}),Hh=async(t,e)=>{const n=await wa(t,e);return n.Error&&(n.Error.message=n.Error.message??n.Error.Message),n},zh=(t,e)=>{if(e?.Error?.Code!==void 0)return e.Error.Code;if(e?.Code!==void 0)return e.Code;if(t.statusCode==404)return"NotFound"};function jh(t){return e=>async n=>{const{request:s}=n;return gt.isInstance(s)&&s.body&&t.runtime==="node"&&t.requestHandler?.constructor?.name!=="FetchHttpHandler"&&(s.headers={...s.headers,Expect:"100-continue"}),e({...n,request:s})}}const Kh={step:"build",tags:["SET_EXPECT_HEADER","EXPECT_HEADER"],name:"addExpectContinueMiddleware",override:!0},Wh=t=>({applyToStack:e=>{e.add(jh(t),Kh)}}),It={WHEN_SUPPORTED:"WHEN_SUPPORTED",WHEN_REQUIRED:"WHEN_REQUIRED"},qh=It.WHEN_SUPPORTED,Ln={WHEN_SUPPORTED:"WHEN_SUPPORTED",WHEN_REQUIRED:"WHEN_REQUIRED"},Vh=It.WHEN_SUPPORTED;var ee;(function(t){t.MD5="MD5",t.CRC32="CRC32",t.CRC32C="CRC32C",t.CRC64NVME="CRC64NVME",t.SHA1="SHA1",t.SHA256="SHA256"})(ee||(ee={}));var Lr;(function(t){t.HEADER="header",t.TRAILER="trailer"})(Lr||(Lr={}));const vs=ee.CRC32;var $r;(function(t){t.ENV="env",t.CONFIG="shared config entry"})($r||($r={}));const ks=[ee.CRC32,ee.CRC32C,ee.CRC64NVME,ee.SHA1,ee.SHA256],Gh=[ee.SHA256,ee.SHA1,ee.CRC32,ee.CRC32C,ee.CRC64NVME],Xh=(t,{requestChecksumRequired:e,requestAlgorithmMember:n,requestChecksumCalculation:s})=>{if(!n)return s===It.WHEN_SUPPORTED||e?vs:void 0;if(!t[n])return;const r=t[n];if(!ks.includes(r))throw new Error(`The checksum algorithm "${r}" is not supported by the client. Select one of ${ks}.`);return r},Fs=t=>t===ee.MD5?"content-md5":`x-amz-checksum-${t.toLowerCase()}`,Zh=(t,e)=>{const n=t.toLowerCase();for(const s of Object.keys(e))if(n===s.toLowerCase())return!0;return!1},Jh=(t,e)=>{const n=t.toLowerCase();for(const s of Object.keys(e))if(s.toLowerCase().startsWith(n))return!0;return!1},Sa=t=>t!==void 0&&typeof t!="string"&&!ArrayBuffer.isView(t)&&!hc(t);var Qh=function(){function t(){this.crc32c=new Hr}return t.prototype.update=function(e){_o(e)||this.crc32c.update(Ds(e))},t.prototype.digest=function(){return Mo(this,void 0,void 0,function(){return Fo(this,function(e){return[2,Ko(this.crc32c.digest())]})})},t.prototype.reset=function(){this.crc32c=new Hr},t}(),Hr=function(){function t(){this.checksum=4294967295}return t.prototype.update=function(e){var n,s;try{for(var r=Lo(e),o=r.next();!o.done;o=r.next()){var i=o.value;this.checksum=this.checksum>>>8^ef[(this.checksum^i)&255]}}catch(a){n={error:a}}finally{try{o&&!o.done&&(s=r.return)&&s.call(r)}finally{if(n)throw n.error}}return this},t.prototype.digest=function(){return(this.checksum^4294967295)>>>0},t}(),Yh=[0,4067132163,3778769143,324072436,3348797215,904991772,648144872,3570033899,2329499855,2024987596,1809983544,2575936315,1296289744,3207089363,2893594407,1578318884,274646895,3795141740,4049975192,51262619,3619967088,632279923,922689671,3298075524,2592579488,1760304291,2075979607,2312596564,1562183871,2943781820,3156637768,1313733451,549293790,3537243613,3246849577,871202090,3878099393,357341890,102525238,4101499445,2858735121,1477399826,1264559846,3107202533,1845379342,2677391885,2361733625,2125378298,820201905,3263744690,3520608582,598981189,4151959214,85089709,373468761,3827903834,3124367742,1213305469,1526817161,2842354314,2107672161,2412447074,2627466902,1861252501,1098587580,3004210879,2688576843,1378610760,2262928035,1955203488,1742404180,2511436119,3416409459,969524848,714683780,3639785095,205050476,4266873199,3976438427,526918040,1361435347,2739821008,2954799652,1114974503,2529119692,1691668175,2005155131,2247081528,3690758684,697762079,986182379,3366744552,476452099,3993867776,4250756596,255256311,1640403810,2477592673,2164122517,1922457750,2791048317,1412925310,1197962378,3037525897,3944729517,427051182,170179418,4165941337,746937522,3740196785,3451792453,1070968646,1905808397,2213795598,2426610938,1657317369,3053634322,1147748369,1463399397,2773627110,4215344322,153784257,444234805,3893493558,1021025245,3467647198,3722505002,797665321,2197175160,1889384571,1674398607,2443626636,1164749927,3070701412,2757221520,1446797203,137323447,4198817972,3910406976,461344835,3484808360,1037989803,781091935,3705997148,2460548119,1623424788,1939049696,2180517859,1429367560,2807687179,3020495871,1180866812,410100952,3927582683,4182430767,186734380,3756733383,763408580,1053836080,3434856499,2722870694,1344288421,1131464017,2971354706,1708204729,2545590714,2229949006,1988219213,680717673,3673779818,3383336350,1002577565,4010310262,493091189,238226049,4233660802,2987750089,1082061258,1395524158,2705686845,1972364758,2279892693,2494862625,1725896226,952904198,3399985413,3656866545,731699698,4283874585,222117402,510512622,3959836397,3280807620,837199303,582374963,3504198960,68661723,4135334616,3844915500,390545967,1230274059,3141532936,2825850620,1510247935,2395924756,2091215383,1878366691,2644384480,3553878443,565732008,854102364,3229815391,340358836,3861050807,4117890627,119113024,1493875044,2875275879,3090270611,1247431312,2660249211,1828433272,2141937292,2378227087,3811616794,291187481,34330861,4032846830,615137029,3603020806,3314634738,939183345,1776939221,2609017814,2295496738,2058945313,2926798794,1545135305,1330124605,3173225534,4084100981,17165430,307568514,3762199681,888469610,3332340585,3587147933,665062302,2042050490,2346497209,2559330125,1793573966,3190661285,1279665062,1595330642,2910671697],ef=Wo(Yh),tf=function(){function t(){this.crc32=new fn}return t.prototype.update=function(e){_o(e)||this.crc32.update(Ds(e))},t.prototype.digest=function(){return Mo(this,void 0,void 0,function(){return Fo(this,function(e){return[2,Ko(this.crc32.digest())]})})},t.prototype.reset=function(){this.crc32=new fn},t}(),fn=function(){function t(){this.checksum=4294967295}return t.prototype.update=function(e){var n,s;try{for(var r=Lo(e),o=r.next();!o.done;o=r.next()){var i=o.value;this.checksum=this.checksum>>>8^sf[(this.checksum^i)&255]}}catch(a){n={error:a}}finally{try{o&&!o.done&&(s=r.return)&&s.call(r)}finally{if(n)throw n.error}}return this},t.prototype.digest=function(){return(this.checksum^4294967295)>>>0},t}(),nf=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],sf=Wo(nf);const rf=()=>tf,Aa=(t,e)=>{switch(t){case ee.MD5:return e.md5;case ee.CRC32:return rf();case ee.CRC32C:return Qh;case ee.CRC64NVME:throw new Error(`Please check whether you have installed the "@aws-sdk/crc64-nvme-crt" package explicitly. 
You must also register the package by calling [require("@aws-sdk/crc64-nvme-crt");] or an ESM equivalent such as [import "@aws-sdk/crc64-nvme-crt";]. 
For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt`);case ee.SHA1:return e.sha1;case ee.SHA256:return e.sha256;default:throw new Error(`Unsupported checksum algorithm: ${t}`)}},va=(t,e)=>{const n=new t;return n.update(fc(e||"")),n.digest()},of={name:"flexibleChecksumsMiddleware",step:"build",tags:["BODY_CHECKSUM"],override:!0},af=(t,e)=>(n,s)=>async r=>{if(!gt.isInstance(r.request)||Jh("x-amz-checksum-",r.request.headers))return n(r);const{request:o,input:i}=r,{body:a,headers:d}=o,{base64Encoder:c,streamHasher:u}=t,{requestChecksumRequired:f,requestAlgorithmMember:h}=e,y=await t.requestChecksumCalculation(),S=h?.name,B=h?.httpHeader;S&&!i[S]&&(y===It.WHEN_SUPPORTED||f)&&(i[S]=vs,B&&(d[B]=vs));const O=Xh(i,{requestChecksumRequired:f,requestAlgorithmMember:h?.name,requestChecksumCalculation:y});let g=a,x=d;if(O){switch(O){case ee.CRC32:Xe(s,"FLEXIBLE_CHECKSUMS_REQ_CRC32","U");break;case ee.CRC32C:Xe(s,"FLEXIBLE_CHECKSUMS_REQ_CRC32C","V");break;case ee.CRC64NVME:Xe(s,"FLEXIBLE_CHECKSUMS_REQ_CRC64","W");break;case ee.SHA1:Xe(s,"FLEXIBLE_CHECKSUMS_REQ_SHA1","X");break;case ee.SHA256:Xe(s,"FLEXIBLE_CHECKSUMS_REQ_SHA256","Y");break}const b=Fs(O),P=Aa(O,t);if(Sa(a)){const{getAwsChunkedEncodingStream:m,bodyLengthChecker:U}=t;g=m(typeof t.requestStreamBufferSize=="number"&&t.requestStreamBufferSize>=8*1024?wh(a,t.requestStreamBufferSize,s.logger):a,{base64Encoder:c,bodyLengthChecker:U,checksumLocationName:b,checksumAlgorithmFn:P,streamHasher:u}),x={...d,"content-encoding":d["content-encoding"]?`${d["content-encoding"]},aws-chunked`:"aws-chunked","transfer-encoding":"chunked","x-amz-decoded-content-length":d["content-length"],"x-amz-content-sha256":"STREAMING-UNSIGNED-PAYLOAD-TRAILER","x-amz-trailer":b},delete x["content-length"]}else if(!Zh(b,d)){const m=await va(P,a);x={...d,[b]:c(m)}}}return await n({...r,request:{...o,headers:x,body:g}})},cf={name:"flexibleChecksumsInputMiddleware",toMiddleware:"serializerMiddleware",relation:"before",tags:["BODY_CHECKSUM"],override:!0},uf=(t,e)=>(n,s)=>async r=>{const o=r.input,{requestValidationModeMember:i}=e,a=await t.requestChecksumCalculation(),d=await t.responseChecksumValidation();switch(a){case It.WHEN_REQUIRED:Xe(s,"FLEXIBLE_CHECKSUMS_REQ_WHEN_REQUIRED","a");break;case It.WHEN_SUPPORTED:Xe(s,"FLEXIBLE_CHECKSUMS_REQ_WHEN_SUPPORTED","Z");break}switch(d){case Ln.WHEN_REQUIRED:Xe(s,"FLEXIBLE_CHECKSUMS_RES_WHEN_REQUIRED","c");break;case Ln.WHEN_SUPPORTED:Xe(s,"FLEXIBLE_CHECKSUMS_RES_WHEN_SUPPORTED","b");break}return o[i]||d===Ln.WHEN_SUPPORTED&&(o[i]="ENABLED"),n(r)},ka=(t=[])=>{const e=[];for(const n of Gh)!t.includes(n)||!ks.includes(n)||e.push(n);return e},df=t=>{const e=t.lastIndexOf("-");if(e!==-1){const n=t.slice(e+1);if(!n.startsWith("0")){const s=parseInt(n,10);if(!isNaN(s)&&s>=1&&s<=1e4)return!0}}return!1},lf=async(t,{checksumAlgorithmFn:e,base64Encoder:n})=>n(await va(e,t)),hf=async(t,{config:e,responseAlgorithms:n,logger:s})=>{const r=ka(n),{body:o,headers:i}=t;for(const a of r){const d=Fs(a),c=i[d];if(c){let u;try{u=Aa(a,e)}catch(y){if(a===ee.CRC64NVME){s?.warn(`Skipping ${ee.CRC64NVME} checksum validation: ${y.message}`);continue}throw y}const{base64Encoder:f}=e;if(Sa(o)){t.body=bh({expectedChecksum:c,checksumSourceLocation:d,checksum:new u,source:o,base64Encoder:f});return}const h=await lf(o,{checksumAlgorithmFn:u,base64Encoder:f});if(h===c)break;throw new Error(`Checksum mismatch: expected "${h}" but received "${c}" in response header "${d}".`)}}},ff={name:"flexibleChecksumsResponseMiddleware",toMiddleware:"deserializerMiddleware",relation:"after",tags:["BODY_CHECKSUM"],override:!0},pf=(t,e)=>(n,s)=>async r=>{if(!gt.isInstance(r.request))return n(r);const o=r.input,i=await n(r),a=i.response,{requestValidationModeMember:d,responseAlgorithms:c}=e;if(o[d]==="ENABLED"){const{clientName:u,commandName:f}=s;if(u==="S3Client"&&f==="GetObjectCommand"&&ka(c).every(y=>{const S=Fs(y),B=a.headers[S];return!B||df(B)}))return i;await hf(a,{config:t,responseAlgorithms:c,logger:s.logger})}return i},gf=(t,e)=>({applyToStack:n=>{n.add(af(t,e),of),n.addRelativeTo(uf(t,e),cf),n.addRelativeTo(pf(t,e),ff)}}),mf=t=>{const{requestChecksumCalculation:e,responseChecksumValidation:n,requestStreamBufferSize:s}=t;return Object.assign(t,{requestChecksumCalculation:gs(e??qh),responseChecksumValidation:gs(n??Vh),requestStreamBufferSize:Number(s??0)})},yf=t=>(e,n)=>async s=>{const r=await t.region(),o=t.region;let i=()=>{};n.__s3RegionRedirect&&(Object.defineProperty(t,"region",{writable:!1,value:async()=>n.__s3RegionRedirect}),i=()=>Object.defineProperty(t,"region",{writable:!0,value:o}));try{const a=await e(s);if(n.__s3RegionRedirect){i();const d=await t.region();if(r!==d)throw new Error("Region was not restored following S3 region redirect.")}return a}catch(a){throw i(),a}},xf={tags:["REGION_REDIRECT","S3"],name:"regionRedirectEndpointMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"};function bf(t){return(e,n)=>async s=>{try{return await e(s)}catch(r){if(t.followRegionRedirects&&(r?.$metadata?.httpStatusCode===301||r?.$metadata?.httpStatusCode===400&&r?.name==="IllegalLocationConstraintException")){try{const o=r.$response.headers["x-amz-bucket-region"];n.logger?.debug(`Redirecting from ${await t.region()} to ${o}`),n.__s3RegionRedirect=o}catch(o){throw new Error("Region redirect failed: "+o)}return e(s)}throw r}}}const Ef={step:"initialize",tags:["REGION_REDIRECT","S3"],name:"regionRedirectMiddleware",override:!0},Cf=t=>({applyToStack:e=>{e.add(bf(t),Ef),e.addRelativeTo(yf(t),xf)}}),wf=t=>(e,n)=>async s=>{const r=await e(s),{response:o}=r;if(ko.isInstance(o)&&o.headers.expires){o.headers.expiresstring=o.headers.expires;try{ys(o.headers.expires)}catch(i){n.logger?.warn(`AWS SDK Warning for ${n.clientName}::${n.commandName} response parsing (${o.headers.expires}): ${i}`),delete o.headers.expires}}return r},Sf={tags:["S3"],name:"s3ExpiresMiddleware",override:!0,relation:"after",toMiddleware:"deserializerMiddleware"},Af=t=>({applyToStack:e=>{e.addRelativeTo(wf(),Sf)}});class Ls{data;lastPurgeTime=Date.now();static EXPIRED_CREDENTIAL_PURGE_INTERVAL_MS=3e4;constructor(e={}){this.data=e}get(e){const n=this.data[e];if(n)return n}set(e,n){return this.data[e]=n,n}delete(e){delete this.data[e]}async purgeExpired(){const e=Date.now();if(!(this.lastPurgeTime+Ls.EXPIRED_CREDENTIAL_PURGE_INTERVAL_MS>e))for(const n in this.data){const s=this.data[n];if(!s.isRefreshing){const r=await s.identity;r.expiration&&r.expiration.getTime()<e&&delete this.data[n]}}}}class $n{_identity;isRefreshing;accessed;constructor(e,n=!1,s=Date.now()){this._identity=e,this.isRefreshing=n,this.accessed=s}get identity(){return this.accessed=Date.now(),this._identity}}class $s{createSessionFn;cache;static REFRESH_WINDOW_MS=6e4;constructor(e,n=new Ls){this.createSessionFn=e,this.cache=n}async getS3ExpressIdentity(e,n){const s=n.Bucket,{cache:r}=this,o=r.get(s);return o?o.identity.then(i=>(i.expiration?.getTime()??0)<Date.now()?r.set(s,new $n(this.getIdentity(s))).identity:((i.expiration?.getTime()??0)<Date.now()+$s.REFRESH_WINDOW_MS&&!o.isRefreshing&&(o.isRefreshing=!0,this.getIdentity(s).then(c=>{r.set(s,new $n(Promise.resolve(c)))})),i)):r.set(s,new $n(this.getIdentity(s))).identity}async getIdentity(e){await this.cache.purgeExpired().catch(r=>{console.warn(`Error while clearing expired entries in S3ExpressIdentityCache: 
`+r)});const n=await this.createSessionFn(e);if(!n.Credentials?.AccessKeyId||!n.Credentials?.SecretAccessKey)throw new Error("s3#createSession response credential missing AccessKeyId or SecretAccessKey.");return{accessKeyId:n.Credentials.AccessKeyId,secretAccessKey:n.Credentials.SecretAccessKey,sessionToken:n.Credentials.SessionToken,expiration:n.Credentials.Expiration?new Date(n.Credentials.Expiration):void 0}}}const vf="Directory",kf="S3Express",Rf="sigv4-s3express",Rs="X-Amz-S3session-Token",Ps=Rs.toLowerCase();class Pf extends pc{async signWithCredentials(e,n,s){const r=zr(n);e.headers[Ps]=n.sessionToken;const o=this;return jr(o,r),o.signRequest(e,s??{})}async presignWithCredentials(e,n,s){const r=zr(n);return delete e.headers[Ps],e.headers[Rs]=n.sessionToken,e.query=e.query??{},e.query[Rs]=n.sessionToken,jr(this,r),this.presign(e,s)}}function zr(t){return{accessKeyId:t.accessKeyId,secretAccessKey:t.secretAccessKey,expiration:t.expiration}}function jr(t,e){const n=setTimeout(()=>{throw new Error("SignatureV4S3Express credential override was created but not called.")},10),s=t.credentialProvider,r=()=>(clearTimeout(n),t.credentialProvider=s,Promise.resolve(e));t.credentialProvider=r}const Bf=t=>(e,n)=>async s=>{if(n.endpointV2){const r=n.endpointV2,o=r.properties?.authSchemes?.[0]?.name===Rf;if((r.properties?.backend===kf||r.properties?.bucketType===vf)&&(Xe(n,"S3_EXPRESS_BUCKET","J"),n.isS3ExpressBucket=!0),o){const a=s.input.Bucket;if(a){const d=await t.s3ExpressIdentityProvider.getS3ExpressIdentity(await t.credentials(),{Bucket:a});n.s3ExpressIdentity=d,gt.isInstance(s.request)&&d.sessionToken&&(s.request.headers[Ps]=d.sessionToken)}}}return e(s)},Nf={name:"s3ExpressMiddleware",step:"build",tags:["S3","S3_EXPRESS"],override:!0},If=t=>({applyToStack:e=>{e.add(Bf(t),Nf)}}),Tf=async(t,e,n,s)=>{const r=await s.signWithCredentials(n,t,{});if(r.headers["X-Amz-Security-Token"]||r.headers["x-amz-security-token"])throw new Error("X-Amz-Security-Token must not be set for s3-express requests.");return r},Df=t=>e=>{throw e},Uf=(t,e)=>{},Of=t=>(e,n)=>async s=>{if(!gt.isInstance(s.request))return e(s);const o=Is(n).selectedHttpAuthScheme;if(!o)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:i={}},identity:a,signer:d}=o;let c;n.s3ExpressIdentity?c=await Tf(n.s3ExpressIdentity,i,s.request,await t.signer()):c=await d.sign(s.request,a,i);const u=await e({...s,request:c}).catch((d.errorHandler||Df)(i));return(d.successHandler||Uf)(u.response,i),u},_f=t=>({applyToStack:e=>{e.addRelativeTo(Of(t),gc)}}),Mf=(t,{session:e})=>{const[n,s]=e,{forcePathStyle:r,useAccelerateEndpoint:o,disableMultiregionAccessPoints:i,followRegionRedirects:a,s3ExpressIdentityProvider:d,bucketEndpoint:c}=t;return Object.assign(t,{forcePathStyle:r??!1,useAccelerateEndpoint:o??!1,disableMultiregionAccessPoints:i??!1,followRegionRedirects:a??!1,s3ExpressIdentityProvider:d??new $s(async u=>n().send(new s({Bucket:u}))),bucketEndpoint:c??!1})},Ff={CopyObjectCommand:!0,UploadPartCopyCommand:!0,CompleteMultipartUploadCommand:!0},Lf=3e3,$f=t=>(e,n)=>async s=>{const r=await e(s),{response:o}=r;if(!ko.isInstance(o))return r;const{statusCode:i,body:a}=o;if(i<200||i>=300||!(typeof a?.stream=="function"||typeof a?.pipe=="function"||typeof a?.tee=="function"))return r;let c=a,u=a;a&&typeof a=="object"&&!(a instanceof Uint8Array)&&([c,u]=await Rh(a)),o.body=u;const f=await Hf(c,{streamCollector:async y=>kh(y,Lf)});typeof c?.destroy=="function"&&c.destroy();const h=t.utf8Encoder(f.subarray(f.length-16));if(f.length===0&&Ff[n.commandName]){const y=new Error("S3 aborted request");throw y.name="InternalError",y}return h&&h.endsWith("</Error>")&&(o.statusCode=400),r},Hf=(t=new Uint8Array,e)=>t instanceof Uint8Array?Promise.resolve(t):e.streamCollector(t)||Promise.resolve(new Uint8Array),zf={relation:"after",toMiddleware:"deserializerMiddleware",tags:["THROW_200_EXCEPTIONS","S3"],name:"throw200ExceptionsMiddleware",override:!0},jf=t=>({applyToStack:e=>{e.addRelativeTo($f(t),zf)}}),Kf=t=>typeof t=="string"&&t.indexOf("arn:")===0&&t.split(":").length>=6;function Wf(t){return(e,n)=>async s=>{if(t.bucketEndpoint){const r=n.endpointV2;if(r){const o=s.input.Bucket;if(typeof o=="string")try{const i=new URL(o);n.endpointV2={...r,url:i}}catch(i){const a=`@aws-sdk/middleware-sdk-s3: bucketEndpoint=true was set but Bucket=${o} could not be parsed as URL.`;throw n.logger?.constructor?.name==="NoOpLogger"?console.warn(a):n.logger?.warn?.(a),i}}}return e(s)}}const qf={name:"bucketEndpointMiddleware",override:!0,relation:"after",toMiddleware:"endpointV2Middleware"};function Vf({bucketEndpoint:t}){return e=>async n=>{const{input:{Bucket:s}}=n;if(!t&&typeof s=="string"&&!Kf(s)&&s.indexOf("/")>=0){const r=new Error(`Bucket name shouldn't contain '/', received '${s}'`);throw r.name="InvalidBucketName",r}return e({...n})}}const Gf={step:"initialize",tags:["VALIDATE_BUCKET_NAME"],name:"validateBucketNameMiddleware",override:!0},Xf=t=>({applyToStack:e=>{e.add(Vf(t),Gf),e.addRelativeTo(Wf(t),qf)}}),Zf=t=>Object.assign(t,{eventStreamMarshaller:t.eventStreamSerdeProvider(t)}),Jf={CrtSignerV4:null};class Ra{sigv4aSigner;sigv4Signer;signerOptions;constructor(e){this.sigv4Signer=new Pf(e),this.signerOptions=e}async sign(e,n={}){if(n.signingRegion==="*"){if(this.signerOptions.runtime!=="node")throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return this.getSigv4aSigner().sign(e,n)}return this.sigv4Signer.sign(e,n)}async signWithCredentials(e,n,s={}){if(s.signingRegion==="*"){if(this.signerOptions.runtime!=="node")throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return this.getSigv4aSigner().signWithCredentials(e,n,s)}return this.sigv4Signer.signWithCredentials(e,n,s)}async presign(e,n={}){if(n.signingRegion==="*"){if(this.signerOptions.runtime!=="node")throw new Error("This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js");return this.getSigv4aSigner().presign(e,n)}return this.sigv4Signer.presign(e,n)}async presignWithCredentials(e,n,s={}){if(s.signingRegion==="*")throw new Error("Method presignWithCredentials is not supported for [signingRegion=*].");return this.sigv4Signer.presignWithCredentials(e,n,s)}getSigv4aSigner(){if(!this.sigv4aSigner){let e=null;try{if(e=Jf.CrtSignerV4,typeof e!="function")throw new Error}catch(n){throw n.message=`${n.message}
Please check whether you have installed the "@aws-sdk/signature-v4-crt" package explicitly. 
You must also register the package by calling [require("@aws-sdk/signature-v4-crt");] or an ESM equivalent such as [import "@aws-sdk/signature-v4-crt";]. 
For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt`,n}this.sigv4aSigner=new e({...this.signerOptions,signingAlgorithm:1})}return this.sigv4aSigner}}const Hs="required",l="type",k="rules",p="conditions",C="fn",w="argv",$="ref",W="assign",M="url",F="properties",pt="backend",Pe="authSchemes",ge="disableDoubleEncoding",me="signingName",Ie="signingRegion",L="headers",zs="signingRegionSet",Qf=6,Yf=!1,qe=!0,Me="isSet",oe="booleanEquals",_="error",pn="aws.partition",J="stringEquals",ne="getAttr",ie="name",Y="substring",Kr="bucketSuffix",js="parseURL",I="endpoint",R="tree",gn="aws.isVirtualHostableS3Bucket",mn="{url#scheme}://{Bucket}.{url#authority}{url#path}",Ze="not",Wr="accessPointSuffix",dn="{url#scheme}://{url#authority}{url#path}",Pa="hardwareType",Ba="regionPrefix",qr="bucketAliasSuffix",Bs="outpostId",Ct="isValidHostLabel",Ks="sigv4a",Gt="s3-outposts",Tt="s3",Na="{url#scheme}://{url#authority}{url#normalizedPath}{Bucket}",Ia="https://{Bucket}.s3-accelerate.{partitionResult#dnsSuffix}",Vr="https://{Bucket}.s3.{partitionResult#dnsSuffix}",Ta="aws.parseArn",Da="bucketArn",Ua="arnType",yn="",Ws="s3-object-lambda",Oa="accesspoint",qs="accessPointName",Gr="{url#scheme}://{accessPointName}-{bucketArn#accountId}.{url#authority}{url#path}",Xr="mrapPartition",Zr="outpostType",Jr="arnPrefix",_a="{url#scheme}://{url#authority}{url#normalizedPath}{uri_encoded_bucket}",Qr="https://s3.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",Yr="https://s3.{partitionResult#dnsSuffix}",St={[Hs]:!1,[l]:"String"},At={[Hs]:!0,default:!1,[l]:"Boolean"},_t={[Hs]:!1,[l]:"Boolean"},He={[C]:oe,[w]:[{[$]:"Accelerate"},!0]},te={[C]:oe,[w]:[{[$]:"UseFIPS"},!0]},Q={[C]:oe,[w]:[{[$]:"UseDualStack"},!0]},re={[C]:Me,[w]:[{[$]:"Endpoint"}]},Ma={[C]:pn,[w]:[{[$]:"Region"}],[W]:"partitionResult"},ei={[C]:J,[w]:[{[C]:ne,[w]:[{[$]:"partitionResult"},ie]},"aws-cn"]},Kt={[C]:Me,[w]:[{[$]:"Bucket"}]},Z={[$]:"Bucket"},ti={[p]:[Q],[_]:"S3Express does not support Dual-stack.",[l]:_},ni={[p]:[He],[_]:"S3Express does not support S3 Accelerate.",[l]:_},si={[p]:[re,{[C]:js,[w]:[{[$]:"Endpoint"}],[W]:"url"}],[k]:[{[p]:[{[C]:Me,[w]:[{[$]:"DisableS3ExpressSessionAuth"}]},{[C]:oe,[w]:[{[$]:"DisableS3ExpressSessionAuth"},!0]}],[k]:[{[p]:[{[C]:oe,[w]:[{[C]:ne,[w]:[{[$]:"url"},"isIp"]},!0]}],[k]:[{[p]:[{[C]:"uriEncode",[w]:[Z],[W]:"uri_encoded_bucket"}],[k]:[{[I]:{[M]:"{url#scheme}://{url#authority}/{uri_encoded_bucket}{url#path}",[F]:{[pt]:"S3Express",[Pe]:[{[ge]:!0,[ie]:"sigv4",[me]:"s3express",[Ie]:"{Region}"}]},[L]:{}},[l]:I}],[l]:R}],[l]:R},{[p]:[{[C]:gn,[w]:[Z,!1]}],[k]:[{[I]:{[M]:mn,[F]:{[pt]:"S3Express",[Pe]:[{[ge]:!0,[ie]:"sigv4",[me]:"s3express",[Ie]:"{Region}"}]},[L]:{}},[l]:I}],[l]:R},{[_]:"S3Express bucket name is not a valid virtual hostable name.",[l]:_}],[l]:R},{[p]:[{[C]:oe,[w]:[{[C]:ne,[w]:[{[$]:"url"},"isIp"]},!0]}],[k]:[{[p]:[{[C]:"uriEncode",[w]:[Z],[W]:"uri_encoded_bucket"}],[k]:[{[I]:{[M]:"{url#scheme}://{url#authority}/{uri_encoded_bucket}{url#path}",[F]:{[pt]:"S3Express",[Pe]:[{[ge]:!0,[ie]:"sigv4-s3express",[me]:"s3express",[Ie]:"{Region}"}]},[L]:{}},[l]:I}],[l]:R}],[l]:R},{[p]:[{[C]:gn,[w]:[Z,!1]}],[k]:[{[I]:{[M]:mn,[F]:{[pt]:"S3Express",[Pe]:[{[ge]:!0,[ie]:"sigv4-s3express",[me]:"s3express",[Ie]:"{Region}"}]},[L]:{}},[l]:I}],[l]:R},{[_]:"S3Express bucket name is not a valid virtual hostable name.",[l]:_}],[l]:R},Ne={[C]:js,[w]:[{[$]:"Endpoint"}],[W]:"url"},Hn={[C]:oe,[w]:[{[C]:ne,[w]:[{[$]:"url"},"isIp"]},!0]},Fa={[$]:"url"},La={[C]:"uriEncode",[w]:[Z],[W]:"uri_encoded_bucket"},ft={[pt]:"S3Express",[Pe]:[{[ge]:!0,[ie]:"sigv4",[me]:"s3express",[Ie]:"{Region}"}]},z={},$a={[C]:gn,[w]:[Z,!1]},ri={[_]:"S3Express bucket name is not a valid virtual hostable name.",[l]:_},ii={[C]:Me,[w]:[{[$]:"UseS3ExpressControlEndpoint"}]},oi={[C]:oe,[w]:[{[$]:"UseS3ExpressControlEndpoint"},!0]},j={[C]:Ze,[w]:[re]},rn={[_]:"Unrecognized S3Express bucket name format.",[l]:_},ai={[C]:Ze,[w]:[Kt]},ci={[$]:Pa},ui={[p]:[j],[_]:"Expected a endpoint to be specified but no endpoint was found",[l]:_},on={[Pe]:[{[ge]:!0,[ie]:Ks,[me]:Gt,[zs]:["*"]},{[ge]:!0,[ie]:"sigv4",[me]:Gt,[Ie]:"{Region}"}]},zn={[C]:oe,[w]:[{[$]:"ForcePathStyle"},!1]},ep={[$]:"ForcePathStyle"},ae={[C]:oe,[w]:[{[$]:"Accelerate"},!1]},ue={[C]:J,[w]:[{[$]:"Region"},"aws-global"]},he={[Pe]:[{[ge]:!0,[ie]:"sigv4",[me]:Tt,[Ie]:"us-east-1"}]},X={[C]:Ze,[w]:[ue]},fe={[C]:oe,[w]:[{[$]:"UseGlobalEndpoint"},!0]},di={[M]:"https://{Bucket}.s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}",[F]:{[Pe]:[{[ge]:!0,[ie]:"sigv4",[me]:Tt,[Ie]:"{Region}"}]},[L]:{}},ce={[Pe]:[{[ge]:!0,[ie]:"sigv4",[me]:Tt,[Ie]:"{Region}"}]},pe={[C]:oe,[w]:[{[$]:"UseGlobalEndpoint"},!1]},G={[C]:oe,[w]:[{[$]:"UseDualStack"},!1]},li={[M]:"https://{Bucket}.s3-fips.{Region}.{partitionResult#dnsSuffix}",[F]:ce,[L]:{}},V={[C]:oe,[w]:[{[$]:"UseFIPS"},!1]},hi={[M]:"https://{Bucket}.s3-accelerate.dualstack.{partitionResult#dnsSuffix}",[F]:ce,[L]:{}},fi={[M]:"https://{Bucket}.s3.dualstack.{Region}.{partitionResult#dnsSuffix}",[F]:ce,[L]:{}},jn={[C]:oe,[w]:[{[C]:ne,[w]:[Fa,"isIp"]},!1]},Kn={[M]:Na,[F]:ce,[L]:{}},Ns={[M]:mn,[F]:ce,[L]:{}},pi={[I]:Ns,[l]:I},Wn={[M]:Ia,[F]:ce,[L]:{}},gi={[M]:"https://{Bucket}.s3.{Region}.{partitionResult#dnsSuffix}",[F]:ce,[L]:{}},an={[_]:"Invalid region: region was not a valid DNS name.",[l]:_},_e={[$]:Da},Ha={[$]:Ua},qn={[C]:ne,[w]:[_e,"service"]},Vs={[$]:qs},mi={[p]:[Q],[_]:"S3 Object Lambda does not support Dual-stack",[l]:_},yi={[p]:[He],[_]:"S3 Object Lambda does not support S3 Accelerate",[l]:_},xi={[p]:[{[C]:Me,[w]:[{[$]:"DisableAccessPoints"}]},{[C]:oe,[w]:[{[$]:"DisableAccessPoints"},!0]}],[_]:"Access points are not supported for this operation",[l]:_},Vn={[p]:[{[C]:Me,[w]:[{[$]:"UseArnRegion"}]},{[C]:oe,[w]:[{[$]:"UseArnRegion"},!1]},{[C]:Ze,[w]:[{[C]:J,[w]:[{[C]:ne,[w]:[_e,"region"]},"{Region}"]}]}],[_]:"Invalid configuration: region from ARN `{bucketArn#region}` does not match client region `{Region}` and UseArnRegion is `false`",[l]:_},za={[C]:ne,[w]:[{[$]:"bucketPartition"},ie]},ja={[C]:ne,[w]:[_e,"accountId"]},Gn={[Pe]:[{[ge]:!0,[ie]:"sigv4",[me]:Ws,[Ie]:"{bucketArn#region}"}]},bi={[_]:"Invalid ARN: The access point name may only contain a-z, A-Z, 0-9 and `-`. Found: `{accessPointName}`",[l]:_},Xn={[_]:"Invalid ARN: The account id may only contain a-z, A-Z, 0-9 and `-`. Found: `{bucketArn#accountId}`",[l]:_},Zn={[_]:"Invalid region in ARN: `{bucketArn#region}` (invalid DNS name)",[l]:_},Jn={[_]:"Client was configured for partition `{partitionResult#name}` but ARN (`{Bucket}`) has `{bucketPartition#name}`",[l]:_},Ei={[_]:"Invalid ARN: The ARN may only contain a single resource component after `accesspoint`.",[l]:_},Ci={[_]:"Invalid ARN: Expected a resource of the format `accesspoint:<accesspoint name>` but no name was provided",[l]:_},Mt={[Pe]:[{[ge]:!0,[ie]:"sigv4",[me]:Tt,[Ie]:"{bucketArn#region}"}]},wi={[Pe]:[{[ge]:!0,[ie]:Ks,[me]:Gt,[zs]:["*"]},{[ge]:!0,[ie]:"sigv4",[me]:Gt,[Ie]:"{bucketArn#region}"}]},Si={[C]:Ta,[w]:[Z]},Ai={[M]:"https://s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[F]:ce,[L]:{}},vi={[M]:"https://s3-fips.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[F]:ce,[L]:{}},ki={[M]:"https://s3.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[F]:ce,[L]:{}},Qn={[M]:_a,[F]:ce,[L]:{}},Ri={[M]:"https://s3.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[F]:ce,[L]:{}},Pi={[$]:"UseObjectLambdaEndpoint"},Yn={[Pe]:[{[ge]:!0,[ie]:"sigv4",[me]:Ws,[Ie]:"{Region}"}]},Bi={[M]:"https://s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}",[F]:ce,[L]:{}},Ni={[M]:"https://s3-fips.{Region}.{partitionResult#dnsSuffix}",[F]:ce,[L]:{}},Ii={[M]:"https://s3.dualstack.{Region}.{partitionResult#dnsSuffix}",[F]:ce,[L]:{}},es={[M]:dn,[F]:ce,[L]:{}},Ti={[M]:"https://s3.{Region}.{partitionResult#dnsSuffix}",[F]:ce,[L]:{}},ts=[{[$]:"Region"}],tp=[{[$]:"Endpoint"}],np=[Z],Di=[Q],ns=[He],vt=[re,Ne],Ui=[{[C]:Me,[w]:[{[$]:"DisableS3ExpressSessionAuth"}]},{[C]:oe,[w]:[{[$]:"DisableS3ExpressSessionAuth"},!0]}],sp=[La],Oi=[$a],$e=[Ma],kt=[te],_i=[{[C]:Y,[w]:[Z,6,14,!0],[W]:"s3expressAvailabilityZoneId"},{[C]:Y,[w]:[Z,14,16,!0],[W]:"s3expressAvailabilityZoneDelim"},{[C]:J,[w]:[{[$]:"s3expressAvailabilityZoneDelim"},"--"]}],Ve=[{[p]:[te],[I]:{[M]:"https://{Bucket}.s3express-fips-{s3expressAvailabilityZoneId}.{Region}.{partitionResult#dnsSuffix}",[F]:ft,[L]:{}},[l]:I},{[I]:{[M]:"https://{Bucket}.s3express-{s3expressAvailabilityZoneId}.{Region}.{partitionResult#dnsSuffix}",[F]:ft,[L]:{}},[l]:I}],Mi=[{[C]:Y,[w]:[Z,6,15,!0],[W]:"s3expressAvailabilityZoneId"},{[C]:Y,[w]:[Z,15,17,!0],[W]:"s3expressAvailabilityZoneDelim"},{[C]:J,[w]:[{[$]:"s3expressAvailabilityZoneDelim"},"--"]}],Fi=[{[C]:Y,[w]:[Z,6,19,!0],[W]:"s3expressAvailabilityZoneId"},{[C]:Y,[w]:[Z,19,21,!0],[W]:"s3expressAvailabilityZoneDelim"},{[C]:J,[w]:[{[$]:"s3expressAvailabilityZoneDelim"},"--"]}],Li=[{[C]:Y,[w]:[Z,6,20,!0],[W]:"s3expressAvailabilityZoneId"},{[C]:Y,[w]:[Z,20,22,!0],[W]:"s3expressAvailabilityZoneDelim"},{[C]:J,[w]:[{[$]:"s3expressAvailabilityZoneDelim"},"--"]}],$i=[{[C]:Y,[w]:[Z,6,26,!0],[W]:"s3expressAvailabilityZoneId"},{[C]:Y,[w]:[Z,26,28,!0],[W]:"s3expressAvailabilityZoneDelim"},{[C]:J,[w]:[{[$]:"s3expressAvailabilityZoneDelim"},"--"]}],Ge=[{[p]:[te],[I]:{[M]:"https://{Bucket}.s3express-fips-{s3expressAvailabilityZoneId}.{Region}.{partitionResult#dnsSuffix}",[F]:{[pt]:"S3Express",[Pe]:[{[ge]:!0,[ie]:"sigv4-s3express",[me]:"s3express",[Ie]:"{Region}"}]},[L]:{}},[l]:I},{[I]:{[M]:"https://{Bucket}.s3express-{s3expressAvailabilityZoneId}.{Region}.{partitionResult#dnsSuffix}",[F]:{[pt]:"S3Express",[Pe]:[{[ge]:!0,[ie]:"sigv4-s3express",[me]:"s3express",[Ie]:"{Region}"}]},[L]:{}},[l]:I}],Hi=[Z,0,7,!0],zi=[{[C]:Y,[w]:[Z,7,15,!0],[W]:"s3expressAvailabilityZoneId"},{[C]:Y,[w]:[Z,15,17,!0],[W]:"s3expressAvailabilityZoneDelim"},{[C]:J,[w]:[{[$]:"s3expressAvailabilityZoneDelim"},"--"]}],ji=[{[C]:Y,[w]:[Z,7,16,!0],[W]:"s3expressAvailabilityZoneId"},{[C]:Y,[w]:[Z,16,18,!0],[W]:"s3expressAvailabilityZoneDelim"},{[C]:J,[w]:[{[$]:"s3expressAvailabilityZoneDelim"},"--"]}],Ki=[{[C]:Y,[w]:[Z,7,20,!0],[W]:"s3expressAvailabilityZoneId"},{[C]:Y,[w]:[Z,20,22,!0],[W]:"s3expressAvailabilityZoneDelim"},{[C]:J,[w]:[{[$]:"s3expressAvailabilityZoneDelim"},"--"]}],Wi=[{[C]:Y,[w]:[Z,7,21,!0],[W]:"s3expressAvailabilityZoneId"},{[C]:Y,[w]:[Z,21,23,!0],[W]:"s3expressAvailabilityZoneDelim"},{[C]:J,[w]:[{[$]:"s3expressAvailabilityZoneDelim"},"--"]}],qi=[{[C]:Y,[w]:[Z,7,27,!0],[W]:"s3expressAvailabilityZoneId"},{[C]:Y,[w]:[Z,27,29,!0],[W]:"s3expressAvailabilityZoneDelim"},{[C]:J,[w]:[{[$]:"s3expressAvailabilityZoneDelim"},"--"]}],rp=[Kt],Vi=[{[C]:Ct,[w]:[{[$]:Bs},!1]}],Gi=[{[C]:J,[w]:[{[$]:Ba},"beta"]}],ip=["*"],Xi=[{[C]:Ct,[w]:[{[$]:"Region"},!1]}],tt=[{[C]:J,[w]:[{[$]:"Region"},"us-east-1"]}],ss=[{[C]:J,[w]:[Ha,Oa]}],Zi=[{[C]:ne,[w]:[_e,"resourceId[1]"],[W]:qs},{[C]:Ze,[w]:[{[C]:J,[w]:[Vs,yn]}]}],op=[_e,"resourceId[1]"],rs=[{[C]:Ze,[w]:[{[C]:J,[w]:[{[C]:ne,[w]:[_e,"region"]},yn]}]}],Ji=[{[C]:Ze,[w]:[{[C]:Me,[w]:[{[C]:ne,[w]:[_e,"resourceId[2]"]}]}]}],ap=[_e,"resourceId[2]"],is=[{[C]:pn,[w]:[{[C]:ne,[w]:[_e,"region"]}],[W]:"bucketPartition"}],Qi=[{[C]:J,[w]:[za,{[C]:ne,[w]:[{[$]:"partitionResult"},ie]}]}],os=[{[C]:Ct,[w]:[{[C]:ne,[w]:[_e,"region"]},!0]}],as=[{[C]:Ct,[w]:[ja,!1]}],Yi=[{[C]:Ct,[w]:[Vs,!1]}],eo=[{[C]:Ct,[w]:[{[$]:"Region"},!0]}],cp={parameters:{Bucket:St,Region:St,UseFIPS:At,UseDualStack:At,Endpoint:St,ForcePathStyle:At,Accelerate:At,UseGlobalEndpoint:At,UseObjectLambdaEndpoint:_t,Key:St,Prefix:St,CopySource:St,DisableAccessPoints:_t,DisableMultiRegionAccessPoints:At,UseArnRegion:_t,UseS3ExpressControlEndpoint:_t,DisableS3ExpressSessionAuth:_t},[k]:[{[p]:[{[C]:Me,[w]:ts}],[k]:[{[p]:[He,te],error:"Accelerate cannot be used with FIPS",[l]:_},{[p]:[Q,re],error:"Cannot set dual-stack in combination with a custom endpoint.",[l]:_},{[p]:[re,te],error:"A custom endpoint cannot be combined with FIPS",[l]:_},{[p]:[re,He],error:"A custom endpoint cannot be combined with S3 Accelerate",[l]:_},{[p]:[te,Ma,ei],error:"Partition does not support FIPS",[l]:_},{[p]:[Kt,{[C]:Y,[w]:[Z,0,Qf,qe],[W]:Kr},{[C]:J,[w]:[{[$]:Kr},"--x-s3"]}],[k]:[ti,ni,si,{[p]:[ii,oi],[k]:[{[p]:$e,[k]:[{[p]:[La,j],[k]:[{[p]:kt,endpoint:{[M]:"https://s3express-control-fips.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[F]:ft,[L]:z},[l]:I},{endpoint:{[M]:"https://s3express-control.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[F]:ft,[L]:z},[l]:I}],[l]:R}],[l]:R}],[l]:R},{[p]:Oi,[k]:[{[p]:$e,[k]:[{[p]:Ui,[k]:[{[p]:_i,[k]:Ve,[l]:R},{[p]:Mi,[k]:Ve,[l]:R},{[p]:Fi,[k]:Ve,[l]:R},{[p]:Li,[k]:Ve,[l]:R},{[p]:$i,[k]:Ve,[l]:R},rn],[l]:R},{[p]:_i,[k]:Ge,[l]:R},{[p]:Mi,[k]:Ge,[l]:R},{[p]:Fi,[k]:Ge,[l]:R},{[p]:Li,[k]:Ge,[l]:R},{[p]:$i,[k]:Ge,[l]:R},rn],[l]:R}],[l]:R},ri],[l]:R},{[p]:[Kt,{[C]:Y,[w]:Hi,[W]:Wr},{[C]:J,[w]:[{[$]:Wr},"--xa-s3"]}],[k]:[ti,ni,si,{[p]:Oi,[k]:[{[p]:$e,[k]:[{[p]:Ui,[k]:[{[p]:zi,[k]:Ve,[l]:R},{[p]:ji,[k]:Ve,[l]:R},{[p]:Ki,[k]:Ve,[l]:R},{[p]:Wi,[k]:Ve,[l]:R},{[p]:qi,[k]:Ve,[l]:R},rn],[l]:R},{[p]:zi,[k]:Ge,[l]:R},{[p]:ji,[k]:Ge,[l]:R},{[p]:Ki,[k]:Ge,[l]:R},{[p]:Wi,[k]:Ge,[l]:R},{[p]:qi,[k]:Ge,[l]:R},rn],[l]:R}],[l]:R},ri],[l]:R},{[p]:[ai,ii,oi],[k]:[{[p]:$e,[k]:[{[p]:vt,endpoint:{[M]:dn,[F]:ft,[L]:z},[l]:I},{[p]:kt,endpoint:{[M]:"https://s3express-control-fips.{Region}.{partitionResult#dnsSuffix}",[F]:ft,[L]:z},[l]:I},{endpoint:{[M]:"https://s3express-control.{Region}.{partitionResult#dnsSuffix}",[F]:ft,[L]:z},[l]:I}],[l]:R}],[l]:R},{[p]:[Kt,{[C]:Y,[w]:[Z,49,50,qe],[W]:Pa},{[C]:Y,[w]:[Z,8,12,qe],[W]:Ba},{[C]:Y,[w]:Hi,[W]:qr},{[C]:Y,[w]:[Z,32,49,qe],[W]:Bs},{[C]:pn,[w]:ts,[W]:"regionPartition"},{[C]:J,[w]:[{[$]:qr},"--op-s3"]}],[k]:[{[p]:Vi,[k]:[{[p]:[{[C]:J,[w]:[ci,"e"]}],[k]:[{[p]:Gi,[k]:[ui,{[p]:vt,endpoint:{[M]:"https://{Bucket}.ec2.{url#authority}",[F]:on,[L]:z},[l]:I}],[l]:R},{endpoint:{[M]:"https://{Bucket}.ec2.s3-outposts.{Region}.{regionPartition#dnsSuffix}",[F]:on,[L]:z},[l]:I}],[l]:R},{[p]:[{[C]:J,[w]:[ci,"o"]}],[k]:[{[p]:Gi,[k]:[ui,{[p]:vt,endpoint:{[M]:"https://{Bucket}.op-{outpostId}.{url#authority}",[F]:on,[L]:z},[l]:I}],[l]:R},{endpoint:{[M]:"https://{Bucket}.op-{outpostId}.s3-outposts.{Region}.{regionPartition#dnsSuffix}",[F]:on,[L]:z},[l]:I}],[l]:R},{error:'Unrecognized hardware type: "Expected hardware type o or e but got {hardwareType}"',[l]:_}],[l]:R},{error:"Invalid ARN: The outpost Id must only contain a-z, A-Z, 0-9 and `-`.",[l]:_}],[l]:R},{[p]:rp,[k]:[{[p]:[re,{[C]:Ze,[w]:[{[C]:Me,[w]:[{[C]:js,[w]:tp}]}]}],error:"Custom endpoint `{Endpoint}` was not a valid URI",[l]:_},{[p]:[zn,$a],[k]:[{[p]:$e,[k]:[{[p]:Xi,[k]:[{[p]:[He,ei],error:"S3 Accelerate cannot be used in this region",[l]:_},{[p]:[Q,te,ae,j,ue],endpoint:{[M]:"https://{Bucket}.s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}",[F]:he,[L]:z},[l]:I},{[p]:[Q,te,ae,j,X,fe],[k]:[{endpoint:di,[l]:I}],[l]:R},{[p]:[Q,te,ae,j,X,pe],endpoint:di,[l]:I},{[p]:[G,te,ae,j,ue],endpoint:{[M]:"https://{Bucket}.s3-fips.us-east-1.{partitionResult#dnsSuffix}",[F]:he,[L]:z},[l]:I},{[p]:[G,te,ae,j,X,fe],[k]:[{endpoint:li,[l]:I}],[l]:R},{[p]:[G,te,ae,j,X,pe],endpoint:li,[l]:I},{[p]:[Q,V,He,j,ue],endpoint:{[M]:"https://{Bucket}.s3-accelerate.dualstack.us-east-1.{partitionResult#dnsSuffix}",[F]:he,[L]:z},[l]:I},{[p]:[Q,V,He,j,X,fe],[k]:[{endpoint:hi,[l]:I}],[l]:R},{[p]:[Q,V,He,j,X,pe],endpoint:hi,[l]:I},{[p]:[Q,V,ae,j,ue],endpoint:{[M]:"https://{Bucket}.s3.dualstack.us-east-1.{partitionResult#dnsSuffix}",[F]:he,[L]:z},[l]:I},{[p]:[Q,V,ae,j,X,fe],[k]:[{endpoint:fi,[l]:I}],[l]:R},{[p]:[Q,V,ae,j,X,pe],endpoint:fi,[l]:I},{[p]:[G,V,ae,re,Ne,Hn,ue],endpoint:{[M]:Na,[F]:he,[L]:z},[l]:I},{[p]:[G,V,ae,re,Ne,jn,ue],endpoint:{[M]:mn,[F]:he,[L]:z},[l]:I},{[p]:[G,V,ae,re,Ne,Hn,X,fe],[k]:[{[p]:tt,endpoint:Kn,[l]:I},{endpoint:Kn,[l]:I}],[l]:R},{[p]:[G,V,ae,re,Ne,jn,X,fe],[k]:[{[p]:tt,endpoint:Ns,[l]:I},pi],[l]:R},{[p]:[G,V,ae,re,Ne,Hn,X,pe],endpoint:Kn,[l]:I},{[p]:[G,V,ae,re,Ne,jn,X,pe],endpoint:Ns,[l]:I},{[p]:[G,V,He,j,ue],endpoint:{[M]:Ia,[F]:he,[L]:z},[l]:I},{[p]:[G,V,He,j,X,fe],[k]:[{[p]:tt,endpoint:Wn,[l]:I},{endpoint:Wn,[l]:I}],[l]:R},{[p]:[G,V,He,j,X,pe],endpoint:Wn,[l]:I},{[p]:[G,V,ae,j,ue],endpoint:{[M]:Vr,[F]:he,[L]:z},[l]:I},{[p]:[G,V,ae,j,X,fe],[k]:[{[p]:tt,endpoint:{[M]:Vr,[F]:ce,[L]:z},[l]:I},{endpoint:gi,[l]:I}],[l]:R},{[p]:[G,V,ae,j,X,pe],endpoint:gi,[l]:I}],[l]:R},an],[l]:R}],[l]:R},{[p]:[re,Ne,{[C]:J,[w]:[{[C]:ne,[w]:[Fa,"scheme"]},"http"]},{[C]:gn,[w]:[Z,qe]},zn,V,G,ae],[k]:[{[p]:$e,[k]:[{[p]:Xi,[k]:[pi],[l]:R},an],[l]:R}],[l]:R},{[p]:[zn,{[C]:Ta,[w]:np,[W]:Da}],[k]:[{[p]:[{[C]:ne,[w]:[_e,"resourceId[0]"],[W]:Ua},{[C]:Ze,[w]:[{[C]:J,[w]:[Ha,yn]}]}],[k]:[{[p]:[{[C]:J,[w]:[qn,Ws]}],[k]:[{[p]:ss,[k]:[{[p]:Zi,[k]:[mi,yi,{[p]:rs,[k]:[xi,{[p]:Ji,[k]:[Vn,{[p]:is,[k]:[{[p]:$e,[k]:[{[p]:Qi,[k]:[{[p]:os,[k]:[{[p]:[{[C]:J,[w]:[ja,yn]}],error:"Invalid ARN: Missing account id",[l]:_},{[p]:as,[k]:[{[p]:Yi,[k]:[{[p]:vt,endpoint:{[M]:Gr,[F]:Gn,[L]:z},[l]:I},{[p]:kt,endpoint:{[M]:"https://{accessPointName}-{bucketArn#accountId}.s3-object-lambda-fips.{bucketArn#region}.{bucketPartition#dnsSuffix}",[F]:Gn,[L]:z},[l]:I},{endpoint:{[M]:"https://{accessPointName}-{bucketArn#accountId}.s3-object-lambda.{bucketArn#region}.{bucketPartition#dnsSuffix}",[F]:Gn,[L]:z},[l]:I}],[l]:R},bi],[l]:R},Xn],[l]:R},Zn],[l]:R},Jn],[l]:R}],[l]:R}],[l]:R},Ei],[l]:R},{error:"Invalid ARN: bucket ARN is missing a region",[l]:_}],[l]:R},Ci],[l]:R},{error:"Invalid ARN: Object Lambda ARNs only support `accesspoint` arn types, but found: `{arnType}`",[l]:_}],[l]:R},{[p]:ss,[k]:[{[p]:Zi,[k]:[{[p]:rs,[k]:[{[p]:ss,[k]:[{[p]:rs,[k]:[xi,{[p]:Ji,[k]:[Vn,{[p]:is,[k]:[{[p]:$e,[k]:[{[p]:[{[C]:J,[w]:[za,"{partitionResult#name}"]}],[k]:[{[p]:os,[k]:[{[p]:[{[C]:J,[w]:[qn,Tt]}],[k]:[{[p]:as,[k]:[{[p]:Yi,[k]:[{[p]:ns,error:"Access Points do not support S3 Accelerate",[l]:_},{[p]:[te,Q],endpoint:{[M]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint-fips.dualstack.{bucketArn#region}.{bucketPartition#dnsSuffix}",[F]:Mt,[L]:z},[l]:I},{[p]:[te,G],endpoint:{[M]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint-fips.{bucketArn#region}.{bucketPartition#dnsSuffix}",[F]:Mt,[L]:z},[l]:I},{[p]:[V,Q],endpoint:{[M]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint.dualstack.{bucketArn#region}.{bucketPartition#dnsSuffix}",[F]:Mt,[L]:z},[l]:I},{[p]:[V,G,re,Ne],endpoint:{[M]:Gr,[F]:Mt,[L]:z},[l]:I},{[p]:[V,G],endpoint:{[M]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint.{bucketArn#region}.{bucketPartition#dnsSuffix}",[F]:Mt,[L]:z},[l]:I}],[l]:R},bi],[l]:R},Xn],[l]:R},{error:"Invalid ARN: The ARN was not for the S3 service, found: {bucketArn#service}",[l]:_}],[l]:R},Zn],[l]:R},Jn],[l]:R}],[l]:R}],[l]:R},Ei],[l]:R}],[l]:R}],[l]:R},{[p]:[{[C]:Ct,[w]:[Vs,qe]}],[k]:[{[p]:Di,error:"S3 MRAP does not support dual-stack",[l]:_},{[p]:kt,error:"S3 MRAP does not support FIPS",[l]:_},{[p]:ns,error:"S3 MRAP does not support S3 Accelerate",[l]:_},{[p]:[{[C]:oe,[w]:[{[$]:"DisableMultiRegionAccessPoints"},qe]}],error:"Invalid configuration: Multi-Region Access Point ARNs are disabled.",[l]:_},{[p]:[{[C]:pn,[w]:ts,[W]:Xr}],[k]:[{[p]:[{[C]:J,[w]:[{[C]:ne,[w]:[{[$]:Xr},ie]},{[C]:ne,[w]:[_e,"partition"]}]}],[k]:[{endpoint:{[M]:"https://{accessPointName}.accesspoint.s3-global.{mrapPartition#dnsSuffix}",[F]:{[Pe]:[{[ge]:qe,name:Ks,[me]:Tt,[zs]:ip}]},[L]:z},[l]:I}],[l]:R},{error:"Client was configured for partition `{mrapPartition#name}` but bucket referred to partition `{bucketArn#partition}`",[l]:_}],[l]:R}],[l]:R},{error:"Invalid Access Point Name",[l]:_}],[l]:R},Ci],[l]:R},{[p]:[{[C]:J,[w]:[qn,Gt]}],[k]:[{[p]:Di,error:"S3 Outposts does not support Dual-stack",[l]:_},{[p]:kt,error:"S3 Outposts does not support FIPS",[l]:_},{[p]:ns,error:"S3 Outposts does not support S3 Accelerate",[l]:_},{[p]:[{[C]:Me,[w]:[{[C]:ne,[w]:[_e,"resourceId[4]"]}]}],error:"Invalid Arn: Outpost Access Point ARN contains sub resources",[l]:_},{[p]:[{[C]:ne,[w]:op,[W]:Bs}],[k]:[{[p]:Vi,[k]:[Vn,{[p]:is,[k]:[{[p]:$e,[k]:[{[p]:Qi,[k]:[{[p]:os,[k]:[{[p]:as,[k]:[{[p]:[{[C]:ne,[w]:ap,[W]:Zr}],[k]:[{[p]:[{[C]:ne,[w]:[_e,"resourceId[3]"],[W]:qs}],[k]:[{[p]:[{[C]:J,[w]:[{[$]:Zr},Oa]}],[k]:[{[p]:vt,endpoint:{[M]:"https://{accessPointName}-{bucketArn#accountId}.{outpostId}.{url#authority}",[F]:wi,[L]:z},[l]:I},{endpoint:{[M]:"https://{accessPointName}-{bucketArn#accountId}.{outpostId}.s3-outposts.{bucketArn#region}.{bucketPartition#dnsSuffix}",[F]:wi,[L]:z},[l]:I}],[l]:R},{error:"Expected an outpost type `accesspoint`, found {outpostType}",[l]:_}],[l]:R},{error:"Invalid ARN: expected an access point name",[l]:_}],[l]:R},{error:"Invalid ARN: Expected a 4-component resource",[l]:_}],[l]:R},Xn],[l]:R},Zn],[l]:R},Jn],[l]:R}],[l]:R}],[l]:R},{error:"Invalid ARN: The outpost Id may only contain a-z, A-Z, 0-9 and `-`. Found: `{outpostId}`",[l]:_}],[l]:R},{error:"Invalid ARN: The Outpost Id was not set",[l]:_}],[l]:R},{error:"Invalid ARN: Unrecognized format: {Bucket} (type: {arnType})",[l]:_}],[l]:R},{error:"Invalid ARN: No ARN type specified",[l]:_}],[l]:R},{[p]:[{[C]:Y,[w]:[Z,0,4,Yf],[W]:Jr},{[C]:J,[w]:[{[$]:Jr},"arn:"]},{[C]:Ze,[w]:[{[C]:Me,[w]:[Si]}]}],error:"Invalid ARN: `{Bucket}` was not a valid ARN",[l]:_},{[p]:[{[C]:oe,[w]:[ep,qe]},Si],error:"Path-style addressing cannot be used with ARN buckets",[l]:_},{[p]:sp,[k]:[{[p]:$e,[k]:[{[p]:[ae],[k]:[{[p]:[Q,j,te,ue],endpoint:{[M]:"https://s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[F]:he,[L]:z},[l]:I},{[p]:[Q,j,te,X,fe],[k]:[{endpoint:Ai,[l]:I}],[l]:R},{[p]:[Q,j,te,X,pe],endpoint:Ai,[l]:I},{[p]:[G,j,te,ue],endpoint:{[M]:"https://s3-fips.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[F]:he,[L]:z},[l]:I},{[p]:[G,j,te,X,fe],[k]:[{endpoint:vi,[l]:I}],[l]:R},{[p]:[G,j,te,X,pe],endpoint:vi,[l]:I},{[p]:[Q,j,V,ue],endpoint:{[M]:"https://s3.dualstack.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[F]:he,[L]:z},[l]:I},{[p]:[Q,j,V,X,fe],[k]:[{endpoint:ki,[l]:I}],[l]:R},{[p]:[Q,j,V,X,pe],endpoint:ki,[l]:I},{[p]:[G,re,Ne,V,ue],endpoint:{[M]:_a,[F]:he,[L]:z},[l]:I},{[p]:[G,re,Ne,V,X,fe],[k]:[{[p]:tt,endpoint:Qn,[l]:I},{endpoint:Qn,[l]:I}],[l]:R},{[p]:[G,re,Ne,V,X,pe],endpoint:Qn,[l]:I},{[p]:[G,j,V,ue],endpoint:{[M]:Qr,[F]:he,[L]:z},[l]:I},{[p]:[G,j,V,X,fe],[k]:[{[p]:tt,endpoint:{[M]:Qr,[F]:ce,[L]:z},[l]:I},{endpoint:Ri,[l]:I}],[l]:R},{[p]:[G,j,V,X,pe],endpoint:Ri,[l]:I}],[l]:R},{error:"Path-style addressing cannot be used with S3 Accelerate",[l]:_}],[l]:R}],[l]:R}],[l]:R},{[p]:[{[C]:Me,[w]:[Pi]},{[C]:oe,[w]:[Pi,qe]}],[k]:[{[p]:$e,[k]:[{[p]:eo,[k]:[mi,yi,{[p]:vt,endpoint:{[M]:dn,[F]:Yn,[L]:z},[l]:I},{[p]:kt,endpoint:{[M]:"https://s3-object-lambda-fips.{Region}.{partitionResult#dnsSuffix}",[F]:Yn,[L]:z},[l]:I},{endpoint:{[M]:"https://s3-object-lambda.{Region}.{partitionResult#dnsSuffix}",[F]:Yn,[L]:z},[l]:I}],[l]:R},an],[l]:R}],[l]:R},{[p]:[ai],[k]:[{[p]:$e,[k]:[{[p]:eo,[k]:[{[p]:[te,Q,j,ue],endpoint:{[M]:"https://s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}",[F]:he,[L]:z},[l]:I},{[p]:[te,Q,j,X,fe],[k]:[{endpoint:Bi,[l]:I}],[l]:R},{[p]:[te,Q,j,X,pe],endpoint:Bi,[l]:I},{[p]:[te,G,j,ue],endpoint:{[M]:"https://s3-fips.us-east-1.{partitionResult#dnsSuffix}",[F]:he,[L]:z},[l]:I},{[p]:[te,G,j,X,fe],[k]:[{endpoint:Ni,[l]:I}],[l]:R},{[p]:[te,G,j,X,pe],endpoint:Ni,[l]:I},{[p]:[V,Q,j,ue],endpoint:{[M]:"https://s3.dualstack.us-east-1.{partitionResult#dnsSuffix}",[F]:he,[L]:z},[l]:I},{[p]:[V,Q,j,X,fe],[k]:[{endpoint:Ii,[l]:I}],[l]:R},{[p]:[V,Q,j,X,pe],endpoint:Ii,[l]:I},{[p]:[V,G,re,Ne,ue],endpoint:{[M]:dn,[F]:he,[L]:z},[l]:I},{[p]:[V,G,re,Ne,X,fe],[k]:[{[p]:tt,endpoint:es,[l]:I},{endpoint:es,[l]:I}],[l]:R},{[p]:[V,G,re,Ne,X,pe],endpoint:es,[l]:I},{[p]:[V,G,j,ue],endpoint:{[M]:Yr,[F]:he,[L]:z},[l]:I},{[p]:[V,G,j,X,fe],[k]:[{[p]:tt,endpoint:{[M]:Yr,[F]:ce,[L]:z},[l]:I},{endpoint:Ti,[l]:I}],[l]:R},{[p]:[V,G,j,X,pe],endpoint:Ti,[l]:I}],[l]:R},an],[l]:R}],[l]:R}],[l]:R},{error:"A region must be set when sending requests to S3.",[l]:_}]},up=cp,dp=new mc({size:50,params:["Accelerate","Bucket","DisableAccessPoints","DisableMultiRegionAccessPoints","DisableS3ExpressSessionAuth","Endpoint","ForcePathStyle","Region","UseArnRegion","UseDualStack","UseFIPS","UseGlobalEndpoint","UseObjectLambdaEndpoint","UseS3ExpressControlEndpoint"]}),Ka=(t,e={})=>dp.get(t,()=>yc(up,{endpointParams:t,logger:e.logger}));bc.aws=xc;const lp=t=>async(e,n,s)=>{if(!s)throw new Error("Could not find `input` for `defaultEndpointRuleSetHttpAuthSchemeParametersProvider`");const r=await t(e,n,s),o=Is(n)?.commandInstance?.constructor?.getEndpointParameterInstructions;if(!o)throw new Error(`getEndpointParameterInstructions() is not defined on \`${n.commandName}\``);const i=await Cc(s,{getEndpointParameterInstructions:o},e);return Object.assign(r,i)},hp=async(t,e,n)=>({operation:Is(e).operation,region:await gs(t.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()}),fp=lp(hp);function Wa(t){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"s3",region:t.region},propertiesExtractor:(e,n)=>({signingProperties:{config:e,context:n}})}}function qa(t){return{schemeId:"aws.auth#sigv4a",signingProperties:{name:"s3",region:t.region},propertiesExtractor:(e,n)=>({signingProperties:{config:e,context:n}})}}const pp=(t,e,n)=>r=>{const i=t(r).properties?.authSchemes;if(!i)return e(r);const a=[];for(const d of i){const{name:c,properties:u={},...f}=d,h=c.toLowerCase();c!==h&&console.warn(`HttpAuthScheme has been normalized with lowercasing: \`${c}\` to \`${h}\``);let y;if(h==="sigv4a"){if(y="aws.auth#sigv4a",i.find(g=>{const x=g.name.toLowerCase();return x!=="sigv4a"&&x.startsWith("sigv4")}))continue}else if(h.startsWith("sigv4"))y="aws.auth#sigv4";else throw new Error(`Unknown HttpAuthScheme found in \`@smithy.rules#endpointRuleSet\`: \`${h}\``);const S=n[y];if(!S)throw new Error(`Could not find HttpAuthOption create function for \`${y}\``);const B=S(r);B.schemeId=y,B.signingProperties={...B.signingProperties||{},...f,...u},a.push(B)}return a},gp=t=>{const e=[];switch(t.operation){default:e.push(Wa(t)),e.push(qa(t))}return e},mp=pp(Ka,gp,{"aws.auth#sigv4":Wa,"aws.auth#sigv4a":qa}),yp=t=>{const e=Ec(t),n=Bh(e);return Object.assign(n,{})},xp=t=>Object.assign(t,{useFipsEndpoint:t.useFipsEndpoint??!1,useDualstackEndpoint:t.useDualstackEndpoint??!1,forcePathStyle:t.forcePathStyle??!1,useAccelerateEndpoint:t.useAccelerateEndpoint??!1,useGlobalEndpoint:t.useGlobalEndpoint??!1,disableMultiregionAccessPoints:t.disableMultiregionAccessPoints??!1,defaultSigningName:"s3"}),Va={ForcePathStyle:{type:"clientContextParams",name:"forcePathStyle"},UseArnRegion:{type:"clientContextParams",name:"useArnRegion"},DisableMultiRegionAccessPoints:{type:"clientContextParams",name:"disableMultiregionAccessPoints"},Accelerate:{type:"clientContextParams",name:"useAccelerateEndpoint"},DisableS3ExpressSessionAuth:{type:"clientContextParams",name:"disableS3ExpressSessionAuth"},UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}};class Be extends wc{constructor(e){super(e),Object.setPrototypeOf(this,Be.prototype)}}class Gs extends Be{name="NoSuchUpload";$fault="client";constructor(e){super({name:"NoSuchUpload",$fault:"client",...e}),Object.setPrototypeOf(this,Gs.prototype)}}class Xs extends Be{name="ObjectNotInActiveTierError";$fault="client";constructor(e){super({name:"ObjectNotInActiveTierError",$fault:"client",...e}),Object.setPrototypeOf(this,Xs.prototype)}}class Zs extends Be{name="BucketAlreadyExists";$fault="client";constructor(e){super({name:"BucketAlreadyExists",$fault:"client",...e}),Object.setPrototypeOf(this,Zs.prototype)}}class Js extends Be{name="BucketAlreadyOwnedByYou";$fault="client";constructor(e){super({name:"BucketAlreadyOwnedByYou",$fault:"client",...e}),Object.setPrototypeOf(this,Js.prototype)}}class Qs extends Be{name="NoSuchBucket";$fault="client";constructor(e){super({name:"NoSuchBucket",$fault:"client",...e}),Object.setPrototypeOf(this,Qs.prototype)}}var to;(function(t){t.visit=(e,n)=>e.Prefix!==void 0?n.Prefix(e.Prefix):e.Tag!==void 0?n.Tag(e.Tag):e.And!==void 0?n.And(e.And):n._(e.$unknown[0],e.$unknown[1])})(to||(to={}));var no;(function(t){t.visit=(e,n)=>e.Prefix!==void 0?n.Prefix(e.Prefix):e.Tag!==void 0?n.Tag(e.Tag):e.AccessPointArn!==void 0?n.AccessPointArn(e.AccessPointArn):e.And!==void 0?n.And(e.And):n._(e.$unknown[0],e.$unknown[1])})(no||(no={}));class Ys extends Be{name="InvalidObjectState";$fault="client";StorageClass;AccessTier;constructor(e){super({name:"InvalidObjectState",$fault:"client",...e}),Object.setPrototypeOf(this,Ys.prototype),this.StorageClass=e.StorageClass,this.AccessTier=e.AccessTier}}class er extends Be{name="NoSuchKey";$fault="client";constructor(e){super({name:"NoSuchKey",$fault:"client",...e}),Object.setPrototypeOf(this,er.prototype)}}class tr extends Be{name="NotFound";$fault="client";constructor(e){super({name:"NotFound",$fault:"client",...e}),Object.setPrototypeOf(this,tr.prototype)}}const bp=t=>({...t,...t.SecretAccessKey&&{SecretAccessKey:it},...t.SessionToken&&{SessionToken:it}}),Ep=t=>({...t,...t.SSEKMSKeyId&&{SSEKMSKeyId:it},...t.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:it},...t.Credentials&&{Credentials:bp(t.Credentials)}}),Cp=t=>({...t,...t.SSEKMSKeyId&&{SSEKMSKeyId:it},...t.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:it}}),wp=t=>({...t,...t.SSEKMSKeyId&&{SSEKMSKeyId:it}}),Sp=t=>({...t,...t.SSECustomerKey&&{SSECustomerKey:it}});class nr extends Be{name="EncryptionTypeMismatch";$fault="client";constructor(e){super({name:"EncryptionTypeMismatch",$fault:"client",...e}),Object.setPrototypeOf(this,nr.prototype)}}class sr extends Be{name="InvalidRequest";$fault="client";constructor(e){super({name:"InvalidRequest",$fault:"client",...e}),Object.setPrototypeOf(this,sr.prototype)}}class rr extends Be{name="InvalidWriteOffset";$fault="client";constructor(e){super({name:"InvalidWriteOffset",$fault:"client",...e}),Object.setPrototypeOf(this,rr.prototype)}}class ir extends Be{name="TooManyParts";$fault="client";constructor(e){super({name:"TooManyParts",$fault:"client",...e}),Object.setPrototypeOf(this,ir.prototype)}}class or extends Be{name="ObjectAlreadyInActiveTierError";$fault="client";constructor(e){super({name:"ObjectAlreadyInActiveTierError",$fault:"client",...e}),Object.setPrototypeOf(this,or.prototype)}}var so;(function(t){t.visit=(e,n)=>e.Records!==void 0?n.Records(e.Records):e.Stats!==void 0?n.Stats(e.Stats):e.Progress!==void 0?n.Progress(e.Progress):e.Cont!==void 0?n.Cont(e.Cont):e.End!==void 0?n.End(e.End):n._(e.$unknown[0],e.$unknown[1])})(so||(so={}));const Ap=async(t,e)=>{const n=zo(t,e),s=de({},jt,{[c0]:t[Bg],[ur]:t[ar],[dr]:t[cr],[Ya]:t[Ja],[Xt]:[()=>jt(t[xn]),()=>t[xn].toString()]});n.bp("/"),n.p("Bucket",()=>t.Bucket,"{Bucket}",!1);const r=de({[e0]:[,""]});return n.m("GET").h(s).q(r).b(void 0),n.build()},vp=async(t,e)=>{const n=zo(t,e),s=de({},jt,{[zg]:t[ug],[jg]:[()=>jt(t[ro]),()=>An(t[ro]).toString()],[Kg]:t[dg],[Wg]:[()=>jt(t[io]),()=>An(t[io]).toString()],[Vg]:t[xg],[ec]:t[Xa],[b0]:t[Ng],[tc]:t[Za],[m0]:t[kg],[l0]:t[og],[i0]:t[Qp]});n.bp("/{Key+}"),n.p("Bucket",()=>t.Bucket,"{Bucket}",!1),n.p("Key",()=>t.Key,"{Key+}",!0);const r=de({[w0]:[,"GetObject"],[Gg]:[,t[Eg]],[Xg]:[,t[Cg]],[Zg]:[,t[wg]],[Jg]:[,t[Sg]],[Qg]:[,t[Ag]],[Yg]:[()=>t.ResponseExpires!==void 0,()=>An(t[vg]).toString()],[t0]:[,t[Qa]],[qg]:[()=>t.PartNumber!==void 0,()=>t[yg].toString()]});return n.m("GET").h(s).q(r).b(void 0),n.build()},kp=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return Ga(t,e);const n=de({$metadata:De(t),[ar]:[,t.headers[ur]],[cr]:[,t.headers[dr]],[Ja]:[,t.headers[Ya]],[xn]:[()=>t.headers[Xt]!==void 0,()=>ms(t.headers[Xt])]}),s=Ht(Ac(await wa(t.body,e)),"body");return s[ds]!=null&&(n[ds]=zp(s[ds])),n},Rp=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return Ga(t,e);const n=de({$metadata:De(t),[rg]:[()=>t.headers[uo]!==void 0,()=>ms(t.headers[uo])],[jp]:[,t.headers[Dg]],[ln]:[,t.headers[d0]],[Pg]:[,t.headers[p0]],[lg]:[()=>t.headers[co]!==void 0,()=>Ht(ys(t.headers[co]))],[Jp]:[()=>t.headers[oo]!==void 0,()=>vc(t.headers[oo])],[cg]:[,t.headers[$g]],[Wp]:[,t.headers[n0]],[qp]:[,t.headers[s0]],[Vp]:[,t.headers[r0]],[eg]:[,t.headers[o0]],[tg]:[,t.headers[a0]],[ng]:[,t.headers[u0]],[hg]:[()=>t.headers[lo]!==void 0,()=>Sn(t.headers[lo])],[Qa]:[,t.headers[E0]],[Kp]:[,t.headers[Ug]],[Gp]:[,t.headers[Og]],[Xp]:[,t.headers[_g]],[Zp]:[,t.headers[Mg]],[Yp]:[,t.headers[Fg]],[sg]:[,t.headers[Lg]],[ig]:[()=>t.headers[ao]!==void 0,()=>Ht(ys(t.headers[ao]))],[ag]:[,t.headers[Hg]],[Tg]:[,t.headers[C0]],[ar]:[,t.headers[ur]],[Xa]:[,t.headers[ec]],[Za]:[,t.headers[tc]],[cr]:[,t.headers[dr]],[xn]:[()=>t.headers[Xt]!==void 0,()=>ms(t.headers[Xt])],[hn]:[,t.headers[x0]],[bg]:[,t.headers[g0]],[Rg]:[,t.headers[y0]],[mg]:[()=>t.headers[ho]!==void 0,()=>Sn(t.headers[ho])],[Ig]:[()=>t.headers[po]!==void 0,()=>Sn(t.headers[po])],[pg]:[,t.headers[f0]],[gg]:[()=>t.headers[fo]!==void 0,()=>Ht(jo(t.headers[fo]))],[fg]:[,t.headers[h0]],Metadata:[,Object.keys(t.headers).filter(r=>r.startsWith("x-amz-meta-")).reduce((r,o)=>(r[o.substring(11)]=t.headers[o],r),{})]}),s=t.body;return e.sdkStreamMixin(s),n.Body=s,n},Ga=async(t,e)=>{const n={...t,body:await Hh(t.body,e)},s=zh(t,n.body);switch(s){case"NoSuchUpload":case"com.amazonaws.s3#NoSuchUpload":throw await Mp(n);case"ObjectNotInActiveTierError":case"com.amazonaws.s3#ObjectNotInActiveTierError":throw await $p(n);case"BucketAlreadyExists":case"com.amazonaws.s3#BucketAlreadyExists":throw await Bp(n);case"BucketAlreadyOwnedByYou":case"com.amazonaws.s3#BucketAlreadyOwnedByYou":throw await Np(n);case"NoSuchBucket":case"com.amazonaws.s3#NoSuchBucket":throw await Op(n);case"InvalidObjectState":case"com.amazonaws.s3#InvalidObjectState":throw await Tp(n);case"NoSuchKey":case"com.amazonaws.s3#NoSuchKey":throw await _p(n);case"NotFound":case"com.amazonaws.s3#NotFound":throw await Fp(n);case"EncryptionTypeMismatch":case"com.amazonaws.s3#EncryptionTypeMismatch":throw await Ip(n);case"InvalidRequest":case"com.amazonaws.s3#InvalidRequest":throw await Dp(n);case"InvalidWriteOffset":case"com.amazonaws.s3#InvalidWriteOffset":throw await Up(n);case"TooManyParts":case"com.amazonaws.s3#TooManyParts":throw await Hp(n);case"ObjectAlreadyInActiveTierError":case"com.amazonaws.s3#ObjectAlreadyInActiveTierError":throw await Lp(n);default:const r=n.body;return Pp({output:t,parsedBody:r,errorCode:s})}},Pp=Sc(Be),Bp=async(t,e)=>{const n=de({});t.body;const s=new Zs({$metadata:De(t),...n});return Le(s,t.body)},Np=async(t,e)=>{const n=de({});t.body;const s=new Js({$metadata:De(t),...n});return Le(s,t.body)},Ip=async(t,e)=>{const n=de({});t.body;const s=new nr({$metadata:De(t),...n});return Le(s,t.body)},Tp=async(t,e)=>{const n=de({}),s=t.body;s[us]!=null&&(n[us]=$t(s[us])),s[hn]!=null&&(n[hn]=$t(s[hn]));const r=new Ys({$metadata:De(t),...n});return Le(r,t.body)},Dp=async(t,e)=>{const n=de({});t.body;const s=new sr({$metadata:De(t),...n});return Le(s,t.body)},Up=async(t,e)=>{const n=de({});t.body;const s=new rr({$metadata:De(t),...n});return Le(s,t.body)},Op=async(t,e)=>{const n=de({});t.body;const s=new Qs({$metadata:De(t),...n});return Le(s,t.body)},_p=async(t,e)=>{const n=de({});t.body;const s=new er({$metadata:De(t),...n});return Le(s,t.body)},Mp=async(t,e)=>{const n=de({});t.body;const s=new Gs({$metadata:De(t),...n});return Le(s,t.body)},Fp=async(t,e)=>{const n=de({});t.body;const s=new tr({$metadata:De(t),...n});return Le(s,t.body)},Lp=async(t,e)=>{const n=de({});t.body;const s=new or({$metadata:De(t),...n});return Le(s,t.body)},$p=async(t,e)=>{const n=de({});t.body;const s=new Xs({$metadata:De(t),...n});return Le(s,t.body)},Hp=async(t,e)=>{const n=de({});t.body;const s=new ir({$metadata:De(t),...n});return Le(s,t.body)},zp=(t,e)=>{const n={};return t[cs]!=null&&(n[cs]=$t(t[cs])),t[ls]!=null&&(n[ls]=$t(t[ls])),t[hs]!=null&&(n[hs]=$t(t[hs])),t[ln]!=null&&(n[ln]=Ht(jo(t[ln]))),n},De=t=>({httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}),cs="AccessKeyId",jp="AcceptRanges",us="AccessTier",xn="BucketKeyEnabled",ds="Credentials",Kp="CacheControl",Wp="ChecksumCRC32",qp="ChecksumCRC32C",Vp="ChecksumCRC64NVME",Gp="ContentDisposition",Xp="ContentEncoding",Zp="ContentLanguage",Jp="ContentLength",Qp="ChecksumMode",Yp="ContentRange",eg="ChecksumSHA1",tg="ChecksumSHA256",ng="ChecksumType",sg="ContentType",rg="DeleteMarker",ig="Expires",og="ExpectedBucketOwner",ag="ExpiresString",cg="ETag",ln="Expiration",ug="IfMatch",ro="IfModifiedSince",dg="IfNoneMatch",io="IfUnmodifiedSince",lg="LastModified",hg="MissingMeta",fg="ObjectLockLegalHoldStatus",pg="ObjectLockMode",gg="ObjectLockRetainUntilDate",mg="PartsCount",yg="PartNumber",xg="Range",bg="RequestCharged",Eg="ResponseCacheControl",Cg="ResponseContentDisposition",wg="ResponseContentEncoding",Sg="ResponseContentLanguage",Ag="ResponseContentType",vg="ResponseExpires",kg="RequestPayer",Rg="ReplicationStatus",Pg="Restore",ls="SecretAccessKey",hn="StorageClass",Bg="SessionMode",ar="ServerSideEncryption",Xa="SSECustomerAlgorithm",Ng="SSECustomerKey",Za="SSECustomerKeyMD5",Ja="SSEKMSEncryptionContext",cr="SSEKMSKeyId",hs="SessionToken",Ig="TagCount",Qa="VersionId",Tg="WebsiteRedirectLocation",Dg="accept-ranges",Ug="cache-control",Og="content-disposition",_g="content-encoding",Mg="content-language",oo="content-length",Fg="content-range",Lg="content-type",ao="expires",$g="etag",Hg="expiresstring",zg="if-match",jg="if-modified-since",Kg="if-none-match",Wg="if-unmodified-since",co="last-modified",qg="partNumber",Vg="range",Gg="response-cache-control",Xg="response-content-disposition",Zg="response-content-encoding",Jg="response-content-language",Qg="response-content-type",Yg="response-expires",e0="session",t0="versionId",n0="x-amz-checksum-crc32",s0="x-amz-checksum-crc32c",r0="x-amz-checksum-crc64nvme",i0="x-amz-checksum-mode",o0="x-amz-checksum-sha1",a0="x-amz-checksum-sha256",c0="x-amz-create-session-mode",u0="x-amz-checksum-type",uo="x-amz-delete-marker",d0="x-amz-expiration",l0="x-amz-expected-bucket-owner",lo="x-amz-missing-meta",ho="x-amz-mp-parts-count",h0="x-amz-object-lock-legal-hold",f0="x-amz-object-lock-mode",fo="x-amz-object-lock-retain-until-date",p0="x-amz-restore",g0="x-amz-request-charged",m0="x-amz-request-payer",y0="x-amz-replication-status",x0="x-amz-storage-class",ur="x-amz-server-side-encryption",dr="x-amz-server-side-encryption-aws-kms-key-id",Xt="x-amz-server-side-encryption-bucket-key-enabled",Ya="x-amz-server-side-encryption-context",ec="x-amz-server-side-encryption-customer-algorithm",b0="x-amz-server-side-encryption-customer-key",tc="x-amz-server-side-encryption-customer-key-md5",po="x-amz-tagging-count",E0="x-amz-version-id",C0="x-amz-website-redirect-location",w0="x-id";class S0 extends Ro.classBuilder().ep({...Va,DisableS3ExpressSessionAuth:{type:"staticContextParams",value:!0},Bucket:{type:"contextParams",name:"Bucket"}}).m(function(e,n,s,r){return[Po(s,this.serialize,this.deserialize),Bo(s,e.getEndpointParameterInstructions()),jf(s)]}).s("AmazonS3","CreateSession",{}).n("S3Client","CreateSessionCommand").f(Cp,Ep).ser(Ap).de(kp).build(){}const A0="3.782.0",v0={version:A0},k0=t=>new TextEncoder().encode(t);function go(t){return typeof t=="string"?t.length===0:t.byteLength===0}var nc={name:"SHA-1"},mo={name:"HMAC",hash:nc},R0=new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]),P0=function(){function t(e){this.toHash=new Uint8Array(0),e!==void 0&&(this.key=new Promise(function(n,s){un().crypto.subtle.importKey("raw",yo(e),mo,!1,["sign"]).then(n,s)}),this.key.catch(function(){}))}return t.prototype.update=function(e){if(!go(e)){var n=yo(e),s=new Uint8Array(this.toHash.byteLength+n.byteLength);s.set(this.toHash,0),s.set(n,this.toHash.byteLength),this.toHash=s}},t.prototype.digest=function(){var e=this;return this.key?this.key.then(function(n){return un().crypto.subtle.sign(mo,n,e.toHash).then(function(s){return new Uint8Array(s)})}):go(this.toHash)?Promise.resolve(R0):Promise.resolve().then(function(){return un().crypto.subtle.digest(nc,e.toHash)}).then(function(n){return Promise.resolve(new Uint8Array(n))})},t.prototype.reset=function(){this.toHash=new Uint8Array(0)},t}();function yo(t){return typeof t=="string"?k0(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}var B0=function(){function t(e){if(kc(un()))this.hash=new P0(e);else throw new Error("SHA1 not supported")}return t.prototype.update=function(e,n){this.hash.update(Ds(e))},t.prototype.digest=function(){return this.hash.digest()},t.prototype.reset=function(){this.hash.reset()},t}();class Wt{constructor(e){if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const n=new Uint8Array(8);for(let s=7,r=Math.abs(Math.round(e));s>-1&&r>0;s--,r/=256)n[s]=r;return e<0&&xo(n),new Wt(n)}valueOf(){const e=this.bytes.slice(0),n=e[0]&128;return n&&xo(e),parseInt(Pt(e),16)*(n?-1:1)}toString(){return String(this.valueOf())}}function xo(t){for(let e=0;e<8;e++)t[e]^=255;for(let e=7;e>-1&&(t[e]++,t[e]===0);e--);}class N0{constructor(e,n){this.toUtf8=e,this.fromUtf8=n}format(e){const n=[];for(const o of Object.keys(e)){const i=this.fromUtf8(o);n.push(Uint8Array.from([i.byteLength]),i,this.formatHeaderValue(e[o]))}const s=new Uint8Array(n.reduce((o,i)=>o+i.byteLength,0));let r=0;for(const o of n)s.set(o,r),r+=o.byteLength;return s}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const n=new DataView(new ArrayBuffer(3));return n.setUint8(0,3),n.setInt16(1,e.value,!1),new Uint8Array(n.buffer);case"integer":const s=new DataView(new ArrayBuffer(5));return s.setUint8(0,4),s.setInt32(1,e.value,!1),new Uint8Array(s.buffer);case"long":const r=new Uint8Array(9);return r[0]=5,r.set(e.value.bytes,1),r;case"binary":const o=new DataView(new ArrayBuffer(3+e.value.byteLength));o.setUint8(0,6),o.setUint16(1,e.value.byteLength,!1);const i=new Uint8Array(o.buffer);return i.set(e.value,3),i;case"string":const a=this.fromUtf8(e.value),d=new DataView(new ArrayBuffer(3+a.byteLength));d.setUint8(0,7),d.setUint16(1,a.byteLength,!1);const c=new Uint8Array(d.buffer);return c.set(a,3),c;case"timestamp":const u=new Uint8Array(9);return u[0]=8,u.set(Wt.fromNumber(e.value.valueOf()).bytes,1),u;case"uuid":if(!L0.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const f=new Uint8Array(17);return f[0]=9,f.set(Rc(e.value.replace(/\-/g,"")),1),f}}parse(e){const n={};let s=0;for(;s<e.byteLength;){const r=e.getUint8(s++),o=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+s,r));switch(s+=r,e.getUint8(s++)){case 0:n[o]={type:Eo,value:!0};break;case 1:n[o]={type:Eo,value:!1};break;case 2:n[o]={type:I0,value:e.getInt8(s++)};break;case 3:n[o]={type:T0,value:e.getInt16(s,!1)},s+=2;break;case 4:n[o]={type:D0,value:e.getInt32(s,!1)},s+=4;break;case 5:n[o]={type:U0,value:new Wt(new Uint8Array(e.buffer,e.byteOffset+s,8))},s+=8;break;case 6:const i=e.getUint16(s,!1);s+=2,n[o]={type:O0,value:new Uint8Array(e.buffer,e.byteOffset+s,i)},s+=i;break;case 7:const a=e.getUint16(s,!1);s+=2,n[o]={type:_0,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+s,a))},s+=a;break;case 8:n[o]={type:M0,value:new Date(new Wt(new Uint8Array(e.buffer,e.byteOffset+s,8)).valueOf())},s+=8;break;case 9:const d=new Uint8Array(e.buffer,e.byteOffset+s,16);s+=16,n[o]={type:F0,value:`${Pt(d.subarray(0,4))}-${Pt(d.subarray(4,6))}-${Pt(d.subarray(6,8))}-${Pt(d.subarray(8,10))}-${Pt(d.subarray(10))}`};break;default:throw new Error("Unrecognized header type tag")}}return n}}var bo;(function(t){t[t.boolTrue=0]="boolTrue",t[t.boolFalse=1]="boolFalse",t[t.byte=2]="byte",t[t.short=3]="short",t[t.integer=4]="integer",t[t.long=5]="long",t[t.byteArray=6]="byteArray",t[t.string=7]="string",t[t.timestamp=8]="timestamp",t[t.uuid=9]="uuid"})(bo||(bo={}));const Eo="boolean",I0="byte",T0="short",D0="integer",U0="long",O0="binary",_0="string",M0="timestamp",F0="uuid",L0=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,sc=4,st=sc*2,ht=4,$0=st+ht*2;function H0({byteLength:t,byteOffset:e,buffer:n}){if(t<$0)throw new Error("Provided message too short to accommodate event stream message overhead");const s=new DataView(n,e,t),r=s.getUint32(0,!1);if(t!==r)throw new Error("Reported message length does not match received message length");const o=s.getUint32(sc,!1),i=s.getUint32(st,!1),a=s.getUint32(t-ht,!1),d=new fn().update(new Uint8Array(n,e,st));if(i!==d.digest())throw new Error(`The prelude checksum specified in the message (${i}) does not match the calculated CRC32 checksum (${d.digest()})`);if(d.update(new Uint8Array(n,e+st,t-(st+ht))),a!==d.digest())throw new Error(`The message checksum (${d.digest()}) did not match the expected value of ${a}`);return{headers:new DataView(n,e+st+ht,o),body:new Uint8Array(n,e+st+ht+o,r-o-(st+ht+ht))}}class z0{constructor(e,n){this.headerMarshaller=new N0(e,n),this.messageBuffer=[],this.isEndOfStream=!1}feed(e){this.messageBuffer.push(this.decode(e))}endOfStream(){this.isEndOfStream=!0}getMessage(){const e=this.messageBuffer.pop(),n=this.isEndOfStream;return{getMessage(){return e},isEndOfStream(){return n}}}getAvailableMessages(){const e=this.messageBuffer;this.messageBuffer=[];const n=this.isEndOfStream;return{getMessages(){return e},isEndOfStream(){return n}}}encode({headers:e,body:n}){const s=this.headerMarshaller.format(e),r=s.byteLength+n.byteLength+16,o=new Uint8Array(r),i=new DataView(o.buffer,o.byteOffset,o.byteLength),a=new fn;return i.setUint32(0,r,!1),i.setUint32(4,s.byteLength,!1),i.setUint32(8,a.update(o.subarray(0,8)).digest(),!1),o.set(s,12),o.set(n,s.byteLength+12),i.setUint32(r-4,a.update(o.subarray(8,r-4)).digest(),!1),o}decode(e){const{headers:n,body:s}=H0(e);return{headers:this.headerMarshaller.parse(n),body:s}}formatHeaders(e){return this.headerMarshaller.format(e)}}class j0{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream)yield this.options.decoder.decode(e)}}class K0{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream)yield this.options.encoder.encode(e);this.options.includeEndFrame&&(yield new Uint8Array(0))}}class W0{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream){const n=await this.options.deserializer(e);n!==void 0&&(yield n)}}}class q0{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream)yield this.options.serializer(e)}}function V0(t){let e=0,n=0,s=null,r=null;const o=a=>{if(typeof a!="number")throw new Error("Attempted to allocate an event message where size was not a number: "+a);e=a,n=4,s=new Uint8Array(a),new DataView(s.buffer).setUint32(0,a,!1)},i=async function*(){const a=t[Symbol.asyncIterator]();for(;;){const{value:d,done:c}=await a.next();if(c){if(e)if(e===n)yield s;else throw new Error("Truncated event message received.");else return;return}const u=d.length;let f=0;for(;f<u;){if(!s){const y=u-f;r||(r=new Uint8Array(4));const S=Math.min(4-n,y);if(r.set(d.slice(f,f+S),n),n+=S,f+=S,n<4)break;o(new DataView(r.buffer).getUint32(0,!1)),r=null}const h=Math.min(e-n,u-f);s.set(d.slice(f,f+h),n),n+=h,f+=h,e&&e===n&&(yield s,s=null,e=0,n=0)}}};return{[Symbol.asyncIterator]:i}}function G0(t,e){return async function(n){const{value:s}=n.headers[":message-type"];if(s==="error"){const r=new Error(n.headers[":error-message"].value||"UnknownError");throw r.name=n.headers[":error-code"].value,r}else if(s==="exception"){const r=n.headers[":exception-type"].value,o={[r]:n},i=await t(o);if(i.$unknown){const a=new Error(e(n.body));throw a.name=r,a}throw i[r]}else if(s==="event"){const r={[n.headers[":event-type"].value]:n},o=await t(r);return o.$unknown?void 0:o}else throw Error(`Unrecognizable event type: ${n.headers[":event-type"].value}`)}}let X0=class{constructor({utf8Encoder:e,utf8Decoder:n}){this.eventStreamCodec=new z0(e,n),this.utfEncoder=e}deserialize(e,n){const s=V0(e);return new W0({messageStream:new j0({inputStream:s,decoder:this.eventStreamCodec}),deserializer:G0(n,this.utfEncoder)})}serialize(e,n){return new K0({messageStream:new q0({inputStream:e,serializer:n}),encoder:this.eventStreamCodec,includeEndFrame:!0})}};const Z0=t=>({[Symbol.asyncIterator]:async function*(){const e=t.getReader();try{for(;;){const{done:n,value:s}=await e.read();if(n)return;yield s}}finally{e.releaseLock()}}}),J0=t=>{const e=t[Symbol.asyncIterator]();return new ReadableStream({async pull(n){const{done:s,value:r}=await e.next();if(s)return n.close();n.enqueue(r)}})};class Q0{constructor({utf8Encoder:e,utf8Decoder:n}){this.universalMarshaller=new X0({utf8Decoder:n,utf8Encoder:e})}deserialize(e,n){const s=Y0(e)?Z0(e):e;return this.universalMarshaller.deserialize(s,n)}serialize(e,n){const s=this.universalMarshaller.serialize(e,n);return typeof ReadableStream=="function"?J0(s):s}}const Y0=t=>typeof ReadableStream=="function"&&t instanceof ReadableStream,em=t=>new Q0(t);async function tm(t,e,n=1024*1024){const s=t.size;let r=0;for(;r<s;){const o=t.slice(r,Math.min(s,r+n));e(new Uint8Array(await o.arrayBuffer())),r+=o.size}}const nm=async function(e,n){const s=new e;return await tm(n,r=>{s.update(r)}),s.digest()},nt=64,sm=16,rm=[1732584193,4023233417,2562383102,271733878];class im{constructor(){this.reset()}update(e){if(om(e))return;if(this.finished)throw new Error("Attempted to update an already finished hash.");const n=am(e);let s=0,{byteLength:r}=n;for(this.bytesHashed+=r;r>0;)this.buffer.setUint8(this.bufferLength++,n[s++]),r--,this.bufferLength===nt&&(this.hashBuffer(),this.bufferLength=0)}async digest(){if(!this.finished){const{buffer:n,bufferLength:s,bytesHashed:r}=this,o=r*8;if(n.setUint8(this.bufferLength++,128),s%nt>=nt-8){for(let i=this.bufferLength;i<nt;i++)n.setUint8(i,0);this.hashBuffer(),this.bufferLength=0}for(let i=this.bufferLength;i<nt-8;i++)n.setUint8(i,0);n.setUint32(nt-8,o>>>0,!0),n.setUint32(nt-4,Math.floor(o/4294967296),!0),this.hashBuffer(),this.finished=!0}const e=new DataView(new ArrayBuffer(sm));for(let n=0;n<4;n++)e.setUint32(n*4,this.state[n],!0);return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}hashBuffer(){const{buffer:e,state:n}=this;let s=n[0],r=n[1],o=n[2],i=n[3];s=Ae(s,r,o,i,e.getUint32(0,!0),7,3614090360),i=Ae(i,s,r,o,e.getUint32(4,!0),12,3905402710),o=Ae(o,i,s,r,e.getUint32(8,!0),17,606105819),r=Ae(r,o,i,s,e.getUint32(12,!0),22,3250441966),s=Ae(s,r,o,i,e.getUint32(16,!0),7,4118548399),i=Ae(i,s,r,o,e.getUint32(20,!0),12,1200080426),o=Ae(o,i,s,r,e.getUint32(24,!0),17,2821735955),r=Ae(r,o,i,s,e.getUint32(28,!0),22,4249261313),s=Ae(s,r,o,i,e.getUint32(32,!0),7,1770035416),i=Ae(i,s,r,o,e.getUint32(36,!0),12,2336552879),o=Ae(o,i,s,r,e.getUint32(40,!0),17,4294925233),r=Ae(r,o,i,s,e.getUint32(44,!0),22,2304563134),s=Ae(s,r,o,i,e.getUint32(48,!0),7,1804603682),i=Ae(i,s,r,o,e.getUint32(52,!0),12,4254626195),o=Ae(o,i,s,r,e.getUint32(56,!0),17,2792965006),r=Ae(r,o,i,s,e.getUint32(60,!0),22,1236535329),s=ve(s,r,o,i,e.getUint32(4,!0),5,4129170786),i=ve(i,s,r,o,e.getUint32(24,!0),9,3225465664),o=ve(o,i,s,r,e.getUint32(44,!0),14,643717713),r=ve(r,o,i,s,e.getUint32(0,!0),20,3921069994),s=ve(s,r,o,i,e.getUint32(20,!0),5,3593408605),i=ve(i,s,r,o,e.getUint32(40,!0),9,38016083),o=ve(o,i,s,r,e.getUint32(60,!0),14,3634488961),r=ve(r,o,i,s,e.getUint32(16,!0),20,3889429448),s=ve(s,r,o,i,e.getUint32(36,!0),5,568446438),i=ve(i,s,r,o,e.getUint32(56,!0),9,3275163606),o=ve(o,i,s,r,e.getUint32(12,!0),14,4107603335),r=ve(r,o,i,s,e.getUint32(32,!0),20,1163531501),s=ve(s,r,o,i,e.getUint32(52,!0),5,2850285829),i=ve(i,s,r,o,e.getUint32(8,!0),9,4243563512),o=ve(o,i,s,r,e.getUint32(28,!0),14,1735328473),r=ve(r,o,i,s,e.getUint32(48,!0),20,2368359562),s=ke(s,r,o,i,e.getUint32(20,!0),4,4294588738),i=ke(i,s,r,o,e.getUint32(32,!0),11,2272392833),o=ke(o,i,s,r,e.getUint32(44,!0),16,1839030562),r=ke(r,o,i,s,e.getUint32(56,!0),23,4259657740),s=ke(s,r,o,i,e.getUint32(4,!0),4,2763975236),i=ke(i,s,r,o,e.getUint32(16,!0),11,1272893353),o=ke(o,i,s,r,e.getUint32(28,!0),16,4139469664),r=ke(r,o,i,s,e.getUint32(40,!0),23,3200236656),s=ke(s,r,o,i,e.getUint32(52,!0),4,681279174),i=ke(i,s,r,o,e.getUint32(0,!0),11,3936430074),o=ke(o,i,s,r,e.getUint32(12,!0),16,3572445317),r=ke(r,o,i,s,e.getUint32(24,!0),23,76029189),s=ke(s,r,o,i,e.getUint32(36,!0),4,3654602809),i=ke(i,s,r,o,e.getUint32(48,!0),11,3873151461),o=ke(o,i,s,r,e.getUint32(60,!0),16,530742520),r=ke(r,o,i,s,e.getUint32(8,!0),23,3299628645),s=Re(s,r,o,i,e.getUint32(0,!0),6,4096336452),i=Re(i,s,r,o,e.getUint32(28,!0),10,1126891415),o=Re(o,i,s,r,e.getUint32(56,!0),15,2878612391),r=Re(r,o,i,s,e.getUint32(20,!0),21,4237533241),s=Re(s,r,o,i,e.getUint32(48,!0),6,1700485571),i=Re(i,s,r,o,e.getUint32(12,!0),10,2399980690),o=Re(o,i,s,r,e.getUint32(40,!0),15,4293915773),r=Re(r,o,i,s,e.getUint32(4,!0),21,2240044497),s=Re(s,r,o,i,e.getUint32(32,!0),6,1873313359),i=Re(i,s,r,o,e.getUint32(60,!0),10,4264355552),o=Re(o,i,s,r,e.getUint32(24,!0),15,2734768916),r=Re(r,o,i,s,e.getUint32(52,!0),21,1309151649),s=Re(s,r,o,i,e.getUint32(16,!0),6,4149444226),i=Re(i,s,r,o,e.getUint32(44,!0),10,3174756917),o=Re(o,i,s,r,e.getUint32(8,!0),15,718787259),r=Re(r,o,i,s,e.getUint32(36,!0),21,3951481745),n[0]=s+n[0]&4294967295,n[1]=r+n[1]&4294967295,n[2]=o+n[2]&4294967295,n[3]=i+n[3]&4294967295}reset(){this.state=Uint32Array.from(rm),this.buffer=new DataView(new ArrayBuffer(nt)),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}}function wn(t,e,n,s,r,o){return e=(e+t&4294967295)+(s+o&4294967295)&4294967295,(e<<r|e>>>32-r)+n&4294967295}function Ae(t,e,n,s,r,o,i){return wn(e&n|~e&s,t,e,r,o,i)}function ve(t,e,n,s,r,o,i){return wn(e&s|n&~s,t,e,r,o,i)}function ke(t,e,n,s,r,o,i){return wn(e^n^s,t,e,r,o,i)}function Re(t,e,n,s,r,o,i){return wn(n^(e|~s),t,e,r,o,i)}function om(t){return typeof t=="string"?t.length===0:t.byteLength===0}function am(t){return typeof t=="string"?No(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}const cm=t=>({apiVersion:"2006-03-01",base64Decoder:t?.base64Decoder??Ic,base64Encoder:t?.base64Encoder??Ao,disableHostPrefix:t?.disableHostPrefix??!1,endpointProvider:t?.endpointProvider??Ka,extensions:t?.extensions??[],getAwsChunkedEncodingStream:t?.getAwsChunkedEncodingStream??vh,httpAuthSchemeProvider:t?.httpAuthSchemeProvider??mp,httpAuthSchemes:t?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new vo},{schemeId:"aws.auth#sigv4a",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4a"),signer:new Ph}],logger:t?.logger??new Nc,sdkStreamMixin:t?.sdkStreamMixin??Gu,serviceId:t?.serviceId??"S3",signerConstructor:t?.signerConstructor??Ra,signingEscapePath:t?.signingEscapePath??!1,urlParser:t?.urlParser??Bc,useArnRegion:t?.useArnRegion??!1,utf8Decoder:t?.utf8Decoder??No,utf8Encoder:t?.utf8Encoder??Pc}),um=t=>{const e=Tc(t),n=()=>e().then(jc),s=cm(t);return{...s,...t,runtime:"browser",defaultsMode:e,bodyLengthChecker:t?.bodyLengthChecker??$c,credentialDefaultProvider:t?.credentialDefaultProvider??(r=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:t?.defaultUserAgentProvider??Lc({serviceId:s.serviceId,clientVersion:v0.version}),eventStreamSerdeProvider:t?.eventStreamSerdeProvider??em,maxAttempts:t?.maxAttempts??Fc,md5:t?.md5??im,region:t?.region??Mc("Region is missing"),requestHandler:_c.create(t?.requestHandler??n),retryMode:t?.retryMode??(async()=>(await n()).retryMode||Oc),sha1:t?.sha1??B0,sha256:t?.sha256??Uc,streamCollector:t?.streamCollector??Dc,streamHasher:t?.streamHasher??nm,useDualstackEndpoint:t?.useDualstackEndpoint??(()=>Promise.resolve(zc)),useFipsEndpoint:t?.useFipsEndpoint??(()=>Promise.resolve(Hc))}},dm=t=>{const e=t.httpAuthSchemes;let n=t.httpAuthSchemeProvider,s=t.credentials;return{setHttpAuthScheme(r){const o=e.findIndex(i=>i.schemeId===r.schemeId);o===-1?e.push(r):e.splice(o,1,r)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(r){n=r},httpAuthSchemeProvider(){return n},setCredentials(r){s=r},credentials(){return s}}},lm=t=>({httpAuthSchemes:t.httpAuthSchemes(),httpAuthSchemeProvider:t.httpAuthSchemeProvider(),credentials:t.credentials()}),hm=(t,e)=>{const n=Object.assign(Kc(t),Wc(t),qc(t),dm(t));return e.forEach(s=>s.configure(n)),Object.assign(t,Vc(n),Gc(n),Xc(n),lm(n))};class fm extends Zc{config;constructor(...[e]){const n=um(e||{});super(n),this.initConfig=n;const s=xp(n),r=Jc(s),o=mf(r),i=Qc(o),a=Yc(i),d=tu(a),c=eu(d),u=Zf(c),f=yp(u),h=Mf(f,{session:[()=>this,S0]}),y=hm(h,e?.extensions||[]);this.config=y,this.middlewareStack.use(nu(this.config)),this.middlewareStack.use(su(this.config)),this.middlewareStack.use(ru(this.config)),this.middlewareStack.use(iu(this.config)),this.middlewareStack.use(ou(this.config)),this.middlewareStack.use(au(this.config)),this.middlewareStack.use(cu(this.config,{httpAuthSchemeParametersProvider:fp,identityProviderConfigProvider:async S=>new uu({"aws.auth#sigv4":S.credentials,"aws.auth#sigv4a":S.credentials})})),this.middlewareStack.use(du(this.config)),this.middlewareStack.use(Xf(this.config)),this.middlewareStack.use(Wh(this.config)),this.middlewareStack.use(Cf(this.config)),this.middlewareStack.use(If(this.config)),this.middlewareStack.use(_f(this.config))}destroy(){super.destroy()}}function pm(t){return e=>async n=>{const s={...n.input},r=[{target:"SSECustomerKey",hash:"SSECustomerKeyMD5"},{target:"CopySourceSSECustomerKey",hash:"CopySourceSSECustomerKeyMD5"}];for(const o of r){const i=s[o.target];if(i){let a;typeof i=="string"?ym(i,t)?a=t.base64Decoder(i):(a=t.utf8Decoder(i),s[o.target]=t.base64Encoder(a)):(a=ArrayBuffer.isView(i)?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i),s[o.target]=t.base64Encoder(a));const d=new t.md5;d.update(a),s[o.hash]=t.base64Encoder(await d.digest())}}return e({...n,input:s})}}const gm={name:"ssecMiddleware",step:"initialize",tags:["SSE"],override:!0},mm=t=>({applyToStack:e=>{e.add(pm(t),gm)}});function ym(t,e){if(!/^(?:[A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t))return!1;try{return e.base64Decoder(t).length===32}catch{return!1}}class rc extends Ro.classBuilder().ep({...Va,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(e,n,s,r){return[Po(s,this.serialize,this.deserialize),Bo(s,e.getEndpointParameterInstructions()),gf(s,{requestChecksumRequired:!1,requestValidationModeMember:"ChecksumMode",responseAlgorithms:["CRC64NVME","CRC32","CRC32C","SHA256","SHA1"]}),mm(s),Af()]}).s("AmazonS3","GetObject",{}).n("S3Client","GetObjectCommand").f(Sp,wp).ser(vp).de(Rp).build(){}function xm(t){const{port:e,query:n}=t;let{protocol:s,path:r,hostname:o}=t;s&&s.slice(-1)!==":"&&(s+=":"),e&&(o+=`:${e}`),r&&r.charAt(0)!=="/"&&(r=`/${r}`);let i=n?lu(n):"";i&&i[0]!=="?"&&(i=`?${i}`);let a="";if(t.username!=null||t.password!=null){const c=t.username??"",u=t.password??"";a=`${c}:${u}@`}let d="";return t.fragment&&(d=`#${t.fragment}`),`${s}//${a}${o}${r}${i}${d}`}const bm="UNSIGNED-PAYLOAD",Em="X-Amz-Content-Sha256";class Co{signer;constructor(e){const n={service:e.signingName||e.service||"s3",uriEscapePath:e.uriEscapePath||!1,applyChecksum:e.applyChecksum||!1,...e};this.signer=new Ra(n)}presign(e,{unsignableHeaders:n=new Set,hoistableHeaders:s=new Set,unhoistableHeaders:r=new Set,...o}={}){return this.prepareRequest(e,{unsignableHeaders:n,unhoistableHeaders:r,hoistableHeaders:s}),this.signer.presign(e,{expiresIn:900,unsignableHeaders:n,unhoistableHeaders:r,...o})}presignWithCredentials(e,n,{unsignableHeaders:s=new Set,hoistableHeaders:r=new Set,unhoistableHeaders:o=new Set,...i}={}){return this.prepareRequest(e,{unsignableHeaders:s,unhoistableHeaders:o,hoistableHeaders:r}),this.signer.presignWithCredentials(e,n,{expiresIn:900,unsignableHeaders:s,unhoistableHeaders:o,...i})}prepareRequest(e,{unsignableHeaders:n=new Set,unhoistableHeaders:s=new Set,hoistableHeaders:r=new Set}={}){n.add("content-type"),Object.keys(e.headers).map(d=>d.toLowerCase()).filter(d=>d.startsWith("x-amz-server-side-encryption")).forEach(d=>{r.has(d)||s.add(d)}),e.headers[Em]=bm;const o=e.headers.host,i=e.port,a=`${e.hostname}${e.port!=null?":"+i:""}`;(!o||o===e.hostname&&e.port!=null)&&(e.headers.host=a)}}const Cm=async(t,e,n={})=>{let s,r;if(typeof t.config.endpointProvider=="function"){const h=(await hu(e.input,e.constructor,t.config)).properties?.authSchemes?.[0];h?.name==="sigv4a"?r=h?.signingRegionSet?.join(","):r=h?.signingRegion,s=new Co({...t.config,signingName:h?.signingName,region:async()=>r})}else s=new Co(t.config);const o=(f,h)=>async y=>{const{request:S}=y;if(!gt.isInstance(S))throw new Error("Request to be presigned is not an valid HTTP request.");delete S.headers["amz-sdk-invocation-id"],delete S.headers["amz-sdk-request"],delete S.headers["x-amz-user-agent"];let B;const O={...n,signingRegion:n.signingRegion??h.signing_region??r,signingService:n.signingService??h.signing_service};return h.s3ExpressIdentity?B=await s.presignWithCredentials(S,h.s3ExpressIdentity,O):B=await s.presign(S,O),{response:{},output:{$metadata:{httpStatusCode:200},presigned:B}}},i="presignInterceptMiddleware",a=t.middlewareStack.clone();a.addRelativeTo(o,{name:i,relation:"before",toMiddleware:"awsAuthMiddleware",override:!0});const d=e.resolveMiddleware(a,t.config,{}),{output:c}=await d({input:e.input}),{presigned:u}=c;return xm(u)};var Lt={exports:{}},wm=Lt.exports,wo;function Sm(){return wo||(wo=1,function(t,e){(function(n,s,r){r=r(),t.exports&&(e=t.exports=r),e[n]=r})("timekeeper",wm,function(){var n=Date,s={},r=null,o=null,i=null;function a(){return o+(n.now()-i)}function d(f,h,y,S,B,O,g){var x=arguments.length;if(this instanceof n){if(!x&&r)return new n(r.getTime());if(!x&&o)return new n(a());var T=x==1&&String(f)===f?new n(n.parse(f)):x>=7?new n(f,h,y,S,B,O,g):x>=6?new n(f,h,y,S,B,O):x>=5?new n(f,h,y,S,B):x>=4?new n(f,h,y,S):x>=3?new n(f,h,y):x>=2?new n(f,h):x>=1?new n(f):new n;return T.constructor=n,T}return n.apply(this,arguments)}(function(){for(var f in n)d[f]=n[f]})(),d.UTC=n.UTC,d.parse=n.parse,d.prototype=n.prototype,d.prototype.constructor=n,d.now=function(){return r?r.getTime():o?a():n.now()},s.freeze=function(f){c(),typeof f!="object"&&(f=f===void 0?new n:new n(f)),r=f},s.travel=function(f){c(),typeof f!="object"&&(f=f===void 0?new n:new n(f)),r&&s.freeze(f),o=f.getTime(),i=n.now()},s.reset=function(){u(),r=null,i=null,o=null},s.withFreeze=function(f,h){s.freeze(f);var y;try{y=h()}catch(S){throw s.reset(),S}return y!==null&&typeof y=="object"&&typeof y.then=="function"?(y.then(function(){s.reset()},function(){s.reset()}),y):(s.reset(),y)},s.isKeepingTime=function(){return Date===d};function c(){Date=d}function u(){Date=n}return s})}(Lt,Lt.exports)),Lt.exports}var Am=Sm();const vm=Uo(Am);async function ic(){return new fm({region:Pu(),credentials:await Ru()})}function qm(t){if(t.startsWith("s3://")){const e=new URL(t.replace(/^s3:\/\//,"https://")),n=e.host,s=decodeURI(e.pathname.substring(1));return{Bucket:n,Key:s}}else if(t.startsWith("https://s3")){const n=new URL(t).pathname.split("/");return{Bucket:n[1],Key:n.splice(2).join("/")}}else throw new Error(`Unknown S3 URI ${t}.`)}function km(){const e=new Date;return new Date(Math.floor(e.getTime()/84e4)*84e4)}async function Vm(t){const e=await ic(),n=new rc({...t,ResponseCacheControl:"max-age: 900"});return vm.withFreeze(km(),async()=>await Cm(e,n,{expiresIn:900}))}async function Gm(t){const e=await ic(),n=new rc(t);return await e.send(n)}async function Xm({Key:t,Body:e,ContentType:n="audio/wav",callbackFn:s}){const{username:r,signInDetails:o}=await ku();try{return await mh({path:t,data:e,options:{contentType:n,metadata:{uploadUsername:r||"error: username not found",uploadLoginId:o?.loginId||"error: loginId not found"},onProgress:({transferredBytes:i,totalBytes:a})=>{s?s({loaded:i,total:a}):console.debug("S3 upload progress: ",{loaded:i,total:a})}}}).result}catch(i){const a=i;throw new Error(`Error in S3 upload: ${a.message}`)}}function Bt(t){var{size:e="normal",variant:n="normal"}=t,s=Us(t,["size","variant"]);const r=$o("Icon",{props:{name:s.name,size:e,variant:n}});return Oe.createElement(Bu,Object.assign({size:e,variant:n},s,r))}Ho(Bt,"Icon");const Rm=Oe.forwardRef(Pm);function Pm(t,e){var{position:n="right",size:s="medium",fixedWidth:r=!1,triggerType:o="text",dismissButton:i=!0,children:a,header:d,content:c,triggerAriaLabel:u,wrapTriggerText:f=!0,isInline:h=!1,renderWithPortal:y=!1,__onOpen:S,__internalRootRef:B=null,__closeAnalyticsAction:O}=t,g=Us(t,["position","size","fixedWidth","triggerType","dismissButton","children","header","content","triggerAriaLabel","wrapTriggerText","isInline","renderWithPortal","__onOpen","__internalRootRef","__closeAnalyticsAction"]);const x=Nu(g),T=Ke.useRef(null),b=Ke.useRef(null),P=Ke.useRef(null),U=Iu("popover")("dismissAriaLabel",g.dismissAriaLabel),[E,v]=Ke.useState(!1),N=Ke.useCallback(()=>{var le,je;["text","text-inline"].includes(o)?(le=T.current)===null||le===void 0||le.focus():T.current&&((je=Tu(T.current))===null||je===void 0||je.focus())},[o]),D=Ke.useCallback(()=>{Du(S),v(!0)},[S]),A=Ke.useCallback(()=>{v(!1),N()},[N]),H=Ke.useCallback(le=>{const je=le.keyCode===fr.escape,Yt=le.keyCode===fr.tab;je&&E&&le.stopPropagation(),(Yt||je)&&v(!1)},[E]);Ke.useImperativeHandle(e,()=>({dismissPopover:A,focus:()=>{v(!1),N()}})),Ke.useEffect(()=>{if(!T.current)return;const le=T.current.ownerDocument,je=()=>{P.current===null&&v(!1)};return le.addEventListener("mousedown",je),()=>{le.removeEventListener("mousedown",je)}},[]);const q=Uu(T),ye={ref:T,onClick:D,onKeyDown:H,className:tn(dt.trigger,dt[`trigger-type-${o}`])},{tabIndex:wt}=Ou(T),Qe=_u(),xe=Oe.createElement("div",{"aria-live":i?void 0:"polite","aria-atomic":i?void 0:!0,className:tn(q,!y&&dt["popover-inline-content"]),"data-awsui-referrer-id":Qe},Oe.createElement(Mu,{size:s,fixedWidth:r,position:n,trackRef:T,arrow:le=>Oe.createElement(Fu,{position:le}),renderWithPortal:y,zIndex:y?7e3:void 0},Oe.createElement(Lu.Provider,{value:{defaultVariant:"primary"}},Oe.createElement($u,{dismissButton:i,dismissAriaLabel:U,header:d,onDismiss:A,overflowVisible:"both",closeAnalyticsAction:O},c)))),ut=Hu(b,B);return Oe.createElement("span",Object.assign({},x,{className:tn(dt.root,x.className,o==="filtering-token"&&dt["root-filtering-token"],h&&dt["no-wrap"]),ref:ut,onMouseDown:()=>{P.current=requestAnimationFrame(()=>{P.current=null})}}),["text","text-inline"].includes(o)?Oe.createElement("button",Object.assign({},ye,{className:tn(ye.className,f===!1&&dt["overflow-ellipsis"]),tabIndex:wt,type:"button","aria-haspopup":"dialog",id:Qe,"aria-label":u}),a):Oe.createElement("span",Object.assign({},ye,{id:Qe}),a),E&&Oe.createElement(zu,null,y?Oe.createElement(ju,null,xe):xe))}const Bm=Oe.forwardRef((t,e)=>{var{position:n="right",size:s="medium",fixedWidth:r=!1,triggerType:o="text",dismissButton:i=!0,renderWithPortal:a=!1,wrapTriggerText:d=!0,header:c}=t,u=Us(t,["position","size","fixedWidth","triggerType","dismissButton","renderWithPortal","wrapTriggerText","header"]);const f=$o("Popover",{props:{dismissButton:i,fixedWidth:r,position:n,renderWithPortal:a,size:s,triggerType:o}}),h=Ku(u),y=Ke.useRef(null);return Wu(e,y),Oe.createElement(Rm,Object.assign({ref:y,header:c,position:n,size:s,fixedWidth:r,triggerType:o,dismissButton:i,renderWithPortal:a,wrapTriggerText:d},h,f))});Ho(Bm,"Popover");function be(t,e,n,s){return new(n||(n=Promise))(function(r,o){function i(c){try{d(s.next(c))}catch(u){o(u)}}function a(c){try{d(s.throw(c))}catch(u){o(u)}}function d(c){var u;c.done?r(c.value):(u=c.value,u instanceof n?u:new n(function(f){f(u)})).then(i,a)}d((s=s.apply(t,e||[])).next())})}class Qt{constructor(){this.listeners={}}on(e,n,s){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(n),s?.once){const r=()=>{this.un(e,r),this.un(e,n)};return this.on(e,r),r}return()=>this.un(e,n)}un(e,n){var s;(s=this.listeners[e])===null||s===void 0||s.delete(n)}once(e,n){return this.on(e,n,{once:!0})}unAll(){this.listeners={}}emit(e,...n){this.listeners[e]&&this.listeners[e].forEach(s=>s(...n))}}const cn={decode:function(t,e){return be(this,void 0,void 0,function*(){const n=new AudioContext({sampleRate:e});return n.decodeAudioData(t).finally(()=>n.close())})},createBuffer:function(t,e){return typeof t[0]=="number"&&(t=[t]),function(n){const s=n[0];if(s.some(r=>r>1||r<-1)){const r=s.length;let o=0;for(let i=0;i<r;i++){const a=Math.abs(s[i]);a>o&&(o=a)}for(const i of n)for(let a=0;a<r;a++)i[a]/=o}}(t),{duration:e,length:t[0].length,sampleRate:t[0].length/e,numberOfChannels:t.length,getChannelData:n=>t?.[n],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function oc(t,e){const n=e.xmlns?document.createElementNS(e.xmlns,t):document.createElement(t);for(const[s,r]of Object.entries(e))if(s==="children")for(const[o,i]of Object.entries(e))typeof i=="string"?n.appendChild(document.createTextNode(i)):n.appendChild(oc(o,i));else s==="style"?Object.assign(n.style,r):s==="textContent"?n.textContent=r:n.setAttribute(s,r.toString());return n}function So(t,e,n){const s=oc(t,e||{});return n?.appendChild(s),s}var Nm=Object.freeze({__proto__:null,createElement:So,default:So});const Im={fetchBlob:function(t,e,n){return be(this,void 0,void 0,function*(){const s=yield fetch(t,n);if(s.status>=400)throw new Error(`Failed to fetch ${t}: ${s.status} (${s.statusText})`);return function(r,o){be(this,void 0,void 0,function*(){if(!r.body||!r.headers)return;const i=r.body.getReader(),a=Number(r.headers.get("Content-Length"))||0;let d=0;const c=f=>be(this,void 0,void 0,function*(){d+=f?.length||0;const h=Math.round(d/a*100);o(h)}),u=()=>be(this,void 0,void 0,function*(){let f;try{f=yield i.read()}catch{return}f.done||(c(f.value),yield u())});u()})}(s.clone(),e),s.blob()})}};class Tm extends Qt{constructor(e){super(),this.isExternalMedia=!1,e.media?(this.media=e.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),e.mediaControls&&(this.media.controls=!0),e.autoplay&&(this.media.autoplay=!0),e.playbackRate!=null&&this.onMediaEvent("canplay",()=>{e.playbackRate!=null&&(this.media.playbackRate=e.playbackRate)},{once:!0})}onMediaEvent(e,n,s){return this.media.addEventListener(e,n,s),()=>this.media.removeEventListener(e,n,s)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const e=this.getSrc();e.startsWith("blob:")&&URL.revokeObjectURL(e)}canPlayType(e){return this.media.canPlayType(e)!==""}setSrc(e,n){const s=this.getSrc();if(e&&s===e)return;this.revokeSrc();const r=n instanceof Blob&&(this.canPlayType(n.type)||!e)?URL.createObjectURL(n):e;s&&(this.media.src="");try{this.media.src=r}catch{this.media.src=e}}destroy(){this.isExternalMedia||(this.media.pause(),this.media.remove(),this.revokeSrc(),this.media.src="",this.media.load())}setMediaElement(e){this.media=e}play(){return be(this,void 0,void 0,function*(){return this.media.play()})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(e){this.media.currentTime=Math.max(0,Math.min(e,this.getDuration()))}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(e){this.media.volume=e}getMuted(){return this.media.muted}setMuted(e){this.media.muted=e}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(e,n){n!=null&&(this.media.preservesPitch=n),this.media.playbackRate=e}getMediaElement(){return this.media}setSinkId(e){return this.media.setSinkId(e)}}class Dt extends Qt{constructor(e,n){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.unsubscribeOnScroll=[],this.subscriptions=[],this.options=e;const s=this.parentFromOptionsContainer(e.container);this.parent=s;const[r,o]=this.initHtml();s.appendChild(r),this.container=r,this.scrollContainer=o.querySelector(".scroll"),this.wrapper=o.querySelector(".wrapper"),this.canvasWrapper=o.querySelector(".canvases"),this.progressWrapper=o.querySelector(".progress"),this.cursor=o.querySelector(".cursor"),n&&o.appendChild(n),this.initEvents()}parentFromOptionsContainer(e){let n;if(typeof e=="string"?n=document.querySelector(e):e instanceof HTMLElement&&(n=e),!n)throw new Error("Container not found");return n}initEvents(){const e=n=>{const s=this.wrapper.getBoundingClientRect(),r=n.clientX-s.left,o=n.clientY-s.top;return[r/s.width,o/s.height]};if(this.wrapper.addEventListener("click",n=>{const[s,r]=e(n);this.emit("click",s,r)}),this.wrapper.addEventListener("dblclick",n=>{const[s,r]=e(n);this.emit("dblclick",s,r)}),this.options.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{const{scrollLeft:n,scrollWidth:s,clientWidth:r}=this.scrollContainer,o=n/s,i=(n+r)/s;this.emit("scroll",o,i,n,n+r)}),typeof ResizeObserver=="function"){const n=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{n().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}}onContainerResize(){const e=this.parent.clientWidth;e===this.lastContainerWidth&&this.options.height!=="auto"||(this.lastContainerWidth=e,this.reRender())}initDrag(){this.subscriptions.push(function(e,n,s,r,o=3,i=0,a=100){if(!e)return()=>{};const d=matchMedia("(pointer: coarse)").matches;let c=()=>{};const u=f=>{if(f.button!==i)return;f.preventDefault(),f.stopPropagation();let h=f.clientX,y=f.clientY,S=!1;const B=Date.now(),O=P=>{if(P.preventDefault(),P.stopPropagation(),d&&Date.now()-B<a)return;const m=P.clientX,U=P.clientY,E=m-h,v=U-y;if(S||Math.abs(E)>o||Math.abs(v)>o){const N=e.getBoundingClientRect(),{left:D,top:A}=N;S||(s?.(h-D,y-A),S=!0),n(E,v,m-D,U-A),h=m,y=U}},g=P=>{if(S){const m=P.clientX,U=P.clientY,E=e.getBoundingClientRect(),{left:v,top:N}=E;r?.(m-v,U-N)}c()},x=P=>{P.relatedTarget&&P.relatedTarget!==document.documentElement||g(P)},T=P=>{S&&(P.stopPropagation(),P.preventDefault())},b=P=>{S&&P.preventDefault()};document.addEventListener("pointermove",O),document.addEventListener("pointerup",g),document.addEventListener("pointerout",x),document.addEventListener("pointercancel",x),document.addEventListener("touchmove",b,{passive:!1}),document.addEventListener("click",T,{capture:!0}),c=()=>{document.removeEventListener("pointermove",O),document.removeEventListener("pointerup",g),document.removeEventListener("pointerout",x),document.removeEventListener("pointercancel",x),document.removeEventListener("touchmove",b),setTimeout(()=>{document.removeEventListener("click",T,{capture:!0})},10)}};return e.addEventListener("pointerdown",u),()=>{c(),e.removeEventListener("pointerdown",u)}}(this.wrapper,(e,n,s)=>{this.emit("drag",Math.max(0,Math.min(1,s/this.wrapper.getBoundingClientRect().width)))},e=>{this.isDragging=!0,this.emit("dragstart",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))},e=>{this.isDragging=!1,this.emit("dragend",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))}))}getHeight(e,n){var s;const r=((s=this.audioData)===null||s===void 0?void 0:s.numberOfChannels)||1;if(e==null)return 128;if(!isNaN(Number(e)))return Number(e);if(e==="auto"){const o=this.parent.clientHeight||128;return n?.every(i=>!i.overlay)?o/r:o}return 128}initHtml(){const e=document.createElement("div"),n=e.attachShadow({mode:"open"}),s=this.options.cspNonce&&typeof this.options.cspNonce=="string"?this.options.cspNonce.replace(/"/g,""):"";return n.innerHTML=`
      <style${s?` nonce="${s}"`:""}>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height,this.options.splitChannels)}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases" part="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[e,n]}setOptions(e){if(this.options.container!==e.container){const n=this.parentFromOptionsContainer(e.container);n.appendChild(this.container),this.parent=n}e.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.options=e,this.reRender()}getWrapper(){return this.wrapper}getWidth(){return this.scrollContainer.clientWidth}getScroll(){return this.scrollContainer.scrollLeft}setScroll(e){this.scrollContainer.scrollLeft=e}setScrollPercentage(e){const{scrollWidth:n}=this.scrollContainer,s=n*e;this.setScroll(s)}destroy(){var e,n;this.subscriptions.forEach(s=>s()),this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(n=this.unsubscribeOnScroll)===null||n===void 0||n.forEach(s=>s()),this.unsubscribeOnScroll=[]}createDelay(e=10){let n,s;const r=()=>{n&&clearTimeout(n),s&&s()};return this.timeouts.push(r),()=>new Promise((o,i)=>{r(),s=i,n=setTimeout(()=>{n=void 0,s=void 0,o()},e)})}convertColorValues(e){if(!Array.isArray(e))return e||"";if(e.length<2)return e[0]||"";const n=document.createElement("canvas"),s=n.getContext("2d"),r=n.height*(window.devicePixelRatio||1),o=s.createLinearGradient(0,0,0,r),i=1/(e.length-1);return e.forEach((a,d)=>{const c=d*i;o.addColorStop(c,a)}),o}getPixelRatio(){return Math.max(1,window.devicePixelRatio||1)}renderBarWaveform(e,n,s,r){const o=e[0],i=e[1]||e[0],a=o.length,{width:d,height:c}=s.canvas,u=c/2,f=this.getPixelRatio(),h=n.barWidth?n.barWidth*f:1,y=n.barGap?n.barGap*f:n.barWidth?h/2:0,S=n.barRadius||0,B=d/(h+y)/a,O=S&&"roundRect"in s?"roundRect":"rect";s.beginPath();let g=0,x=0,T=0;for(let b=0;b<=a;b++){const P=Math.round(b*B);if(P>g){const E=Math.round(x*u*r),v=E+Math.round(T*u*r)||1;let N=u-E;n.barAlign==="top"?N=0:n.barAlign==="bottom"&&(N=c-v),s[O](g*(h+y),N,h,v,S),g=P,x=0,T=0}const m=Math.abs(o[b]||0),U=Math.abs(i[b]||0);m>x&&(x=m),U>T&&(T=U)}s.fill(),s.closePath()}renderLineWaveform(e,n,s,r){const o=i=>{const a=e[i]||e[0],d=a.length,{height:c}=s.canvas,u=c/2,f=s.canvas.width/d;s.moveTo(0,u);let h=0,y=0;for(let S=0;S<=d;S++){const B=Math.round(S*f);if(B>h){const g=u+(Math.round(y*u*r)||1)*(i===0?-1:1);s.lineTo(h,g),h=B,y=0}const O=Math.abs(a[S]||0);O>y&&(y=O)}s.lineTo(h,u)};s.beginPath(),o(0),o(1),s.fill(),s.closePath()}renderWaveform(e,n,s){if(s.fillStyle=this.convertColorValues(n.waveColor),n.renderFunction)return void n.renderFunction(e,s);let r=n.barHeight||1;if(n.normalize){const o=Array.from(e[0]).reduce((i,a)=>Math.max(i,Math.abs(a)),0);r=o?1/o:1}n.barWidth||n.barGap||n.barAlign?this.renderBarWaveform(e,n,s,r):this.renderLineWaveform(e,n,s,r)}renderSingleCanvas(e,n,s,r,o,i,a){const d=this.getPixelRatio(),c=document.createElement("canvas");c.width=Math.round(s*d),c.height=Math.round(r*d),c.style.width=`${s}px`,c.style.height=`${r}px`,c.style.left=`${Math.round(o)}px`,i.appendChild(c);const u=c.getContext("2d");if(this.renderWaveform(e,n,u),c.width>0&&c.height>0){const f=c.cloneNode(),h=f.getContext("2d");h.drawImage(c,0,0),h.globalCompositeOperation="source-in",h.fillStyle=this.convertColorValues(n.progressColor),h.fillRect(0,0,c.width,c.height),a.appendChild(f)}}renderMultiCanvas(e,n,s,r,o,i){const a=this.getPixelRatio(),{clientWidth:d}=this.scrollContainer,c=s/a;let u=Math.min(Dt.MAX_CANVAS_WIDTH,d,c),f={};if(u===0)return;if(n.barWidth||n.barGap){const O=n.barWidth||.5,g=O+(n.barGap||O/2);u%g!=0&&(u=Math.floor(u/g)*g)}const h=O=>{if(O<0||O>=y||f[O])return;f[O]=!0;const g=O*u,x=Math.min(c-g,u);if(x<=0)return;const T=e.map(b=>{const P=Math.floor(g/c*b.length),m=Math.floor((g+x)/c*b.length);return b.slice(P,m)});this.renderSingleCanvas(T,n,x,r,g,o,i)},y=Math.ceil(c/u);if(!this.isScrollable){for(let O=0;O<y;O++)h(O);return}const S=this.scrollContainer.scrollLeft/c,B=Math.floor(S*y);if(h(B-1),h(B),h(B+1),y>1){const O=this.on("scroll",()=>{const{scrollLeft:g}=this.scrollContainer,x=Math.floor(g/c*y);Object.keys(f).length>Dt.MAX_NODES&&(o.innerHTML="",i.innerHTML="",f={}),h(x-1),h(x),h(x+1)});this.unsubscribeOnScroll.push(O)}}renderChannel(e,n,s,r){var{overlay:o}=n,i=function(u,f){var h={};for(var y in u)Object.prototype.hasOwnProperty.call(u,y)&&f.indexOf(y)<0&&(h[y]=u[y]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function"){var S=0;for(y=Object.getOwnPropertySymbols(u);S<y.length;S++)f.indexOf(y[S])<0&&Object.prototype.propertyIsEnumerable.call(u,y[S])&&(h[y[S]]=u[y[S]])}return h}(n,["overlay"]);const a=document.createElement("div"),d=this.getHeight(i.height,i.splitChannels);a.style.height=`${d}px`,o&&r>0&&(a.style.marginTop=`-${d}px`),this.canvasWrapper.style.minHeight=`${d}px`,this.canvasWrapper.appendChild(a);const c=a.cloneNode();this.progressWrapper.appendChild(c),this.renderMultiCanvas(e,i,s,d,a,c)}render(e){return be(this,void 0,void 0,function*(){var n;this.timeouts.forEach(d=>d()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);const s=this.getPixelRatio(),r=this.scrollContainer.clientWidth,o=Math.ceil(e.duration*(this.options.minPxPerSec||0));this.isScrollable=o>r;const i=this.options.fillParent&&!this.isScrollable,a=(i?r:o)*s;if(this.wrapper.style.width=i?"100%":`${o}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=e,this.emit("render"),this.options.splitChannels)for(let d=0;d<e.numberOfChannels;d++){const c=Object.assign(Object.assign({},this.options),(n=this.options.splitChannels)===null||n===void 0?void 0:n[d]);this.renderChannel([e.getChannelData(d)],c,a,d)}else{const d=[e.getChannelData(0)];e.numberOfChannels>1&&d.push(e.getChannelData(1)),this.renderChannel(d,this.options,a,0)}Promise.resolve().then(()=>this.emit("rendered"))})}reRender(){if(this.unsubscribeOnScroll.forEach(s=>s()),this.unsubscribeOnScroll=[],!this.audioData)return;const{scrollWidth:e}=this.scrollContainer,{right:n}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&e!==this.scrollContainer.scrollWidth){const{right:s}=this.progressWrapper.getBoundingClientRect();let r=s-n;r*=2,r=r<0?Math.floor(r):Math.ceil(r),r/=2,this.scrollContainer.scrollLeft+=r}}zoom(e){this.options.minPxPerSec=e,this.reRender()}scrollIntoView(e,n=!1){const{scrollLeft:s,scrollWidth:r,clientWidth:o}=this.scrollContainer,i=e*r,a=s,d=s+o,c=o/2;if(this.isDragging)i+30>d?this.scrollContainer.scrollLeft+=30:i-30<a&&(this.scrollContainer.scrollLeft-=30);else{(i<a||i>d)&&(this.scrollContainer.scrollLeft=i-(this.options.autoCenter?c:0));const u=i-s-c;n&&this.options.autoCenter&&u>0&&(this.scrollContainer.scrollLeft+=Math.min(u,10))}{const u=this.scrollContainer.scrollLeft,f=u/r,h=(u+o)/r;this.emit("scroll",f,h,u,u+o)}}renderProgress(e,n){if(isNaN(e))return;const s=100*e;this.canvasWrapper.style.clipPath=`polygon(${s}% 0, 100% 0, 100% 100%, ${s}% 100%)`,this.progressWrapper.style.width=`${s}%`,this.cursor.style.left=`${s}%`,this.cursor.style.transform=`translateX(-${Math.round(s)===100?this.options.cursorWidth:0}px)`,this.isScrollable&&this.options.autoScroll&&this.scrollIntoView(e,n)}exportImage(e,n,s){return be(this,void 0,void 0,function*(){const r=this.canvasWrapper.querySelectorAll("canvas");if(!r.length)throw new Error("No waveform data");if(s==="dataURL"){const o=Array.from(r).map(i=>i.toDataURL(e,n));return Promise.resolve(o)}return Promise.all(Array.from(r).map(o=>new Promise((i,a)=>{o.toBlob(d=>{d?i(d):a(new Error("Could not export image"))},e,n)})))})}}Dt.MAX_CANVAS_WIDTH=8e3,Dt.MAX_NODES=10;class Dm extends Qt{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}}class fs extends Qt{constructor(e=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=e,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return be(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(e){if(this.currentSrc=e,this._duration=void 0,!e)return this.buffer=null,void this.emit("emptied");fetch(e).then(n=>{if(n.status>=400)throw new Error(`Failed to fetch ${e}: ${n.status} (${n.statusText})`);return n.arrayBuffer()}).then(n=>this.currentSrc!==e?null:this.audioContext.decodeAudioData(n)).then(n=>{this.currentSrc===e&&(this.buffer=n,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())})}_play(){var e;if(!this.paused)return;this.paused=!1,(e=this.bufferNode)===null||e===void 0||e.disconnect(),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let n=this.playedDuration*this._playbackRate;(n>=this.duration||n<0)&&(n=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,n),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var e;this.paused=!0,(e=this.bufferNode)===null||e===void 0||e.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return be(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(e){const n=e-this.currentTime,s=this.bufferNode;s?.stop(this.audioContext.currentTime+n),s?.addEventListener("ended",()=>{s===this.bufferNode&&(this.bufferNode=null,this.pause())},{once:!0})}setSinkId(e){return be(this,void 0,void 0,function*(){return this.audioContext.setSinkId(e)})}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this.bufferNode&&(this.bufferNode.playbackRate.value=e)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(e){const n=!this.paused;n&&this._pause(),this.playedDuration=e/this._playbackRate,n&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var e,n;return(e=this._duration)!==null&&e!==void 0?e:((n=this.buffer)===null||n===void 0?void 0:n.duration)||0}set duration(e){this._duration=e}get volume(){return this.gainNode.gain.value}set volume(e){this.gainNode.gain.value=e,this.emit("volumechange")}get muted(){return this._muted}set muted(e){this._muted!==e&&(this._muted=e,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(e){return/^(audio|video)\//.test(e)}getGainNode(){return this.gainNode}getChannelData(){const e=[];if(!this.buffer)return e;const n=this.buffer.numberOfChannels;for(let s=0;s<n;s++)e.push(this.buffer.getChannelData(s));return e}}const Um={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class bn extends Tm{static create(e){return new bn(e)}constructor(e){const n=e.media||(e.backend==="WebAudio"?new fs:void 0);super({media:n,mediaControls:e.mediaControls,autoplay:e.autoplay,playbackRate:e.audioRate}),this.plugins=[],this.decodedData=null,this.stopAtPosition=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.options=Object.assign({},Um,e),this.timer=new Dm;const s=n?void 0:this.getMediaElement();this.renderer=new Dt(this.options,s),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins();const r=this.options.url||this.getSrc()||"";Promise.resolve().then(()=>{this.emit("init");const{peaks:o,duration:i}=this.options;(r||o&&i)&&this.load(r,o,i).catch(()=>null)})}updateProgress(e=this.getCurrentTime()){return this.renderer.renderProgress(e/this.getDuration(),this.isPlaying()),e}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){const e=this.updateProgress();this.emit("timeupdate",e),this.emit("audioprocess",e),this.stopAtPosition!=null&&this.isPlaying()&&e>=this.stopAtPosition&&this.pause()}}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{const e=this.updateProgress();this.emit("timeupdate",e)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("emptied",()=>{this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("ended",()=>{this.emit("timeupdate",this.getDuration()),this.emit("finish"),this.stopAtPosition=null}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}),this.onMediaEvent("error",()=>{var e;this.emit("error",(e=this.getMediaElement().error)!==null&&e!==void 0?e:new Error("Media error")),this.stopAtPosition=null}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(e,n)=>{this.options.interact&&(this.seekTo(e),this.emit("interaction",e*this.getDuration()),this.emit("click",e,n))}),this.renderer.on("dblclick",(e,n)=>{this.emit("dblclick",e,n)}),this.renderer.on("scroll",(e,n,s,r)=>{const o=this.getDuration();this.emit("scroll",e*o,n*o,s,r)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}),this.renderer.on("dragstart",e=>{this.emit("dragstart",e)}),this.renderer.on("dragend",e=>{this.emit("dragend",e)}));{let e;this.subscriptions.push(this.renderer.on("drag",n=>{if(!this.options.interact)return;let s;this.renderer.renderProgress(n),clearTimeout(e),this.isPlaying()?s=0:this.options.dragToSeek===!0?s=200:typeof this.options.dragToSeek=="object"&&this.options.dragToSeek!==void 0&&(s=this.options.dragToSeek.debounceTime),e=setTimeout(()=>{this.seekTo(n)},s),this.emit("interaction",n*this.getDuration()),this.emit("drag",n)}))}}initPlugins(){var e;!((e=this.options.plugins)===null||e===void 0)&&e.length&&this.options.plugins.forEach(n=>{this.registerPlugin(n)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(e=>e()),this.mediaSubscriptions=[]}setOptions(e){this.options=Object.assign({},this.options,e),e.duration&&!e.peaks&&(this.decodedData=cn.createBuffer(this.exportPeaks(),e.duration)),e.peaks&&e.duration&&(this.decodedData=cn.createBuffer(e.peaks,e.duration)),this.renderer.setOptions(this.options),e.audioRate&&this.setPlaybackRate(e.audioRate),e.mediaControls!=null&&(this.getMediaElement().controls=e.mediaControls)}registerPlugin(e){return e._init(this),this.plugins.push(e),this.subscriptions.push(e.once("destroy",()=>{this.plugins=this.plugins.filter(n=>n!==e)})),e}getWrapper(){return this.renderer.getWrapper()}getWidth(){return this.renderer.getWidth()}getScroll(){return this.renderer.getScroll()}setScroll(e){return this.renderer.setScroll(e)}setScrollTime(e){const n=e/this.getDuration();this.renderer.setScrollPercentage(n)}getActivePlugins(){return this.plugins}loadAudio(e,n,s,r){return be(this,void 0,void 0,function*(){var o;if(this.emit("load",e),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,this.stopAtPosition=null,!n&&!s){const a=this.options.fetchParams||{};window.AbortController&&!a.signal&&(this.abortController=new AbortController,a.signal=(o=this.abortController)===null||o===void 0?void 0:o.signal);const d=u=>this.emit("loading",u);n=yield Im.fetchBlob(e,d,a);const c=this.options.blobMimeType;c&&(n=new Blob([n],{type:c}))}this.setSrc(e,n);const i=yield new Promise(a=>{const d=r||this.getDuration();d?a(d):this.mediaSubscriptions.push(this.onMediaEvent("loadedmetadata",()=>a(this.getDuration()),{once:!0}))});if(!e&&!n){const a=this.getMediaElement();a instanceof fs&&(a.duration=i)}if(s)this.decodedData=cn.createBuffer(s,i||0);else if(n){const a=yield n.arrayBuffer();this.decodedData=yield cn.decode(a,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(e,n,s){return be(this,void 0,void 0,function*(){try{return yield this.loadAudio(e,void 0,n,s)}catch(r){throw this.emit("error",r),r}})}loadBlob(e,n,s){return be(this,void 0,void 0,function*(){try{return yield this.loadAudio("",e,n,s)}catch(r){throw this.emit("error",r),r}})}zoom(e){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(e),this.emit("zoom",e)}getDecodedData(){return this.decodedData}exportPeaks({channels:e=2,maxLength:n=8e3,precision:s=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const r=Math.min(e,this.decodedData.numberOfChannels),o=[];for(let i=0;i<r;i++){const a=this.decodedData.getChannelData(i),d=[],c=a.length/n;for(let u=0;u<n;u++){const f=a.slice(Math.floor(u*c),Math.ceil((u+1)*c));let h=0;for(let y=0;y<f.length;y++){const S=f[y];Math.abs(S)>Math.abs(h)&&(h=S)}d.push(Math.round(h*s)/s)}o.push(d)}return o}getDuration(){let e=super.getDuration()||0;return e!==0&&e!==1/0||!this.decodedData||(e=this.decodedData.duration),e}toggleInteraction(e){this.options.interact=e}setTime(e){this.stopAtPosition=null,super.setTime(e),this.updateProgress(e),this.emit("timeupdate",e)}seekTo(e){const n=this.getDuration()*e;this.setTime(n)}play(e,n){const s=Object.create(null,{play:{get:()=>super.play}});return be(this,void 0,void 0,function*(){e!=null&&this.setTime(e);const r=yield s.play.call(this);return n!=null&&(this.media instanceof fs?this.media.stopAt(n):this.stopAtPosition=n),r})}playPause(){return be(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(e){this.setTime(this.getCurrentTime()+e)}empty(){this.load("",[[0]],.001)}setMediaElement(e){this.unsubscribePlayerEvents(),super.setMediaElement(e),this.initPlayerEvents()}exportImage(){return be(this,arguments,void 0,function*(e="image/png",n=1,s="dataURL"){return this.renderer.exportImage(e,n,s)})}destroy(){var e;this.emit("destroy"),(e=this.abortController)===null||e===void 0||e.abort(),this.plugins.forEach(n=>n.destroy()),this.subscriptions.forEach(n=>n()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}}bn.BasePlugin=class extends Qt{constructor(t){super(),this.subscriptions=[],this.options=t}onInit(){}_init(t){this.wavesurfer=t,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(t=>t())}},bn.dom=Nm;const Om="y",_m="z",Mm="A",Fm="B",Lm="C",Rt={ctrlHeading:Om,playerControl:_m,playerControlInline:Mm,closeButton:Fm,downloadButton:Lm},ps=[.5,1,1.2,1.5,2];function Zm({wavesurfer:t,showControls:e,audioLoading:n,setShowControls:s,playingAudio:r,setPlayingAudio:o,playBackSpeed:i,setPlayBackSpeed:a,isEmbeded:d=!1,audioBlob:c=null}){const u=c?URL.createObjectURL(c):null,f=se.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[se.jsx(lt,{onClick:h=>{h.preventDefault(),t.current?.skip(-5)},children:se.jsx(Bt,{name:"undo"})}),r?se.jsx(lt,{onClick:h=>{h.preventDefault(),t.current?.pause(),o(!r)},children:se.jsx(Bt,{name:"view-full"})}):se.jsx(lt,{onClick:h=>{h.preventDefault(),t.current?.play(),o(!r)},children:se.jsx(Bt,{name:"caret-right-filled"})}),se.jsxs(lt,{onClick:h=>{h.preventDefault();const y=i===ps.length-1?0:i+1;t.current?.setPlaybackRate(ps[y]),a(y)},children:[ps[i],"x"]}),se.jsx(lt,{onClick:h=>{h.preventDefault(),t.current?.skip(5)},children:se.jsx(Bt,{name:"redo"})}),u?se.jsx("a",{className:Rt.downloadButton,href:u,download:"recording."+c?.type.split(";")[0].split("/")[1],children:se.jsx(Bt,{name:"download"})}):null]});if(!n)return e?d?se.jsx("div",{className:Rt.playerControlInline,children:f}):se.jsx("div",{className:Rt.playerControl,children:se.jsxs(pr,{children:[se.jsx("div",{className:Rt.closeButton,children:se.jsx(lt,{onClick:h=>{h.preventDefault(),s(!1)},variant:"icon",iconName:"close"})}),se.jsx("div",{className:Rt.ctrlHeading,children:se.jsx(qu,{variant:"h4",children:"Audio Controls"})}),f]})}):se.jsx("div",{className:Rt.playerControl,children:se.jsx(pr,{children:se.jsx(lt,{iconName:"angle-up",onClick:h=>{h.preventDefault(),s(!0)}})})})}export{Zm as A,Bt as I,Bm as P,qm as a,Gm as b,Xm as f,Vm as g,bn as u};
